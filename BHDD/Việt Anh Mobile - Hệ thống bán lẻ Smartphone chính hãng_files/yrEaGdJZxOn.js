/*!CK:946594460!*//*1445884959,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["7cn37"]); }

__d("MercuryGenericConstants",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={MAX_THREAD_NAME_LENGTH:250};},null,{});
__d("MercuryThreadMode",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={EMAIL_ORIGINATED:1,TITAN_ORIGINATED:2,OBJECT_ORIGINATED:3};},null,{});
__d("NotificationConstants",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();f.exports={PayloadSourceType:{UNKNOWN:0,USER_ACTION:1,LIVE_SEND:2,ENDPOINT:3,INITIAL_LOAD:4,OTHER_APPLICATION:5,SYNC:6}};},null);
__d('NotificationTokens',['CurrentUser'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={tokenizeIDs:function(j){return j.map(function(k){return h.getID()+':'+k;});},untokenizeIDs:function(j){return j.map(function(k){return k.split(':')[1];});}};f.exports=i;},null);
__d('NotificationUpdates',['Arbiter','BizSiteIdentifier.brands','ChannelConstants','JSLogger','NotificationConstants','NotificationTokens','LiveTimer','createObjectFrom'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p={},q={},r={},s={},t=[],u=0,v=k.create('notification_updates');function w(){if(u)return;var ba=p,ca=q,da=r,ea=s;p={};q={};r={};s={};y('notifications-updated',ba);if(Object.keys(ca).length)y('seen-state-updated',ca);if(Object.keys(da).length)y('read-state-updated',da);if(Object.keys(ea).length)y('hidden-state-updated',ea);t.pop();}function x(){if(t.length)return t[t.length-1];return l.PayloadSourceType.UNKNOWN;}function y(event,ba){aa.inform(event,{updates:ba,source:x()});}h.subscribe(j.getArbiterType('notification_json'),function(ba,ca){var da=Date.now(),ea=ca.obj.nodes;if(ea){ea.forEach(function(fa){fa.receivedTime=da;});v.debug('notifications_received',ea);aa.handleUpdate(l.PayloadSourceType.LIVE_SEND,ca.obj);}});h.subscribe(j.getArbiterType('notifications_seen'),function(ba,ca){var da=m.tokenizeIDs(ca.obj.alert_ids);aa.handleUpdate(l.PayloadSourceType.LIVE_SEND,{seenState:o(da)});});h.subscribe(j.getArbiterType('notifications_read'),function(ba,ca){var da=m.tokenizeIDs(ca.obj.alert_ids);aa.handleUpdate(l.PayloadSourceType.LIVE_SEND,{readState:o(da)});});h.subscribe(j.getArbiterType('notification_hidden'),function(ba,ca){var da=m.tokenizeIDs([ca.obj.notif_id+'']);aa.handleUpdate(l.PayloadSourceType.LIVE_SEND,{HiddenState:o(da)});});var z=null,aa=Object.assign(new h(),{getserverTime:function(){return z;},handleUpdate:function(ba,ca){if(ca.nodes&&Array.isArray(ca.nodes))ca.nodes=this._filterNodesBasedOnBusinessID(ca.nodes);if(ca.servertime){z=ca.servertime;n.restart(ca.servertime);}if(Object.keys(ca).length)this.synchronizeInforms((function(){t.push(ba);var da=babelHelpers._extends({payloadsource:x()},ca);this.inform('update-notifications',da);this.inform('update-seen',da);this.inform('update-read',da);this.inform('update-hidden',da);}).bind(this));},didUpdateNotifications:function(ba){Object.assign(p,o(ba));w();},didUpdateSeenState:function(ba){Object.assign(q,o(ba));w();},didUpdateReadState:function(ba){Object.assign(r,o(ba));w();},didUpdateHiddenState:function(ba){Object.assign(s,o(ba));w();},synchronizeInforms:function(ba){u++;try{ba();}catch(ca){throw ca;}finally{u--;w();}},_filterNodesBasedOnBusinessID:function(ba){return ba.filter(function(ca){return ca.business_ids&&Object.keys(ca.business_ids).length>0?!!('business_ids_user_pref' in ca?ca.business_ids_user_pref[i.getBusinessID()]:ca.business_ids[i.getBusinessID()]):!i.isBizSite();});}});f.exports=aa;},null);
__d('NotificationStore',['KeyedCallbackManager','NotificationConstants','NotificationUpdates','RangedCallbackManager','MercuryServerDispatcher'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=new h(),n=new k(function(r){var s=m.getResource(r);return s.creation_time;},function(r,s){return s-r;}),o={},p=null;j.subscribe('update-notifications',function(r,s){if(s.page_info)o=s.page_info;if(s.nodes===undefined)return;var t,u=[],v={},w=s.nodes||[],x;w.forEach(function(y){t=y.alert_id;x=m.getResource(t);if(!x||x.creation_time<y.creation_time){u.push(t);v[t]=y;}});m.addResourcesAndExecute(v);n.addResources(u);j.didUpdateNotifications(u);});l.registerEndpoints({'/ajax/notifications/client/get.php':{mode:l.IMMEDIATE,handler:function(r){j.handleUpdate(i.PayloadSourceType.ENDPOINT,r);}}});var q={getNotifications:function(r,s){var t=n.executeOrEnqueue(0,r,function(aa){var ba=m.executeOrEnqueue(aa,s);}),u=n.getUnavailableResources(t);if(u.length){n.unsubscribe(t);if(!q.canFetchMore()){m.executeOrEnqueue(n.getAllResources(),s);return;}var v=o,w=v&&v.end_cursor||null,x;if(w){var y=Math.max.apply(null,u),z=n.getCurrentArraySize();x=y-z+1;}else x=r;l.trySend('/ajax/notifications/client/get.php',{businessID:p,cursor:w,length:x});}},getAll:function(r){q.getNotifications(q.getCount(),r);},getCount:function(){return n.getAllResources().length;},canFetchMore:function(){var r=o;return (!r||!r.hasOwnProperty('has_next_page')||r.has_next_page);},setBusinessID:function(r){p=r;}};f.exports=q;},null);
__d("XNotificationsOptionsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/notifications\/feedback\/option\/",{notif_id:{type:"Int",required:true},undo:{type:"Bool",defaultValue:false},server_action:{type:"String",required:true}});},null,{});
__d('NotificationUserActions',['AsyncRequest','AsyncSignal','NotificationConstants','NotificationStore','NotificationTokens','NotificationUpdates','URI','XNotificationsOptionsController','createObjectFrom','emptyFunction'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r=j.PayloadSourceType.USER_ACTION,s='mark_spam',t='turn_off',u='undo',v='original_subscription_level',w=false;function x(da){var ea=new n('/ajax/notifications/mark_read.php').getQualifiedURI().toString();new i(ea,da).send();}function y(da){var ea={};da.forEach(function(fa,ga){ea['alert_ids['+ga+']']=fa;});return ea;}function z(da,ea,fa,ga,ha){var ia=l.untokenizeIDs([da])[0],ja={notification_id:ia,client_rendered:true,request_type:ea};Object.assign(ja,fa);new h('/ajax/notifications/negative_req.php').setData(ja).setHandler(ga||q).setErrorHandler(ha||q).send();}function aa(da,ea,fa,ga,ha){var ia=o.getURIBuilder().setInt('notif_id',l.untokenizeIDs([da])[0]).setBool('undo',ga).setString('server_action',ha).getURI(),ja=function(ka){if(!ka.payload)throw new Error('No response from notif option!');m.handleUpdate(r,{hiddenState:p([da],!ka.payload.visible)});ea(ka.payload);};new h(ia).setHandler(ja||q).setErrorHandler(fa||q).send();}function ba(da,ea,fa,ga,ha){var ia=ha?u:t;k.getAll(function(ja){var ka=Object.keys(ja).filter(function(la){var ma=ja[la];return !!(ma.application&&ma.application.id&&ma.application.id==ea);});z(da,ia,null,function(la){fa(la);m.handleUpdate(r,{hiddenState:p(ka,!ha)});},ga);});}var ca={markNotificationsAsSeen:function(da){m.handleUpdate(r,{seenState:p(da)});var ea=l.untokenizeIDs(da),fa=y(ea);fa.seen=true;x(fa);},setNextIsFromReadButton:function(da){w=da;},markNotificationsAsRead:function(da){m.handleUpdate(r,{readState:p(da)});var ea=l.untokenizeIDs(da),fa=y(ea);if(w){fa.from_read_button=true;w=false;}x(fa);},sendNotifOption:function(da,ea,fa,ga){aa(da,ea,fa,false,ga);},undoNotifOption:function(da,ea,fa,ga){aa(da,ea,fa,true,ga);},markNotificationAsHidden:function(da,ea,fa){m.handleUpdate(r,{hiddenState:p([da])});z(da,t,null,ea,fa);},markNotificationAsVisible:function(da,ea,fa,ga){m.handleUpdate(r,{hiddenState:p([da],false)});var ha=null;if(ea!==null){ha={};ha[v]=ea;}z(da,u,ha,fa,ga);},markNotificationAsSpam:function(da,ea,fa){m.handleUpdate(r,{hiddenState:p([da],true)});z(da,s,null,ea,fa);},markAppAsHidden:function(da,ea,fa,ga){var ha=false;ba(da,ea,fa,ga,ha);},markAppAsVisible:function(da,ea,fa,ga){var ha=true;ba(da,ea,fa,ga,ha);}};f.exports=ca;},null);
__d("XGamesHideableXOutAsyncController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/games\/async\/xout\/hide\/",{unit_type:{type:"String"},fbs:{type:"Int"},app_id:{type:"Int"},ego_imp:{type:"String"},extra_data:{type:"String"}});},null,{});
__d('GamesUninstallXOut.react',['cx','React','ReactDOM','DOMContainer.react','XGamesHideableXOutAsyncController','AsyncRequest','GamesXOut.react','URI','Dialog','CSS'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r=i.PropTypes,s=i.createClass({displayName:'GamesUninstallXOut',propTypes:{unitType:r.string.isRequired,appID:r.string.isRequired,domChild:r.any.isRequired,extraData:r.string.isRequired,egoImp:r.string,fbs:r.number.isRequired},getInitialState:function(){return {pending:false};},statics:{appUninstalled:function(t){q.addClass(t,"_4ksu");}},_appUninstalled:function(){var t=l.getURIBuilder().setInt('app_id',this.props.appID).setString('extra_data',this.props.extraData).setString('ego_imp',this.props.egoImp).setString('unit_type',this.props.unitType).setInt('fbs',this.props.fbs).getURI();this._request=new m(t).setMethod('POST');this._request.send();},_handleXOut:function(){var t=new o('/ajax/settings/apps/delete_app.php').setQueryData({app_id:this.props.appID,legacy:false,dialog:true,xout:true});new p().setAsync(new m(t).setRelativeTo(j.findDOMNode(this))).setCausalElement(j.findDOMNode(this)).show();},render:function(){return (i.createElement(n,{onClick:this._handleXOut},i.createElement(k,null,this.props.domChild)));}});f.exports=s;},null);