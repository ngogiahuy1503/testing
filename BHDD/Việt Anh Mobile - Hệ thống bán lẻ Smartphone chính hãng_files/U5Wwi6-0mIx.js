/*!CK:1215818035!*//*1445968045,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["\/k\/ff"]); }

__d("ChatTypeaheadEvent",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={ABANDONED_QUERY:"abandoned_query",NEW_QUERY:"new_query",RESULT_SELECTED:"result_selected"};},null,{});
__d("GenderConst",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={NOT_A_PERSON:0,FEMALE_SINGULAR:1,MALE_SINGULAR:2,FEMALE_SINGULAR_GUESS:3,MALE_SINGULAR_GUESS:4,MIXED_SINGULAR:5,MIXED_PLURAL:5,NEUTER_SINGULAR:6,UNKNOWN_SINGULAR:7,FEMALE_PLURAL:8,MALE_PLURAL:9,NEUTER_PLURAL:10,UNKNOWN_PLURAL:11,UNKNOWN:0};},null,{});
__d("IrisProtocolMessageLifetime",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={TTL_OFF:0,TTL_ON_UNKNOWN:1,TTL_30SECONDS:30000,TTL_1MINUTE:60000,TTL_3MINUTES:180000,TTL_5MINUTES:300000,TTL_10MINUTES:600000,TTL_15MINUTES:900000,TTL_30MINUTES:1800000,TTL_1HOUR:3600000,TTL_2HOURS:7200000,TTL_4HOURS:14400000,TTL_8HOURS:28800000,TTL_12HOURS:43200000,TTL_24HOURS:86400000};},null,{});
__d("PhotoResizeModeConst",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={CONTAIN:"s",COVER:"p"};},null,{});
__d('ChatOpenTabEventLogger',['Banzai','ChatImpressionLogger','MercuryIDs'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k='messaging_tracking',l={log:function(m,n,o,p){var q={referrer:m||'',message_thread_id:n,message_view:'chat',timestamp_send:Date.now(),message_target_ids:null};if(o!==undefined)q.message_target_ids=[o];i.logImpression(m,o,p);h.post(k,q,{delay:0,retry:true});var r=j.getUserIDFromThreadID(String(n));h.post('page_message_button_click',{page_id:r,ref:m});}};f.exports=l;},null);
__d('GroupChatMessageBlockAlert',['DialogX','GenderConst','MercuryParticipants','React','XUIDialogBody.react','XUIDialogButton.react','XUIDialogFooter.react','XUIDialogTitle.react','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q={show:function(r,s,t){var u=new h({width:445},k.createElement('div',null,k.createElement(o,null,p._("See Conversations?")),k.createElement(l,null,this.dialogBodyText(r)),k.createElement(n,null,k.createElement(m,{action:'cancel',label:this.leaveGroupButton(),onClick:function(){return t();}}),k.createElement(m,{use:'confirm',action:'cancel',label:this.openChatButton(),onClick:function(){return s();}}))));u.show();},openChatButton:function(){return p._("Xem cu\u1ed9c tr\u00f2 chuy\u1ec7n");},leaveGroupButton:function(){return p._("R\u1eddi kh\u1ecfi nh\u00f3m");},dialogBodyText:function(r){if(r.length!==1){return p._("Ng\u01b0\u1eddi b\u1ea1n \u0111\u00e3 ch\u1eb7n c\u00f3 trong cu\u1ed9c tr\u00f2 chuy\u1ec7n n\u00e0y. N\u1ebfu b\u1ea1n nh\u00ecn th\u1ea5y cu\u1ed9c tr\u00f2 chuy\u1ec7n n\u00e0y, b\u1ea1n s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c tin nh\u1eafn c\u1ee7a nhau g\u1eedi \u0111\u1ebfn nh\u00f3m.");}else{var s='';j.get(r.pop(),function(t){switch(t.gender){case i.FEMALE_SINGULAR:s=p._("{name} \u0111ang tham gia cu\u1ed9c tr\u00f2 chuy\u1ec7n nh\u00f3m n\u00e0y nh\u01b0ng b\u1ea1n \u0111\u00e3 ch\u1eb7n c\u00f4 \u1ea5y. N\u1ebfu b\u1ea1n nh\u00ecn th\u1ea5y cu\u1ed9c tr\u00f2 chuy\u1ec7n n\u00e0y, b\u1ea1n s\u1ebd nh\u00ecn th\u1ea5y tin nh\u1eafn c\u00f4 \u1ea5y g\u1eedi \u0111\u1ebfn nh\u00f3m v\u00e0 c\u00f4 \u1ea5y c\u0169ng s\u1ebd nh\u00ecn th\u1ea5y c\u1ee7a b\u1ea1n.",[p.param('name',t.short_name)]);break;case i.MALE_SINGULAR:s=p._("{name} \u0111ang tham gia cu\u1ed9c tr\u00f2 chuy\u1ec7n nh\u00f3m n\u00e0y nh\u01b0ng b\u1ea1n \u0111\u00e3 ch\u1eb7n anh \u1ea5y. N\u1ebfu b\u1ea1n nh\u00ecn th\u1ea5y cu\u1ed9c tr\u00f2 chuy\u1ec7n n\u00e0y, b\u1ea1n s\u1ebd nh\u00ecn th\u1ea5y tin nh\u1eafn anh \u1ea5y g\u1eedi \u0111\u1ebfn nh\u00f3m v\u00e0 anh \u1ea5y c\u0169ng s\u1ebd nh\u00ecn th\u1ea5y c\u1ee7a b\u1ea1n.",[p.param('name',t.short_name)]);break;default:s=p._("{name} \u0111ang tham gia cu\u1ed9c tr\u00f2 chuy\u1ec7n nh\u00f3m n\u00e0y nh\u01b0ng b\u1ea1n \u0111\u00e3 ch\u1eb7n h\u1ecd. N\u1ebfu b\u1ea1n nh\u00ecn th\u1ea5y cu\u1ed9c tr\u00f2 chuy\u1ec7n n\u00e0y, b\u1ea1n s\u1ebd nh\u00ecn th\u1ea5y tin nh\u1eafn h\u1ecd g\u1eedi \u0111\u1ebfn nh\u00f3m v\u00e0 h\u1ecd c\u0169ng s\u1ebd nh\u00ecn th\u1ea5y c\u1ee7a b\u1ea1n.",[p.param('name',t.short_name)]);}});return s;}}};f.exports=q;},null);
__d('MercuryBlockedParticipants',['MercuryIDs','MercuryActionType','MercuryDispatcher','MercurySingletonProvider','Set'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();m.getForFBID=function(o){return n.getForFBID(o);};m.get=function(){return n.get();};function m(o){this.$MercuryBlockedParticipants1=o;this.$MercuryBlockedParticipants2=new l();this.$MercuryBlockedParticipants3=j.getForFBID(this.$MercuryBlockedParticipants1);this.$MercuryBlockedParticipants3.subscribe('update-blocked-users',(function(p,q){if(q.message_blocked_ids)this.$MercuryBlockedParticipants2=new l(q.message_blocked_ids);var r=q.actions||q.global_actions;for(var s=r,t=Array.isArray(s),u=0,s=t?s:s[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var v;if(t){if(u>=s.length)break;v=s[u++];}else{u=s.next();if(u.done)break;v=u.value;}var w=v;if(w.action_type!==i.UPDATE_BLOCKER_STATUS)continue;if(w.message_blocked){this.$MercuryBlockedParticipants4(w.thread_fbid);}else this.$MercuryBlockedParticipants5(w.thread_fbid);}}).bind(this));}m.prototype.getFBID=function(){return this.$MercuryBlockedParticipants1;};m.prototype.setIDs=function(o){this.$MercuryBlockedParticipants2=o;};m.prototype.getIDs=function(){return this.$MercuryBlockedParticipants6();};m.prototype.$MercuryBlockedParticipants6=function(){return this.$MercuryBlockedParticipants2;};m.prototype.$MercuryBlockedParticipants4=function(o){this.$MercuryBlockedParticipants2.add(h.getParticipantIDFromUserID(o));};m.prototype.$MercuryBlockedParticipants5=function(o){this.$MercuryBlockedParticipants2['delete'](h.getParticipantIDFromUserID(o));};m.prototype.isMessageBlocked=function(o){if(!o.is_canonical)return false;var p=o.participants.filter((function(q){return q!=h.getParticipantIDFromUserID(this.getFBID());}).bind(this));return !p.every((function(q){return !this.$MercuryBlockedParticipants2.has(q);}).bind(this));};m.prototype.isPresentInGroupThread=function(o){if(!o.is_canonical&&this.$MercuryBlockedParticipants7(o).length>0)return true;return false;};m.prototype.inGroupThread=function(o){if(o.is_canonical)return [];return this.$MercuryBlockedParticipants7(o);};m.prototype.$MercuryBlockedParticipants7=function(o){var p=o.participants.filter((function(r){return r!=h.getParticipantIDFromUserID(this.getFBID());}).bind(this)),q=p.filter((function(r){return this.$MercuryBlockedParticipants2.has(r)!==false;}).bind(this));return q;};var n=new k(m);f.exports=m;},null);
__d("XNFXMessengerBlockActionController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/nfx\/block_messages\/",{thread_fbid:{type:"Int",required:true},av:{type:"Int"},location:{type:"Enum",required:true,enumType:1},__asyncDialog:{type:"Int"}});},null,{});
__d("XMessengerNotificationsSettingsDialogController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/notifications\/settings\/dialog\/",{thread_key_id:{type:"String",required:true},modify:{type:"Bool",defaultValue:false},__asyncDialog:{type:"Int"}});},null,{});
__d('ChatOpenTabImpl',['ChatApp','ChatOpenTabEventLogger','ChatWelcomeMessage','DOM','GroupChatMessageBlockAlert','LogHistory','MercuryIDs','Toggler','csx','requireWeak','MercuryBlockedParticipants','MercuryThreadActions','MercuryThreadIDMap','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){'use strict';if(c.__markCompiled)c.__markCompiled();var r=c('MercuryBlockedParticipants').get(),s=c('MercuryThreadActions').get(),t=c('MercuryThreadIDMap').get(),u=c('MercuryThreads').get(),v=null;q('ChatTabModel',function(x){return v=x;});var w={canOpenTab:function(){return !!(h&&!h.isHidden());},openEmptyTab:function(x,y,z){if(this.canOpenTab()&&v){var aa=v.getEmptyTab();this._openClientTab(aa,null);this._logChatOpenTabEvent(y,aa,null,z);this._closeJewelFlyout();}},openThreadTab:function(x,y,z,aa,ba){if(!n.isValid(x)){t.getClientIDFromServerID(x,function(ca){w.openThreadTabImpl(ca,y,z,aa,ba);});}else w.openThreadTabImpl(x,y,z,aa,ba);},openThreadTabImpl:function(x,y,z,aa,ba){u.getThreadMeta(x,(function(ca){if(r.isPresentInGroupThread(ca)){l.show(r.inGroupThread(ca),(function(){this.openClientTab(x,y,z,aa,ba);}).bind(this),function(){s.leaveGroup(x);});}else this.openClientTab(x,y,z,aa,ba);}).bind(this));},openClientTab:function(x,y,z,aa,ba){this._openClientTab(x,aa,ba);this._logChatOpenTabEvent(y,x,null,z);this._closeJewelFlyout();},openUserTab:function(x,y,z){var aa=n.getThreadIDFromUserID(x);this._openClientTab(aa);this._logChatOpenTabEvent(y,aa,x,z);},openPageTab:function(x,y,z){var aa=n.getThreadIDFromUserID(y);u.getThreadMeta(aa,function(ba){if(x&&x.length>0){var ca=(Date.now()-ba.timestamp)/1000,da=ca/3600;if(ba.message_count===0||da>24)j.setWelcomeMessage(aa,n.getParticipantIDFromUserID(y),x);}});this._openClientTab(aa);this._logChatOpenTabEvent(z,aa,y);},_closeJewelFlyout:function(){var x=k.scry(document,"div._1z4y")[0],y=o.getInstance(x);if(y&&y.getActive()&&y.getActive()===x)y.hide();},_openClientTab:function(x,y,z){u.getThreadMeta(x,(function(aa){if(!this.canOpenTab())m.getInstance('mercury').error('Unable to open chat tab',aa);h.tabController.openTab(x,h.tabsViewport,y,!!z);}).bind(this));},_logChatOpenTabEvent:function(x,y,z,aa){i.log(x,y,z,aa);}};f.exports=w;},null);
__d('ChatPerfInstrumentation',['BanzaiLogger','ChatPerfEvent','Promise','emptyFunction','performanceAbsoluteNow'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();var m={_startTime:(Number),init:function(){this._startTime=l();return new j(function(n){return n();});},_log:function(event){h.log('ChatPerfLoggerConfig',{event:event,duration:l()-this._startTime});},logTTI:function(){this.logTTI=k;this._log(i.TTI);},logCHAT_CONVERSATION_TTI:function(){this.logCHAT_CONVERSATION_TTI=k;this._log(i.CHAT_CONVERSATION_TTI);}};f.exports=m;},null);
__d('ChatQuietLinks',['Event','DOM','UserAgent_DEPRECATED','DataStore','Parent'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m={},n={silenceLinks:function(r){o(r,this.removeEmptyHrefs.bind(this));},nukeLinks:function(r){o(r,this.removeAllHrefs.bind(this));},removeEmptyHrefs:function(r){p(r,function(s){return !s||s==='#';});},removeAllHrefs:function(r){p(r);}};function o(r,s){var t=!!j.chrome(),u=!!j.chrome()||j.ie()>=9||j.firefox()>=4;if(m[i.getID(r)])return;m[i.getID(r)]=true;if(!u)return;if(!t){s&&s(r);return;}h.listen(r,'mouseover',function v(w){var x=l.byTag(w.getTarget(),'a');if(x){var y=x.getAttribute('href');if(q(y)){k.set(x,'stashedHref',x.getAttribute('href'));x.removeAttribute('href');}}});h.listen(r,'mouseout',function v(w){var x=l.byTag(w.getTarget(),'a'),y=x&&k.remove(x,'stashedHref');if(q(y))x.setAttribute('href',y);});h.listen(r,'mousedown',function(v){if(!v.isDefaultRequested())return true;var w=l.byTag(v.getTarget(),'a'),x=w&&k.get(w,'stashedHref');if(q(x))w.setAttribute('href',x);});}function p(r,s){var t=i.scry(r,'a');if(s)t=t.filter(function(u){return s(u.getAttribute('href'));});t.forEach(function(u){u.removeAttribute('href');u.setAttribute('tabindex',0);});}function q(r){return r&&r!=='#';}f.exports=n;},null);
__d('Dock',['Event','shield','Arbiter','ArbiterMixin','BlueBar','ChatQuietLinks','CSS','DataStore','DOM','Parent','Scroll','Style','Toggler','Vector','csx','emptyFunction','WebMessengerWidthControl'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();c('WebMessengerWidthControl');function x(){}Object.assign(x,k,{MIN_HEIGHT:140,INITIAL_FLYOUT_HEIGHT_OFFSET:10,init:function(y){this.init=w;this.rootEl=y;this.calculateViewportDimensions();this.calculateFlyoutHeightOffset();m.removeEmptyHrefs(this.rootEl);h.listen(y,'click',this._onClick.bind(this));h.listen(window,'resize',this._onWindowResize.bind(this));t.subscribe(['show','hide'],(function(z,aa){var ba=aa.getActive();if(!p.contains(y,ba))return;if(n.hasClass(ba,'fbNub')){this.notifyNub(ba,z);if(z==='show')this._resizeNubFlyout(ba);}else{var ca=q.byClass(ba,'fbNubFlyout');if(ca)n.conditionClass(ca,'menuOpened',z==='show');}}).bind(this));this.inform('init',{},j.BEHAVIOR_PERSISTENT);},calculateViewportDimensions:function(){return this.viewportDimensions=u.getViewportDimensions();},calculateFlyoutHeightOffset:function(){this.flyoutHeightOffset=this.INITIAL_FLYOUT_HEIGHT_OFFSET+u.getElementDimensions(this.rootEl).y;var y=l.getBar();if(y){var z=s.isFixed(y)?'viewport':'document';this.flyoutHeightOffset+=u.getElementPosition(y,z).y+u.getElementDimensions(y).y;}},toggle:function(y){var z=this._findFlyout(y);if(!z)return;this.subscribe('init',function(){t.toggle(y);});},show:function(y){this.subscribe('init',function(){t.show(y);});},showNub:function(y){n.show(y);},hide:function(y){this.subscribe('init',function(){var z=t.getInstance(y);p.contains(y,z.getActive())&&z.hide();});},hideNub:function(y){n.hide(y);this.hide(y);},setUseMaxHeight:function(y,z){n.conditionClass(y,'maxHeight',z!==false);this._resizeNubFlyout(y);},_resizeNubFlyout:function(y){var z=this._findFlyout(y);if(!z||n.hasClass(y,'placeholder')||!(n.hasClass(y,'openToggler')||n.hasClass(y,'opened')))return;var aa=p.find(z,'div.fbNubFlyoutOuter'),ba=p.find(aa,'div.fbNubFlyoutInner'),ca=p.find(ba,'div.fbNubFlyoutBody'),da=r.getTop(ca),ea=ca.offsetHeight;s.set(ca,'height','auto');var fa=u.getElementDimensions(z),ga=u.getElementDimensions(ca),ha=this.getMaxFlyoutHeight(y);s.set(z,'max-height',ha+'px');s.set(aa,'max-height',ha+'px');fa=u.getElementDimensions(z);var ia=u.getElementDimensions(ba),ja=ia.y-ga.y,ka=fa.y-ja,la=parseInt(ca.style.height||ca.clientHeight,10),ma=ka!==la;if(fa.y>ja&&ma)s.set(ca,'height',ka+'px');n.removeClass(z,'swapDirection');var na=u.getElementPosition(z).x;n.conditionClass(z,'swapDirection',(function(){if(na<0)return true;return na+fa.x>this.viewportDimensions.x;}).bind(this)());if(ma&&da+ea>=ga.y){r.setTop(ca,ca.scrollHeight);}else r.setTop(ca,da);this.notifyNub(y,'resize');},getMaxFlyoutHeight:function(y){var z=this._findFlyout(y),aa=u.getElementPosition(z,'viewport'),ba=u.getElementDimensions(z),ca=Math.max(this.MIN_HEIGHT,this.viewportDimensions.y-this.flyoutHeightOffset)-(this.viewportDimensions.y-aa.y-ba.y);return Math.max(ca,0);},resizeAllFlyouts:function(){var y=this._getAllNubs(),z=y.length;while(z--)this._resizeNubFlyout(y[z]);},hideAllFlyouts:function(){var y=this._getAllNubs(),z=y.length;while(z--)this.hide(y[z]);},_getAllNubs:function(){var y=p.scry(this.rootEl,"div._50-v.openToggler");return y.concat(p.scry(this.rootEl,"div._50-v.opened"));},_onClick:function(event){var y=event.getTarget(),z=q.byClass(y,'fbNub');if(z){if(q.byClass(y,'fbNubFlyoutTitlebar')){var aa=q.byTag(y,'a'),ba=y.nodeName=='INPUT'&&y.getAttribute('type')=='submit';if(!aa&&!ba){this.hide(z);return false;}}this.notifyNub(z,'click');}},_onWindowResize:function(event){this.calculateViewportDimensions();this.resizeAllFlyouts();},_findFlyout:function(y){return n.hasClass(y,'fbNubFlyout')?y:p.scry(y,'div.fbNubFlyout')[0]||null;},registerNubController:function(y,z){o.set(y,'dock:nub:controller',z);z.subscribe('nub/button/content-changed',i(this.inform,this,'resize',y));z.subscribe('nub/flyout/content-changed',i(this._resizeNubFlyout,this,y));},unregisterNubController:function(y){o.remove(y,'dock:nub:controller');},notifyNub:function(y,z,aa){var ba=o.get(y,'dock:nub:controller');ba&&ba.inform(z,aa);}});f.exports=b.Dock||x;},null);
__d('MercuryDelayedRoger',['ArbiterMixin','LiveTimer','MercuryActionStatus','MercuryConfig','setTimeoutAcrossTransitions','MercuryMessages','MercuryRoger','MercuryThreadInformer','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=c('MercuryMessages').get(),n=c('MercuryRoger').get(),o=c('MercuryThreadInformer').get(),p=c('MercuryThreads').get(),q={},r={},s=k['roger.seen_delay'],t={getSeenBy:function(z,aa){if(r[z])return [];return n.getSeenBy(u(z),aa);},wasSeenByAll:function(z){if(r[z])return false;return n.wasSeenByAll(u(z));}};Object.assign(t,h);function u(z){if(!q[z]){var aa=p.getThreadMetaNow(z);if(aa)q[z]={thread_id:z,author:aa.participants[0],timestamp:aa.timestamp};}return q[z];}function v(z){var aa=false;m.getThreadMessagesRange(z,0,1,function(ba){var ca=ba[0];if(!ca)return;var da=ca.timestamp;if(ca.action_id||ca.status==j.SUCCESS)da-=i.getServerTimeOffset();var ea=t.getSeenBy(z);if(r[z]){clearTimeout(r[z]);delete r[z];}var fa=da+s,ga=fa-Date.now();if(ga>0)r[z]=l(function(){delete r[z];w(z);},ga);q[z]=ca;var ha=t.getSeenBy(z);if(ea.length||ha.length)aa=true;});return aa;}function w(z){var aa={};aa[z]=true;x(aa);}function x(z){t.inform('state-changed',z);t.inform('change');}function y(event,z){var aa={};for(var ba in z)if(v(ba))aa[ba]=true;for(var ca in aa){x(aa);break;}}n.subscribe('change',function(z,aa){for(var ba in aa)!r[ba]&&w(ba);});o.subscribe('messages-received',y);o.subscribe('messages-reordered',y);o.subscribe('messages-updated',y);f.exports=t;},null);
__d('MercuryDeliveryReceipts',['ArbiterMixin','Map','MercuryDispatcher','MercurySingletonProvider','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n;m=babelHelpers.inherits(o,l(h));n=m&&m.prototype;function o(q){'use strict';n.constructor.call(this);this.$MercuryDeliveryReceipts1=q;this.$MercuryDeliveryReceipts2=new i();this.$MercuryDeliveryReceipts3=j.getForFBID(this.$MercuryDeliveryReceipts1);this.$MercuryDeliveryReceipts3.subscribe('update-delivery',(function(r,s){if(s.delivery_receipts)for(var t in s.delivery_receipts){var u=s.delivery_receipts[t],v=this.$MercuryDeliveryReceipts2.get(t)||0;if(u>v){this.$MercuryDeliveryReceipts2.set(t,u);this.informDeliveryStatusChanged(t);}}}).bind(this));}o.getForFBID=function(q){'use strict';return p.getForFBID(q);};o.get=function(){'use strict';return p.get();};o.prototype.informDeliveryStatusChanged=function(q){'use strict';var r=new i();r.set(q,true);this.inform('change',r);};o.prototype.getDeliveryTime=function(q){'use strict';return this.$MercuryDeliveryReceipts2.get(q)||0;};var p=new k(o);f.exports=o;},null);
__d('MercuryDeliveryState',['MercuryConfig','MercuryIDs','MercuryServerRequests','MercurySingletonProvider','MercuryThreadIDMap','MercuryThreadInformer','PresencePrivacy','UserActivity','debounceAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';if(c.__markCompiled)c.__markCompiled();var q=h.delivery_timeout||120000;r.getForFBID=function(t){return s.getForFBID(t);};r.get=function(){return s.get();};function r(t){this.$MercuryDeliveryState1=t;this.$MercuryDeliveryState2=j.getForFBID(this.$MercuryDeliveryState1);this.$MercuryDeliveryState3=m.getForFBID(this.$MercuryDeliveryState1);this.$MercuryDeliveryState4=l.getForFBID(this.$MercuryDeliveryState1);this.$MercuryDeliveryState5=[];this.$MercuryDeliveryState6=[];this.$MercuryDeliveryState3.subscribe('messages-received',this.$MercuryDeliveryState7.bind(this));o.subscribe(p(this.$MercuryDeliveryState8,300,this));}r.prototype.$MercuryDeliveryState7=function(t,u){for(var v in u){var w=u[v];w.forEach((function(x){if(this.$MercuryDeliveryState9(x)){this.$MercuryDeliveryState5.push(x);this.$MercuryDeliveryState4.getServerIDFromClientID(v,(function(y){if(!this.$MercuryDeliveryState6[y])this.$MercuryDeliveryState6[y]=[];this.$MercuryDeliveryState6[y].push(x.message_id);}).bind(this));}}).bind(this));}if(o.isActive(q))this.$MercuryDeliveryState8();};r.prototype.$MercuryDeliveryState8=function(){if(this.$MercuryDeliveryState5.length===0&&this.$MercuryDeliveryState6.length===0)return;var t=this.$MercuryDeliveryState5.map(function(u){return u.message_id;});if(t)this.$MercuryDeliveryState2.sendDeliveryReceipts(t,this.$MercuryDeliveryState6);this.$MercuryDeliveryState6=[];this.$MercuryDeliveryState5=[];};r.prototype.$MercuryDeliveryState9=function(t){var u=t.author?i.getUserIDFromParticipantID(t.author):null;if(u===this.$MercuryDeliveryState1)return false;if(!t.is_unread)return false;if(!n.allows(u))return false;return true;};var s=new k(r);f.exports=r;},null);
__d('MercuryUnseenState',['MercuryFolders','KeyedCallbackManager','LogHistory','MercuryActionType','MercuryDispatcher','MercurySingletonMixin','MercuryThreadInfo','MercuryThreadlistConstants','MercuryThreadIDMap','MessagingTag','MercuryServerRequests','MercuryThreadInformer','MercuryThreads','createObjectFrom','isEmpty'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=o.MAX_UNSEEN_COUNT,x='unseen_thread_hash',y='unseen_thread_list',z=j.getInstance('mercury_unseen_state');function aa(pa){this._fbid=pa;this._serverRequests=r.getForFBID(this._fbid);this._threadIDMap=p.getForFBID(this._fbid);this._threads=t.getForFBID(this._fbid);this._threadInformer=s.getForFBID(this._fbid);this._dispatcher=l.getForFBID(this._fbid);this._initialUnseenCount=null;this._lastSeenTimestamp=0;this._maxCount=false;this._pendingServerUpdates=false;this._unseenResources=new i();this._dispatcher.subscribe('update-unseen',(function(qa,ra){ga(this,ra);}).bind(this));this._dispatcher.subscribe('update-thread-ids',(function(qa,ra){ma(this,ra);}).bind(this));}Object.assign(aa.prototype,{getUnseenCount:function(){if(this.exceedsMaxCount()){z.error('unguarded_unseen_count_fetch',{});return 0;}return fa(this)||0;},exceedsMaxCount:function(){return this._maxCount||fa(this)>w;},markAsSeen:function(){var pa=fa(this);if(pa===null){this._pendingServerUpdates=true;}else if(pa>0||this._maxCount){this._serverRequests.markSeen();var qa=this._serverRequests.getLastActionTimestamp();ha(this,qa,[]);}}});Object.assign(aa,m);function ba(pa,qa,ra){var sa={};sa[qa]=0;ja(pa,sa,ra);}function ca(pa,qa){pa._unseenResources.setResource(x,qa);pa._unseenResources.setResource(y,Object.keys(qa));}function da(pa,qa){var ra=pa._unseenResources.executeOrEnqueue(x,qa),sa=pa._unseenResources.getUnavailableResources(ra);if(sa.length)pa._serverRequests.fetchUnseenThreadIDs();}function ea(pa){return pa._unseenResources.getResource(x);}function fa(pa){var qa=pa._unseenResources.getResource(y);if(qa){return qa.length;}else return pa._initialUnseenCount;}function ga(pa,qa){var ra=oa(qa);if(qa.unseen_thread_fbids){qa.unseen_thread_fbids.forEach(function(cb){if(cb.folder!=q.INBOX)return;var db=cb.thread_fbids||[];db=db.concat(cb.other_user_fbids||[]);var eb=la(pa,db),fb=pa._lastSeenTimestamp;if(ra&&ra.seen_timestamp)fb=ra.seen_timestamp;ha(pa,fb,eb);if(ra&&ra.unseen_count>w)pa._maxCount=true;});}else if(ra&&ra.seen_timestamp){pa._lastSeenTimestamp=ra.seen_timestamp;if(ra.unseen_count>w){pa._maxCount=true;ca(pa,{});}else{pa._initialUnseenCount=ra.unseen_count;if(pa._initialUnseenCount===0)ca(pa,{});}}else{if(pa._maxCount)return;var sa=qa.actions;if(!sa||!sa.length)return;var ta={},ua={};for(var va=0;va<sa.length;va++){var wa=sa[va];if(wa.is_forward)continue;var xa=wa.action_type,ya=wa.other_user_fbid?wa.other_user_fbid:wa.thread_fbid,za=wa.thread_id?wa.thread_id:ya;if(xa==k.MARK_THREAD_SEEN){ba(pa,za,wa.persistent);continue;}if(!na(pa,wa))continue;if(xa==k.USER_GENERATED_MESSAGE||xa==k.LOG_MESSAGE){var ab=ta[za]?wa.timestamp>ta[za]:false,bb=ab||!ta[za];if(wa.is_unread&&bb)pa._threads.getThreadMeta(za,function(cb){var db=false;if(cb&&cb.last_read_timestamp)if(cb.last_read_timestamp>=wa.timestamp)db=true;if(!n.isMuted(cb)&&!db)ta[za]=wa.timestamp;});}else if(xa==k.CHANGE_READ_STATUS&&wa.mark_as_read)ua[za]=wa.timestamp;}ia(pa,ta);ja(pa,ua);}if(pa._pendingServerUpdates){pa._pendingServerUpdates=false;pa.markAsSeen();}}function ha(pa,qa,ra){var sa=ea(pa);if(sa===undefined||qa>pa._lastSeenTimestamp||pa._maxCount){pa._lastSeenTimestamp=qa;ra=ra||[];if(ra.length<=w)pa._maxCount=false;var ta={},ua=ea(pa)||{};for(var va in ua)if(ua[va]!==true){var wa=ua[va];if(ka(pa,wa))ta[va]=wa;}var xa=Object.assign(u(ra,true),ta);ca(pa,xa);pa._threadInformer.updatedUnseenState();}}function ia(pa,qa){if(pa._maxCount)return;var ra={},sa=false;for(var ta in qa){var ua=qa[ta];if(ka(pa,ua)){ra[ta]=ua;sa=true;}}if(!sa)return;da(pa,function(va){for(var wa in ra){var xa=ra[wa];if(!va[wa]&&ka(pa,xa))va[wa]=ra[wa];}ca(pa,va);pa._threadInformer.updatedUnseenState();});}function ja(pa,qa,ra){var sa=false;if(!v(qa))sa=true;if(sa)da(pa,function(ta){var ua=false;for(var va in qa){var wa=qa[va],xa=wa>=ta[va];if(ta[va]&&(!wa||xa)){delete ta[va];ua=true;}}if(ua){ca(pa,ta);pa._threadInformer.updatedUnseenState();if(ra&&fa(pa)===0)pa._serverRequests.markSeen();}});}function ka(pa,qa){return qa>pa._lastSeenTimestamp;}function la(pa,qa){return qa.map(pa._threadIDMap.convertThreadIDIfAvailable,pa._threadIDMap);}function ma(pa,qa){var ra=ea(pa);if(!ra)return;for(var sa in qa){var ta=qa[sa];if(ra[sa]){ra[ta]=ra[sa];delete ra[sa];}}ca(pa,ra);}function na(pa,qa){var ra=qa.thread_id?pa._threads.getThreadMetaNow(qa.thread_id):null,sa=ra?h.getFromMeta(ra):qa.folder;return sa===q.INBOX||sa===undefined;}function oa(pa){var qa=pa.message_counts||[];for(var ra=0;ra<qa.length;ra++)if(qa[ra].folder==q.INBOX)return qa[ra];return null;}f.exports=aa;},null);
__d('MercuryTimestamp',['fbt','formatDate','MercuryTimePassed'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=86400000,l=6*k,m={getFormatedTimestamp:function(n){var o=n/1000;return m.getFormattedTimestampByBucket(o,this.getTimeBucket(n));},getFormattedTimestampByBucket:function(n,o){switch(o){case j.TODAY:return {absolute:h._("H\u00f4m nay"),relative:i(n,'g:ia')};case j.WEEK_AGO:return {absolute:i(n,'l'),relative:i(n,'D')};case j.CURRENT_YEAR:return {absolute:i(n,'F j'),relative:i(n,'M j')};default:return {absolute:i(n,'F j, Y'),relative:i(n,'n/j/y')};}},getTimeBucket:function(n){var o=new Date(n),p=new Date(),q=new Date(p.getFullYear(),p.getMonth(),p.getDate());if(q<o){return j.TODAY;}else if(q-l<o){return j.WEEK_AGO;}else if(q.getFullYear()===o.getFullYear()){return j.CURRENT_YEAR;}else return j.OTHER_YEAR;},getPreciseTimestamp:function(n){return i(new Date(n),m.getPreciseFormat(n));},getPreciseFormat:function(n){var o=m.getTimeBucket(n);switch(o){case j.TODAY:return 'g:ia';case j.WEEK_AGO:return 'l g:ia';case j.CURRENT_YEAR:return 'F jS, g:ia';case j.OTHER_YEAR:default:return 'F j, Y g:i a';}}};f.exports=m;},null);
__d('MercurySyncNewMessageTransformer',['MercuryActionType','MercuryIDs','MercuryTimestamp','MessagingTag'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();function l(m,n){var o=parseInt(n.messageMetadata.timestamp,10),p=j.getFormatedTimestamp(o),q=[];if(n.attachments)q=n.attachments.map(function(r){return r.mercury;});return {message_id:n.messageMetadata.messageId,threading_id:null,offline_threading_id:n.messageMetadata.offlineThreadingId,author:i.getParticipantIDFromUserID(n.messageMetadata.actorFbId),author_email:n.messageMetadata.actorFbId+'@facebook.com',timestamp:o,timestamp_absolute:p.absolute,timestamp_relative:p.relative,timestamp_datetime:p.relative,timestamp_time_passed:j.getTimeBucket(o),is_unread:m!==n.messageMetadata.actorFbId,is_forward:false,is_filtered_content:false,is_filtered_content_bh:false,is_filtered_content_account:false,is_filtered_content_quasar:false,is_filtered_content_invalid_app:false,forward_count:0,forward_message_ids:[],source:n.messageMetadata.tags[0],is_spoof_warning:false,folder:k.INBOX,thread_fbid:n.messageMetadata.threadKey.threadFbId,other_user_fbid:n.messageMetadata.threadKey.otherUserFbId,body:n.body!==undefined?n.body:'',html_body:null,subject:null,has_attachment:q.length>0,attachments:q,ranges:undefined,thread_id:null,action_id:null,action_type:h.USER_GENERATED_MESSAGE,is_from_iris:true};}f.exports={transform:l};},null);
__d('MercurySyncDeltaTypes',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={NewMessage:'NewMessage'};f.exports=h;},null);
__d('MercurySyncDispatcher',['Arbiter','Map','MercuryConfig','MercuryDelayedDispatcher','MercuryPayloadSource','MercurySyncNewMessageTransformer','MercurySyncDeltaTypes','MercurySingletonProvider'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){'use strict';if(c.__markCompiled)c.__markCompiled();p.getForFBID=function(r){return q.getForFBID(r);};p.get=function(){return q.get();};function p(r){this.$MercurySyncDispatcher1=r;this.$MercurySyncDispatcher2=k.getForFBID(this.$MercurySyncDispatcher1);h.subscribe('channel/message:delta',(function(s,t){var u=t&&t.obj&&t.obj.delta;if(!u)return;this.process(u);}).bind(this));}p.prototype.process=function(r){switch(r['class']){case n.NewMessage:var s=!!r.stickerId||r.attachments&&!!r.attachments.length,t=m.transform(this.$MercurySyncDispatcher1,r);if(!s&&!j.WWWSyncMsgText){break;}else if(s&&!j.WWWSyncMsgAttach)break;this.$MercurySyncDispatcher3(t);break;default:break;}};p.prototype.$MercurySyncDispatcher3=function(r){var s=r.other_user_fbid||r.thread_fbid;this.$MercurySyncDispatcher2.handleUpdateWaitForThread({actions:[r],payload_source:l.CLIENT_CHANNEL_MESSAGE},s);};var q=new o(p);f.exports=p;},null);
__d('ChatBehavior',['Arbiter','AvailableList','AvailableListConstants','MercuryConstants'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=c('MercuryConstants').ChatNotificationConstants,l=false,m=i.getWebChatNotification&&i.getWebChatNotification(),n=l,o=true,p=Object.assign(new h(),{ON_CHANGED:'changed',notifiesUserMessages:function(){return m!==k.NO_USER_MESSAGE_NOTIFICATION;},ignoresRemoteTabRaise:function(){return n;},showsTabUnreadUI:function(){return o;}});function q(){p.inform(p.ON_CHANGED);}i.subscribe&&i.subscribe(j.ON_CHAT_NOTIFICATION_CHANGED,function(){var r=m,s=i.getWebChatNotification();m=s;if(r!=s)q();});h.subscribe('chat/set_does_page_occlude_tabs',function(r,s){n=!!s;q();});h.subscribe('chat/set_show_tab_unread_ui',function(r,s){o=!!s;q();});f.exports=p;},null);
__d('ChatDispatcher',['Dispatcher'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=new h();},null);
__d('ChatCookieInterface',['ChatConfig','InitialServerTime','LogHistory','PresenceState','PresenceUtil','areJSONRepresentationsEqual'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();var n=j.getInstance('chat_cookie'),o=i.serverTime,p=h.get('tab_max_load_age')||3600000,q=o-p,r={store:function(v,w){if(v.uct2==w.lastChangeTime)return v;var x=u(v,w),y={};if(!x){y.old_tabs=v&&v.t2&&JSON.stringify(v.t2);y.old_promoted=v&&v.lm2;y.old_time=v&&v.uct2;y.old_reason=v&&v.tr;y.old_window=v&&v.tw;var z=[];w.tabs.forEach(function(aa){if(!aa.fragile){var ba={i:aa.id,si:aa.server_id};if(aa.raised)ba.r=1;z.push(ba);}});v.t2=z;v.lm2=w.promotedID;v.uct2=w.lastChangeTime;v.tr=w.lastChangeReason;v.tw=l.getSessionID();y.new_tabs=JSON.stringify(v.t2);y.new_promoted=v.lm2;y.new_time=v.uct2;y.new_reason=v.tr;y.new_window=v.tw;n.debug('store',y);}else{y.tabs=v&&v.t2&&JSON.stringify(v.t2);y.promoted=v&&v.lm2;y.time=v&&v.uct2;y.reason=v&&v.tr;y.window=v&&v.tw;y.last_change_time=w.lastChangeTime;y.last_change_reason=w.lastChangeReason;y.min_change_time=q;n.warn('store_bad_state',y);}return v;},load:function(v,w){if(!v){n.warn('load_bad_state',v);return false;}var x=u(v,w);if(!x||x===w.lastChangeTime)return false;var y={};y.old_tabs=JSON.stringify(w.tabs);y.old_promoted=w.promotedID;y.old_time=w.lastChangeTime;y.old_reason=w.lastChangeReason;y.window_id=l.getSessionID();y.cookie_tabs=v&&v.t2&&JSON.stringify(v.t2);y.cookie_promoted=v&&v.lm2;y.cookie_time=v&&v.uct2;y.cookie_reason=v&&v.tr;y.cookie_window=v&&v.tw;w.lastChangeTime=x;w.lastChangeReason='load';var z=s(w,v.t2,v.lm2||null);y.load_result=z;y.new_tabs=JSON.stringify(w.tabs);y.new_promoted=w.promotedID;y.new_time=w.lastChangeTime;y.new_reason=w.lastChangeReason;var event='load';if(!w.isInitialized)event+='_init';n.log(event,y);return z;}};function s(v,w,x){var y;if(!t(v,w,x))return false;var z=v.tabs.filter(function(ca){return !!ca.fragile;}),aa={};v.promotedID=null;v.tabs=w.map(function(ca){var da={id:ca.i,server_id:ca.si};if(da.id==x)v.promotedID=da.id;if(ca.r)da.raised=true;aa[da.id]=da;return da;});v.tabs=v.tabs.filter(function(ca){return !!ca;});if(v.localRaised)for(var ba in v.localRaised)if(!aa[ba]||!aa[ba].raised)delete v.localRaised[ba];z=z.filter(function(ca){return !aa[ca.id];});(y=v.tabs).push.apply(y,z);return true;}function t(v,w,x){if(x!=v.promotedID)return true;var y=v.tabs.filter(function(ba){return !ba.fragile;});if(w.length!=y.length)return true;for(var z=0,aa=w.length;z<aa;z++)if(!m(w[z],y[z]))return true;return false;}function u(v,w){var x=k.verifyNumber(v.uct2);if(!x||typeof x!=='number'){n.warn('bad_cookie_version',v);return null;}if(x<w.lastChangeTime||x<q)return null;return x;}f.exports=r;},null);
__d('ChatTabActions',['ChatDispatcher','keyMirror'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=i({CLOSE_TAB:null,CLOSE_ALL_TABS:null,CLOSE_FRAGILE_TABS:null,LOWER_TAB:null,OPEN_FRAGILE_TAB:null,OPEN_TAB:null,PERSIST_LOCAL_STATE:null,PROMOTE_TAB:null,RAISE_TAB:null}),k={Types:j,closeTab:function(l,m){h.dispatch({actionType:j.CLOSE_TAB,reason:m,threadID:l});},closeAllTabs:function(){h.dispatch({actionType:j.CLOSE_ALL_TABS});},closeFragileTabs:function(){h.dispatch({actionType:j.CLOSE_FRAGILE_TABS});},lowerTab:function(l){h.dispatch({actionType:j.LOWER_TAB,threadID:l});},openFragileTab:function(l){h.dispatch({actionType:j.OPEN_FRAGILE_TAB,threadID:l});},openTab:function(l){h.dispatch({actionType:j.OPEN_TAB,threadID:l});},persistLocalState:function(){h.dispatch({actionType:j.PERSIST_LOCAL_STATE});},promoteTab:function(l){h.dispatch({actionType:j.PROMOTE_TAB,threadID:l});},raiseTab:function(l,m,n){h.dispatch({actionType:j.RAISE_TAB,signatureID:n,threadID:l,userAction:m});}};f.exports=k;},null);
__d('MercuryTimestampTracker',['MercuryActionType','MercuryPayloadSource','MercurySingletonMixin','MercuryDispatcher'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();function l(m){this._fbid=m;this._dispatcher=k.getForFBID(this._fbid);this._lastTimestamp=0;this._dispatcher.subscribe('update-messages',(function(n,o){if(!o.actions||!o.actions.length)return;if(o.payload_source==i.CLIENT_SEND_MESSAGE||o.payload_source==i.UNKNOWN)return;for(var p=0;p<o.actions.length;p++){var q=o.actions[p],r=q.action_type;if(r==h.USER_GENERATED_MESSAGE&&q.thread_id&&q.timestamp>this._lastTimestamp)this._lastTimestamp=q.timestamp;}}).bind(this));}Object.assign(l.prototype,{getLastUserMessageTimestamp:function(){return this._lastTimestamp;}});Object.assign(l,j);f.exports=l;},null);
__d('ChatTabModel',['Arbiter','ChatBehavior','ChatDispatcher','ChatConfig','ChatCookieInterface','ChatTabActions','EventEmitter','InitialServerTime','LogHistory','JSLogger','MercuryAssert','MercuryIDs','MercuryLocalIDs','PresenceState','PresenceUtil','MercuryThreadIDMap','MercuryThreads','MercuryTimestampTracker'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=c('MercuryThreadIDMap').get(),x=c('MercuryThreads').get(),y=c('MercuryTimestampTracker').get(),z=o.serverTime,aa=k.get('tab_max_load_age')||3600000,ba=20,ca=new n(),da=p.getInstance('chat_tab_model'),ea={tabs:[],promotedID:null,lastChangeTime:0,lastChangeReason:null,isInitialized:false,localRaised:null};function fa(ab){var bb=l.load(ab,ea);bb&&ja();return bb;}function ga(ab,bb,cb){var db=fa(u.get());if(bb===undefined||bb>ea.lastChangeTime){if(ab()){db=true;ea.lastChangeReason=cb||null;ia(bb);}}else da.error('rejected',{change_time:bb,state_time:ea.lastChangeTime});db&&ha();}function ha(){if(ea.isInitialized)ca.emit('change');}function ia(ab){if(ab===undefined)ab=Math.max(y.getLastUserMessageTimestamp()||1,ea.lastChangeTime+1);ea.lastChangeTime=ab;u.doSync();}function ja(ab){var bb=ea.tabs.length-ba;if(bb>0)ea.tabs=ea.tabs.filter(function(cb){return cb.raised||cb.id==ab||bb--<=0;});if(bb>0)ea.tabs=ea.tabs.filter(function(cb){return (cb.id==ea.promotedID||cb.id==ab||bb--<=0);});}function ka(ab){for(var bb=0;bb<ea.tabs.length;bb++)if(ea.tabs[bb].id==ab)return bb;return -1;}function la(ab,bb){var cb=x.getThreadMetaNow(ab);if(!cb)return false;if(cb.is_canonical_user){return oa(ab,bb);}else{var db=na(ab);if(db)w.getServerIDFromClientID(ab,function(eb){if(ra(ab,eb)){ia();ha();}});return db;}}function ma(ab){r.isThreadID(ab);if(na(ab))ha();}function na(ab){if(ka(ab)===-1){ea.tabs.push({id:ab,fragile:true});da.log('open_fragile_tab',{tabs:JSON.stringify(ea.tabs),opened:ab,window_id:v.getSessionID()});return true;}return false;}function oa(ab,bb){var cb=ka(ab);if(cb!=-1)if(ea.tabs[cb].fragile){ea.tabs.splice(cb,1);}else{bb&&(ea.tabs[cb].signatureID=bb);return true;}for(var db=0;db<=ea.tabs.length;db++)if(db==ea.tabs.length||ea.tabs[db].fragile){ea.tabs.splice(db,0,{id:ab,signatureID:bb});ja(ab);da.log('open_tab',{tabs:JSON.stringify(ea.tabs),opened:ab,window_id:v.getSessionID()});return true;}}function pa(ab,bb,cb){r.isThreadID(ab);var db=false;if(ea.localRaised&&bb){ea.localRaised[ab]=true;db=true;}ga(function(){if(la(ab,cb))db=true;var eb=ka(ab);if(eb!=-1&&!ea.tabs[eb].raised){ea.tabs[eb].raised=true;db=true;da.log('raise_tab',{tabs:JSON.stringify(ea.tabs),raised:ab,window_id:v.getSessionID()});}return db;});}function qa(ab){if(ka(ab)!==-1&&ea.promotedID!==ab){ea.promotedID=ab;return true;}return false;}function ra(ab,bb){var cb=ka(ab);if(cb!=-1&&ea.tabs[cb].fragile){var db=ea.tabs[cb];db.fragile=s.isLocalThread(ab);db.server_id=bb;var eb=[];ea.tabs.forEach(function(fb){if(fb.id!=ab){if(db&&fb.fragile){eb.push(db);db=null;}eb.push(fb);}});if(db)eb.push(db);ea.tabs=eb;da.log('make_permanent',{tabs:JSON.stringify(ea.tabs),tab_id:ab,window_id:v.getSessionID()});return true;}return false;}function sa(ab,bb){r.isThreadID(ab);var cb=false;if(ea.localRaised){delete ea.localRaised[ab];cb=true;}ga(function(){if(ta(ab))cb=true;return cb;},undefined,bb);}function ta(ab){var bb=ka(ab);if(ab==ea.promotedID)ea.promotedID=null;if(bb!=-1){ea.tabs.splice(bb,1);da.log('close_tab',{tabs:JSON.stringify(ea.tabs),closed:ab,window_id:v.getSessionID()});return true;}return false;}function ua(){if(ea.tabs.length){da.log('close_all_tabs',{closed_tabs:JSON.stringify(ea.tabs),window_id:v.getSessionID()});ea.tabs=[];ea.promotedID=null;if(ea.localRaised)ea.localRaised={};ia();ha();}}function va(){var ab=[];for(var bb=0;bb<ea.tabs.length;bb++)if(ea.tabs[bb].fragile&&!x.isNewEmptyLocalThread(ea.tabs[bb].id)){ab.push(ea.tabs[bb]);ea.tabs.splice(bb);ha();break;}da.log('close_fragile_tabs',{tabs:JSON.stringify(ea.tabs),fragile_closed:ab,window_id:v.getSessionID()});}function wa(ab){r.isThreadID(ab);var bb=false;if(ea.localRaised){delete ea.localRaised[ab];bb=true;}ga(function(){var cb=ka(ab);if(cb!=-1&&ea.tabs[cb].raised){delete ea.tabs[cb].raised;da.log('lower_tab',{tabs:JSON.stringify(ea.tabs),lowered:ab,window_id:v.getSessionID()});bb=true;}return bb;});}function xa(){if(ea.localRaised){ga(function(){var ab=false;ea.tabs.forEach(function(bb){if(bb.raised!=ea.localRaised[bb.id]){ab=true;if(ea.localRaised[bb.id]){bb.raised=true;}else delete bb.raised;}});return ab;});da.log('persist_local_raise',{tabs:JSON.stringify(ea.tabs),window_id:v.getSessionID()});}}u.registerStateStorer(function(ab){return l.store(ab,ea);});u.registerStateLoader(function(ab){if(fa(ab))ha();});var ya={isTabPromoted:function(ab){if(ab)return ab==ea.promotedID;return false;},indexOf:function(ab){return ka(ab);},getTab:function(ab){r.isThreadID(ab);var bb=this.indexOf(ab);if(bb>-1){var cb=ea.tabs[bb];return babelHelpers._extends({},cb);}return null;},getEmptyTab:function(){var ab;for(var bb=0;bb<ea.tabs.length;bb++){ab=ea.tabs[bb].id;if(x.isNewEmptyLocalThread(ab))return ab;}ab=t.generateThreadID();x.createNewLocalThread(ab,[]);return ab;},get:function(){var ab=ea.tabs.map(function(bb){var cb=babelHelpers._extends({},bb);delete cb.fragile;if(ea.localRaised)cb.raised=ea.localRaised[cb.id];return cb;});return {tabs:ab,promoted:ea.promotedID};},promoteThreadInPlaceOfThread:function(ab,bb,cb,db){r.isThreadID(ab);r.isThreadID(bb);ga(function(){var eb=ka(ab),fb=ka(bb);if(db){ea.promotedID=ab;}else if(ea.promotedID===bb)return true;var gb=ea.tabs[eb];if(cb){r.isThreadID(cb);var hb=ka(cb),ib=ea.tabs[fb];ea.tabs[fb]=gb;ea.tabs.splice(eb,1);ea.tabs.splice(hb,0,ib);}else{ea.tabs[eb]=ea.tabs[fb];ea.tabs[fb]=gb;}return true;});},addListener:function(ab){return ca.addListener('change',ab);}};h.subscribe(q.DUMP_EVENT,function(ab,bb){bb.chat_tabs={promoted:ea.promotedID,tabs:ea.tabs.map(function(cb){return babelHelpers._extends({},cb);}),time:ea.lastChangeTime,max_load_age:aa};});function za(){var ab=i.ignoresRemoteTabRaise();if(ab&&!ea.localRaised){da.log('start_ignore_remote_raise');ea.localRaised={};ha();}else if(!ab&&ea.localRaised){da.log('stop_ignore_remote_raise');ea.localRaised=null;ha();}}j.register(function(ab){switch(ab.actionType){case m.Types.CLOSE_TAB:sa(ab.threadID,ab.reason);break;case m.Types.CLOSE_ALL_TABS:ua();break;case m.Types.CLOSE_FRAGILE_TABS:va();break;case m.Types.LOWER_TAB:wa(ab.threadID);break;case m.Types.OPEN_FRAGILE_TAB:ma(ab.threadID);break;case m.Types.OPEN_TAB:r.isThreadID(ab.threadID);ga(function(){return la(ab.threadID);});break;case m.Types.PERSIST_LOCAL_STATE:xa();break;case m.Types.PROMOTE_TAB:r.isThreadID(ab.threadID);ga(qa.bind(null,ab.threadID));break;case m.Types.RAISE_TAB:pa(ab.threadID,ab.userAction,ab.signatureID);break;}});i.subscribe(i.ON_CHANGED,za);za();fa(u.getInitial(),true);if(ea.lastChangeTime===0)ea.lastChangeTime=z-600000;ea.isInitialized=true;f.exports=ya;},null);
__d('ChatTabPresence',['AvailableList','ChatTabModel','MercuryIDs'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k={};function l(m){var n=j.getUserIDFromThreadID(m);if(n)h.updateForID(n);}i.addListener(function(){var m=i.get();m.tabs.forEach(function(n){if(n.raised&&!k[n.id])l(n.id);});k={};m.tabs.forEach(function(n){if(n.raised)k[n.id]=true;});});f.exports={};},null);
__d('ChatTypeaheadBehavior',['BanzaiLogger','ChatOpenTab','ChatTypeaheadEvent','CSS','MercuryTypeaheadConstants','Parent','Rect','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();function p(r,s){var t=m.byClass(r,"_4oes");if(t)k.conditionClass(t,"_5q83",s);}function q(r){'use strict';this._typeahead=r;this._loggedQuery=false;}q.prototype.enable=function(){'use strict';var r=this._typeahead;this._subscriptions=[r.subscribe('focus',(function(){this._loggedQuery=false;r.getData().refreshData();p(r.getElement(),true);}).bind(this)),r.subscribe('blur',(function(s){if(this._loggedQuery)h.log('ChatTypeaheadLoggerConfig',{event:j.ABANDONED_QUERY,max_results:r.getData().getMaxResults(),num_friend_results:r.getView().results.filter(function(t){return t.render_type===l.FRIEND_TYPE;}).length,query:r.getCore().value});r.getCore().reset();p(r.getElement(),false);this._loggedQuery=false;}).bind(this)),r.subscribe('respond',(function(s,t){if(!this._loggedQuery&&r.getCore().getValue().length>0){h.log('ChatTypeaheadLoggerConfig',{event:j.NEW_QUERY});this._loggedQuery=true;}if(t.value&&t.value===r.getCore().getValue()){if(!t.results.length){var u=t.value.toLowerCase(),v=r.getData().getQueryCache();if(!t.isAsync&&!v.hasOwnProperty(u))return;r.getView().showNoResults();}k.addClass(r.getElement(),'hasValue');}}).bind(this)),r.subscribe('reset',function(){k.removeClass(r.getElement(),'hasValue');}),r.subscribe('select',(function(s,t){var u=t.selected.uid;if(t.selected.mercury_thread&&!t.selected.mercury_thread.is_canonical)u=t.selected.mercury_thread.thread_fbid;r.getView().hide();h.log('ChatTypeaheadLoggerConfig',{event:j.RESULT_SELECTED,max_results:r.getData().getMaxResults(),result_type:t.selected.render_type,query:r.getCore().value});this._loggedQuery=false;i.openTabByType(u,t.selected.type,'typeahead');}).bind(this)),r.subscribe('highlight',function(s,t){if(t.index>=0){var u=r.getView().getItems()[t.index];if(u){var v=new n(u),w=u.offsetParent,x=v.boundWithin(new n(w)).getPositionVector();v.getPositionVector().sub(x).scrollElementBy(w);}}})];};q.prototype.disable=function(){'use strict';this._subscriptions.forEach(function(r){this._typeahead.unsubscribe(r);},this);this._subscriptions=null;};Object.assign(q.prototype,{_subscriptions:null});f.exports=q;},null);
__d('ChatActivity',['Event','Arbiter','AvailableList','AvailableListConstants','JSLogger','MercuryConfig','PresenceState','UserActivity'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=m.activity_limit||60000,q=m.idle_limit||1800000,r=m.idle_poll_interval||300000,s=l.create('chat_activity'),t=Date.now(),u=t,v=true;function w(){var aa=Date.now();return !!(v&&aa-t<p);}var x=Object.assign(new i(),{isActive:w});function y(){var aa=t;t=Date.now();if(t-aa>q){s.debug('idle_to_active',aa);n.doSync();}x.inform('activity');}j.subscribe(k.ON_AVAILABILITY_CHANGED,function(){if(!j.isUserIdle())u=Date.now();});h.listen(window,'focus',function(){v=true;y();});h.listen(window,'blur',function(){v=false;});o.subscribe(function(){y();});function z(aa){var ba=aa&&aa.at&&n.verifyNumber(aa.at);if(typeof ba!=='number')ba=null;return ba||0;}setInterval(function(){var aa=Date.now(),ba=z(n.get()),ca=Math.max(t,ba,u);if(aa-ca>q){s.debug('idle',{cookie:ba,local:t,presence:u});x.inform('idle',aa-ca);}},r);n.registerStateStorer(function(aa){var ba=z(aa);if(ba<t)aa.at=t;return aa;});i.subscribe(l.DUMP_EVENT,function(aa,ba){ba.chat_activity={activity_limit:p,idle_limit:q,idle_poll_interval:r,last_active_time:t,last_global_active_time:u};});f.exports=x;},null);
__d('ChatMentionsNotifications',['fbt','CurrentUser','MercuryParticipants'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k={notifyIfMessageToMe:function(l){var m='fbid:'+i.getID(),n=l.body;j.get(m,function(o){var p=new RegExp(o.short_name,"i");if(p.test(n))k._notify(l);});},_notify:function(l){var m=48,n=l.body;if(n.length>m)n=n.substr(0,m-3)+"...";new Notification(h._("B\u1ea1n \u0111\u00e3 \u0111\u01b0\u1ee3c g\u1eafn th\u1ebb trong m\u1ed9t tin nh\u1eafn!"),{body:n,icon:"http://facebook.com//images/icons-large/fb-xl.png"});}};f.exports=k;},null);
__d('ChatTabViewInstances',['Map'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=new h();},null);
__d('ChatSidebarActionTypes',['keyMirror'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=h({INIT:null,LOADED:null,SET_ENABLED:null,SHOW:null,TOGGLE:null});},null);
__d('ChatSidebarStore',['ChatDispatcher','ChatOptionsInitialData','ChatSidebarActionTypes','FluxStore','SidebarType','performanceAbsoluteNow'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n,o;'use strict';n=babelHelpers.inherits(p,k);o=n&&n.prototype;function p(){o.constructor.call(this,h);this.$ChatSidebarStore1={initialized:false,initTime:m(),loaded:false,enabled:!!i.sidebar_mode,visible:null};this.$ChatSidebarStore2={};}p.prototype.__onDispatch=function(q){var r=q.type;this.$ChatSidebarStore2=babelHelpers._extends({},this.$ChatSidebarStore1);switch(r){case j.INIT:if(!this.$ChatSidebarStore2.initialized)this.$ChatSidebarStore1.initTime=m();this.$ChatSidebarStore1.initialized=true;break;case j.LOADED:this.$ChatSidebarStore1.loaded=true;break;case j.SHOW:this.$ChatSidebarStore1.visible=q.sidebarType;break;case j.SET_ENABLED:this.$ChatSidebarStore1.enabled=q.enabled;this.$ChatSidebarStore1.visible=q.sidebarType;break;case j.TOGGLE:this.$ChatSidebarStore1.enabled=!this.$ChatSidebarStore1.enabled;this.$ChatSidebarStore1.visible=this.$ChatSidebarStore1.enabled?q.visible:l.BUDDYLIST;break;}for(var s in this.$ChatSidebarStore1)if(this.$ChatSidebarStore1.hasOwnProperty(s))if(this.$ChatSidebarStore1[s]!==this.$ChatSidebarStore2[s]){this.__emitChange();break;}};p.prototype.getPrevState=function(){return this.$ChatSidebarStore2;};p.prototype.getState=function(){return this.$ChatSidebarStore1;};p.prototype.isInitialized=function(){return this.$ChatSidebarStore1.initialized;};p.prototype.isLoaded=function(){return this.$ChatSidebarStore1.loaded;};p.prototype.isEnabled=function(){return this.$ChatSidebarStore1.enabled;};p.prototype.getInitTime=function(){return this.$ChatSidebarStore1.initTime;};p.prototype.getVisibleType=function(){return this.$ChatSidebarStore1.visible;};f.exports=new p();},null);
__d('OrderedFriendsList',['AvailableListConstants','PresenceStatus','SearchableEntry','ShortProfiles','WorkModeConfig','createArrayFromMixed','isValidUniqueID','InitialChatFriendsList'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=[],p=[],q={},r=[],s={},t=[],u={contains:function(v){return v in q;},getList:function(){if(l.is_work_user)return m(o);u.reRank();var v=m(o);v=v.filter(function(w){var x=k.getNowUnsafe(w);return !x||x.type=='friend'||x.is_nonfriend_messenger_contact;});return v;},getSearchableEntries:function(v,w){var x=u.getList();k.getMulti(x.slice(0,v),function(y){var z=[];for(var aa in y)z.push(u.normalizeProfileEntry(y[aa],aa));var ba=u.getGroups().map(u.normalizeThreadEntry);w(z.concat(ba).filter(function(ca){return !!ca;}).sort(function(ca,da){return ca.getOrder()-da.getOrder();}));});},normalizeProfileEntry:function(v,w){var x=v.searchTokens||[];return new j({uniqueID:v.id||w,keywordString:x.join(' '),order:u.getRank(v.id||w),photo:v.thumbSrc,title:v.name,type:v.type,uri:v.uri,auxiliaryData:{isMessengerUser:v.is_messenger_user}});},normalizeThreadEntry:function(v,w){var x=v.mercury_thread,y=v.participants_to_render,z=v.text,aa=null;if(!z)z=x.name;var ba=y.map(function(da){return da.name;}).join(', ');if(!z){z=ba;}else aa=ba;var ca=v.uid;if(!z||!n(ca))return null;return new j({uniqueID:ca,order:w,photo:x.image_src,title:z,subtitle:aa,type:'thread',auxiliaryData:{participantsToRender:y,thread:x}});},getRank:function(v){return v in q?q[v]:o.length;},getActiveList:function(){if(r.length>0)return r;return u.getList();},getActiveRank:function(v){return v in s?s[v]:u.getRank(v);},reRank:function(){o=[];var v=0;t.forEach(function(w){var x=w.slice(0,-2),y=w.slice(-1);if(i.get(x)==y){o[v]=x;q[x]=v++;}});},rankActive:function(){var v=0;t.forEach(function(w){var x=w.slice(0,-2),y=w.slice(-1);if(y==h.ACTIVE){r[v]=x;s[x]=v++;}});},getGroups:function(){return p;}};(function(){var v=c('InitialChatFriendsList');o=v.list.length?v.list:[];p=v.groups||[];if(!l.is_work_user){t=o.slice();u.rankActive();u.reRank();}else o.forEach(function(w,x){q[w]=x;});})();f.exports=b.OrderedFriendsList||u;},null);
__d('ChatSidebarVisibility',['ChatConfig','ChatSidebarStore','DOMDimensions','OrderedFriendsList'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l=h.get('sidebar.min_friends'),m=h.get('sidebar.minimum_width'),n=h.get('minisidebar.minimum_width'),o={getViewport:function(){return j.getViewportWithoutScrollbarDimensions();},hasLowFriendCount:function(){return k.getActiveList().length<=l;},isViewportCapable:function(){var p=o.getViewport();return p.width>m;},isViewportCapableForMiniSidebar:function(){var p=o.getViewport();return p.width>n&&p.width<=m;},shouldShowSidebar:function(){return o.shouldShowSidebarIgnoreEnabled()&&i.isEnabled();},shouldShowMiniSidebar:function(){return o.shouldShowMiniSidebarIgnoreEnabled()&&i.isEnabled();},shouldShowSidebarIgnoreEnabled:function(){return o.isViewportCapable()&&!o.hasLowFriendCount();},shouldShowMiniSidebarIgnoreEnabled:function(){return !h.get('divebar_new_design',false)&&o.isViewportCapableForMiniSidebar()&&!o.hasLowFriendCount();}};f.exports=o;},null);
__d('ChatSidebarActions',['ChatDispatcher','ChatSidebarActionTypes','ChatSidebarVisibility','SidebarType'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();function l(){if(j.shouldShowSidebar()){return k.SIDEBAR;}else if(j.shouldShowMiniSidebar())return k.MINI_SIDEBAR;return k.BUDDYLIST;}function m(){if(j.shouldShowSidebarIgnoreEnabled()){return k.SIDEBAR;}else if(j.shouldShowMiniSidebarIgnoreEnabled())return k.MINI_SIDEBAR;return k.BUDDYLIST;}var n={init:function(){h.dispatch({type:i.INIT});},loaded:function(){h.dispatch({type:i.LOADED});},disable:function(){h.dispatch({type:i.SET_ENABLED,enabled:false,sidebarType:k.BUDDYLIST});},enable:function(){h.dispatch({type:i.SET_ENABLED,enabled:true,sidebarType:m()});},show:function(){h.dispatch({type:i.SHOW,sidebarType:l()});},toggle:function(){h.dispatch({type:i.TOGGLE,sidebarType:l()});}};f.exports=n;},null);
__d('FBRTCCallBlockingStore',['Arbiter','AsyncRequest','BanzaiLogger','ChannelConstants','FBRTCDispatcher','FBRTCStore','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o,p;'use strict';var q=false,r=0,s=null,t='call_block_setting_changed';o=babelHelpers.inherits(u,m);p=o&&o.prototype;u.prototype.init=function(v){this.$FBRTCCallBlockingStore1(v);h.subscribe(k.getArbiterType('videocall_block_setting'),this.$FBRTCCallBlockingStore2.bind(this));};u.prototype.__onDispatch=function(v){if(v.type!==t)return;this.$FBRTCCallBlockingStore1(v.data);};u.prototype.$FBRTCCallBlockingStore1=function(v){switch(v){case 0:q=false;this.$FBRTCCallBlockingStore3();break;case -1:q=true;this.$FBRTCCallBlockingStore3();break;default:q=true;this.$FBRTCCallBlockingStore4(v);}this.__emitChange();};u.prototype.$FBRTCCallBlockingStore4=function(v){if(s===null)s=n(this.turnOnVideoCalling.bind(this),v*1000);};u.prototype.getBlockingStatus=function(){return q;};u.prototype.turnOnVideoCalling=function(){new i('/ajax/chat/settings.php').setHandler(this.$FBRTCCallBlockingStore5.bind(this)).setData({call_blocked_until:0}).send();};u.prototype.turnOffVideoCalling=function(v){r=v;new i('/ajax/chat/settings.php').setHandler(this.$FBRTCCallBlockingStore6.bind(this)).setData({call_blocked_until:v}).send();};u.prototype.$FBRTCCallBlockingStore3=function(){if(s){clearTimeout(s);s=null;}};u.prototype.$FBRTCCallBlockingStore5=function(){l.dispatch({type:t,data:0});j.log('VideoCallLoggerConfig',{event:t,message:'enable'});};u.prototype.$FBRTCCallBlockingStore6=function(){l.dispatch({type:t,data:r});j.log('VideoCallLoggerConfig',{event:t,message:'disable_'+r});};u.prototype.$FBRTCCallBlockingStore2=function(v,w){l.dispatch({type:t,data:w.obj.value});};function u(){o.apply(this,arguments);}f.exports=new u();},null);
__d('MercuryNotificationRenderer',['MercuryAssert','MercuryParticipants','MercuryViewer','fbt','MercuryMessages','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=c('MercuryMessages').get(),m=c('MercuryThreads').get();function n(o,p){h.isThreadID(o);m.getThreadMeta(o,function(q){l.getThreadMessagesRange(o,0,1,function(r){var s=r.length&&r[r.length-1];if(s&&s.author!=j.getID()){i.get(s.author,function(t){if(q.name){p(k._("{senderName} \u0111\u00e3 nh\u1eafn tin {groupName}",[k.param('senderName',t.short_name),k.param('groupName',q.name)]));}else p(k._("{name} \u0111\u00e3 nh\u1eafn tin cho b\u1ea1n",[k.param('name',t.short_name)]));});}else p(k._("Tin nh\u1eafn m\u1edbi!"));});});}f.exports={renderDocumentTitle:n};},null);
__d('ChatTitleBarBlinker',['ChatActivity','ChatConfig','DocumentTitle','FavIcon','JSLogger','MercuryNotificationRenderer','PresenceState','MercuryThreadInformer','MercuryTimestampTracker'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=c('MercuryThreadInformer').get(),p=c('MercuryTimestampTracker').get(),q=l.create('chat_title'),r=null,s=0,t=false;if(i.get('unreadFavicon'))k.setToggleResources(i.get('unreadFaviconURL'));function u(){if(r){r.stop();r=null;return true;}return false;}function v(aa){var ba=aa||p.getLastUserMessageTimestamp();if(s<=ba){s=ba;if(u()||t)n.doSync();}if(i.get('unreadFavicon')&&k.isToggledResource())k.toggle();}var w={blink:function(aa,ba){if(!r&&s<ba)m.renderDocumentTitle(aa,function(ca){if(!r)r=j.blink(ca);});},stopBlinking:function(){v();},blinkingElsewhere:function(){t=true;}};function x(aa){var ba=n.verifyNumber(aa.sb2);if(!ba||ba<=s)return null;return ba;}function y(aa){var ba=aa&&x(aa);if(ba){s=ba;q.debug('load',s);u();t=false;}}function z(aa){var ba=x(aa);if(!ba){q.debug('store',s);aa.sb2=s;t=false;}return aa;}n.registerStateStorer(z);n.registerStateLoader(y);o.subscribe('thread-read-changed',function(aa,ba){var ca=p.getLastUserMessageTimestamp(),da=0;for(var ea in ba)if(ba[ea].mark_as_read&&ba[ea].timestamp>=ca&&ba[ea].timestamp>da)da=ba[ea].timestamp;da&&v(da);});h.subscribe('activity',function(){v();});(function(){var aa=n.getInitial();if(aa)s=x(aa)||0;})();f.exports=w;},null);
__d('MercuryGroupThreadMentions',['CurrentUser','ShortProfiles'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={messageMentionsViewer:function(k,l){i.get(h.getID(),function(m){l(new RegExp('@'+m.firstName,'i').test(k.body));});}};f.exports=j;},null);
__d('MercuryBrowserAlerts',['ArbiterMixin','ChatActivity','ChatConfig','ChatOptions','ChatTitleBarBlinker','MercuryConfig','MercuryGroupThreadMentions','MercuryThreadInfo','MercuryViewer','MessagingTag','Sound','MercuryBlockedParticipants','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();var s=c('MercuryBlockedParticipants').get(),t=c('MercuryThreads').get();r.init(['audio/ogg','audio/mpeg']);function u(w){if(k.getSetting('sound'))r.play([j.get('sound.notif_ogg_url'),j.get('sound.notif_mp3_url')],w,false);}var v={messageReceived:function(w){if(p.isViewer(w.author)||!w.is_unread||w.folder!=q.INBOX&&w.folder!=q.ARCHIVED)return;var x=w.thread_id,y=i.isActive();if(y){var z=false;v.inform('before-alert',{threadID:x,cancelAlert:function(){z=true;}});}t.getThreadMeta(x,function(aa){var ba=o.isMuted(aa);n.messageMentionsViewer(w,function(ca){if(ba&&(!m.GroupChatMentionsGK||!ca))return;if(s.isPresentInGroupThread(aa))return;var da=w.timestamp;if(y){!z&&u(da);}else{l.blink(x,da);u(da);}l.blinkingElsewhere();});});}};f.exports=Object.assign(v,h);},null);
__d('ChatNewMessageHandler',['ChatActivity','ChatMentionsNotifications','ChatTabModel','ChatTabViewInstances','JSLogger','MercuryAssert','MercuryBrowserAlerts','UserActivity','MercuryConfig','MercuryThreadlistConstants'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r=l.create('chat_new_message'),s={_notify:function(t,u,v){if(p.DesktopNotificationsGK)i.notifyIfMessageToMe(u);var w=k.get(t);v.view_is_visible=w&&w.isVisible();v.view_is_focused=w&&w.isFocused();if(!v.view_is_visible)r.log('message_to_hidden');v.is_active=h.isActive();n.messageReceived(u);},newMessage:function(t,u){m.isThreadID(t);var v=j.getTab(t),w={thread_id:t,message_id:u.message_id,to_new_tab:!v,to_raised_tab:v?!!v.raised:true};this._notify(t,u,w);r.log('message',w);}};n.subscribe('before-alert',function(t,event){var u=event.threadID,v=k.get(u),w=j.getTab(u),x=q.MESSAGE_NOTICE_INACTIVITY_THRESHOLD;if(w&&w.raised&&v&&v.isVisible()&&v.isFocused()&&o.isActive(x)){v.tryMarkAsRead();event.cancelAlert();}});f.exports=s;},null);
__d('ChatTabLRUManager',['ChatTabViewInstances','ChatTabModel','InitialServerTime','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=c('MercuryThreads').get(),l={getLRUVisibleTab:function(m){if(m.hasRoomForRaisedTab())return undefined;var n=Object.keys(m.getTabsToShow()||{}),o=1*60,p=null,q=Infinity;for(var r=0;r<n.length;r++){var s=n[r],t=k.getThreadMetaNow(s);if(i.isTabPromoted(s))continue;if(!h.get(s).hasEmptyInput()||!t)continue;var u=(j.serverTime-t.timestamp)/1000;if(!t.timestamp||t.timestamp&&t.timestamp<q&&u>o){p=t.thread_id;q=t.timestamp;}}return p;}};f.exports=l;},null);
__d('ChatTabPolicy',['ChatBehavior','JSLogger','MercuryActionType','MercuryLogMessageType','MercuryAssert','MercuryConfig','MercuryGroupThreadMentions','MercuryIDs','MercuryParticipantTypes','MercurySourceType','MercuryThreadInfo','MercuryViewer','MessagingTag','PresencePrivacy','ShortProfiles','WorkModeConfig','MercuryBlockedParticipants','MercuryThreadActions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();var x=c('MercuryBlockedParticipants').get(),y=c('MercuryThreadActions').get(),z=i.create('tab_policy');f.exports={messageIsAllowed:function(aa,ba,ca){var da=aa.thread_id,ea=ba.message_id;l.isThreadID(da);l.isParticipantID(ba.author);var fa;if(r.isMuted(aa)){fa={thread_id:da,message_id:ea,mute_settings:aa.mute_settings};z.log('message_thread_muted',fa);if(m.GroupChatMentionsGK)n.messageMentionsViewer(ba,function(ia){if(ia)ca();});return;}if(aa.read_only){fa={thread_id:da,message_id:ea,mode:aa.mode};z.log('message_read_only',fa);return;}if(ba.source==q.EMAIL||ba.source==q.TITAN_EMAIL_REPLY){fa={thread_id:da,message_id:ea,source:ba.source};z.log('message_source_not_allowed',fa);return;}var ga=o.getUserIDFromParticipantID(ba.author);if(!ga){z.log('message_bad_author',{thread_id:da,message_id:ea,user:ga});return;}if(ba.action_type!=j.USER_GENERATED_MESSAGE&&!this._messageIsNewlyCreatedGroup(ba,aa)){fa={thread_id:da,message_id:ea,type:ba.action_type};z.log('message_non_user_generated',fa);return;}if(aa.is_canonical_user&&!h.notifiesUserMessages()){z.log('message_jabber',{thread_id:da,message_id:ea});y.markSeen(da,true);return;}if(aa.is_canonical&&!aa.other_user_fbid){z.log('message_canonical_contact',{thread_id:da,message_id:ea});return;}if(aa.folder!=t.INBOX){z.log('message_folder',{thread_id:da,message_id:ea,folder:aa.folder});return;}if(x.isPresentInGroupThread(aa)){fa={thread_id:da,message_id:ea};z.log('message_blocked_participants',fa);return;}var ha=o.getUserIDFromParticipantID(s.getID());v.getMulti([ga,ha],function(ia){if(!u.allows(ga)){z.log('message_privacy',{thread_id:da,message_id:ea,user:ga});return;}var ja=ia[ga].employee&&ia[ha].employee,ka=w.is_work_user;if(!ja&&!ka&&!ia[ga].isCommercePage&&ia[ga].type!==p.FRIEND){z.log('message_non_friend',{thread_id:da,message_id:ea,user:ga});return;}ca();});},_messageIsNewlyCreatedGroup:function(aa,ba){return aa.action_type===j.LOG_MESSAGE&&aa.log_message_type===k.THREAD_NAME&&ba.message_count===1;}};},null);
__d('ChatTabViewEvents',['Arbiter'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=new h();},null);
__d('MercuryParticipantListRenderer',['fbt'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();function i(){this.$MercuryParticipantListRenderer1=false;this.$MercuryParticipantListRenderer2=false;this.$MercuryParticipantListRenderer3=false;this.$MercuryParticipantListRenderer4=(function(s){return this.$MercuryParticipantListRenderer2?s.short_name:s.name;}).bind(this);}i.prototype.renderParticipantList=function(s){var t=s.map(this.$MercuryParticipantListRenderer4);switch(t.length){case 0:return j(this.$MercuryParticipantListRenderer1);case 1:return k(t);case 2:return this.$MercuryParticipantListRenderer3?m(t):l(t);case 3:return this.$MercuryParticipantListRenderer3?o(t):n(t);default:return this.$MercuryParticipantListRenderer3?q(t):p(t);}};i.prototype.setIsNewThread=function(s){this.$MercuryParticipantListRenderer1=s;return this;};i.prototype.setNameRenderer=function(s){this.$MercuryParticipantListRenderer4=s;return this;};i.prototype.setUseShortName=function(s){this.$MercuryParticipantListRenderer2=s;return this;};i.prototype.setUseAndSeparator=function(s){this.$MercuryParticipantListRenderer3=s;return this;};function j(s){if(s){return h._("Tin nh\u1eafn m\u1edbi");}else return h._("Kh\u00f4ng c\u00f3 ng\u01b0\u1eddi tham gia n\u00e0o");}function k(s){return s[0];}function l(s){return h._("{participant1}, {participant2}",[h.param('participant1',s[0]),h.param('participant2',s[1])]);}function m(s){return h._("{participant1} v\u00e0 {participant2}",[h.param('participant1',s[0]),h.param('participant2',s[1])]);}function n(s){return h._("{participant1}, {participant2}, {participant3}",[h.param('participant1',s[0]),h.param('participant2',s[1]),h.param('participant3',s[2])]);}function o(s){return h._("{participant1}, {participant2} v\u00e0 {participant3}",[h.param('participant1',s[0]),h.param('participant2',s[1]),h.param('participant3',s[2])]);}function p(s){return h._("{participant1}, {participant2}, {participant3}, {others_link}",[h.param('participant1',s[0]),h.param('participant2',s[1]),h.param('participant3',s[2]),h.param('others_link',r(s.length-3))]);}function q(s){return h._("{participant1}, {participant2} v\u00e0 {others_link}",[h.param('participant1',s[0]),h.param('participant2',s[1]),h.param('others_link',r(s.length-2))]);}function r(s){if(s>1){return h._({"*":"{others_count} ng\u01b0\u1eddi kh\u00e1c"},[h.param('others_count',s,[0])]);}else return h._("1 ng\u01b0\u1eddi kh\u00e1c");}f.exports=i;},null);
__d('MercuryThreadTitle.react',['MercuryIDs','MercuryParticipantListRenderer','MercuryParticipants','React','TextWithEmoticons.react','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();var n=k.PropTypes,o=k.createClass({displayName:'MercuryThreadTitle',propTypes:{isNewThread:n.bool,thread:n.object.isRequired,viewer:n.string.isRequired,showUnreadCount:n.bool,useShortName:n.bool,useAndSeparator:n.bool},getDefaultProps:function(){return {isNewThread:false,showUnreadCount:false,useShortName:false,useAndSeparator:false};},getInitialState:function(){return {participantNames:''};},componentDidMount:function(){this._renderParticipantsList(this.props);},componentWillReceiveProps:function(p){this._renderParticipantsList(p);},render:function(){return (k.createElement('span',{className:this.props.className},this.props.thread.name?this._renderThreadTitle():this.state.participantNames,this.props.children));},getTitle:function(){return this.state.participantNames;},_renderThreadTitle:function(){var p=this.props.thread,q=k.createElement(l,{renderEmoticons:true,renderEmoji:true,text:p.name});if(!p.unread_count||!this.props.showUnreadCount)return q;return this._renderTitleWithUnreadCount(q,p.unread_count);},_renderParticipantsList:function(p){if(p.thread.name)return;var q=h.getParticipantIDFromUserID(p.viewer),r=p.thread.participants;if(r.length>1)r=r.filter(function(s){return s!=q;});j.getMulti(r,(function(s){if(!this.isMounted())return;var t=r.map(function(w){return s[w];}),u=new i().setUseShortName(this.props.useShortName).setUseAndSeparator(this.props.useAndSeparator).setIsNewThread(this.props.isNewThread).renderParticipantList(t),v=p.showUnreadCount&&p.thread.unread_count?this._renderTitleWithUnreadCount(u,p.thread.unread_count):u;this.setState({participantNames:v});}).bind(this));},_renderTitleWithUnreadCount:function(p,q){return m._("{conversation-title} ({unread-count})",[m.param('conversation-title',p),m.param('unread-count',q)]);}});f.exports=o;},null);
__d('NubController',['ArbiterMixin','Dock'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(){}Object.assign(j.prototype,h,{init:function(k){this.el=k;i.registerNubController(k,this);return this;},buttonContentChanged:function(){this.inform('nub/button/content-changed');},flyoutContentChanged:function(){this.inform('nub/flyout/content-changed');},hide:function(){i.hide(this.el);},show:function(){i.show(this.el);}});f.exports=j;},null);
__d('ChatTabViewSelector',['Arbiter','ArbiterMixin','CSS','ChatTabActions','CurrentUser','DOM','DataStore','Event','MenuDeprecated','MercuryThreadTitle.react','NubController','React','ReactDOM','ChatTabTemplates','Toggler','MercuryThreadInformer','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=c('MercuryThreadInformer').get(),x=c('MercuryThreads').get();function y(z){var aa=u[':fb:chat:tab:selector'].build(),ba=aa.getRoot(),ca=aa.getNode('menu'),da=m.find(ca,'.uiMenuInner'),ea={},fa=new r().init(ba);j.hide(ba);m.insertBefore(z,ba);function ga(ja){var ka=0;for(var la in ea){var ma=ea[la],na=x.getThreadMetaNow(la),oa=ma.getNode('unreadCount'),pa=na&&na.unread_count||0;ka+=pa;if(pa>9)pa='+';j.conditionClass(oa,'invisible_elem',!pa);m.setContent(oa,pa);}var qa=aa.getNode('numMessages');j.conditionShow(qa,ka);m.setContent(qa,ka);}this.setTabData=function(ja){var ka=ea;ea={};if(ja.length<1){j.hide(ba);return;}j.show(ba);m.empty(da);ja.forEach(function(na){var oa=u[':fb:chat:tab:selector:item'].build(),pa=oa.getNode('content');ea[na.id]=oa;x.getThreadMeta(na.id,function(ra){t.render(s.createElement(q,{thread:ra,useAndSeparator:true,viewer:l.getID()}),pa);});m.prependContent(da,oa.getRoot());n.set(oa.getRoot(),'threadID',na.id);var qa=oa.getNode('closeButton');o.listen(qa,'click',function(event){k.closeTab(na.id,'selector/close-tab');event.kill();});});for(var la in ka)if(ka.hasOwnProperty(la)){var ma=ka[la].getNode('content');ma&&t.unmountComponentAtNode(ma);}fa.flyoutContentChanged();m.setContent(aa.getNode('numTabs'),ja.length);ga();};function ha(event,ja){if(ja.menu!=ca)return;var ka=n.get(ja.item,'threadID');y.inform('selected',ka);v.hide(ba);}function ia(event,ja){p.register(ca);}p.subscribe('select',ha.bind(this));v.listen('show',ba,function(){h.inform('layer_shown',{type:'ChatTabSelector'});ia();});v.listen('hide',ba,function(){h.inform('layer_hidden',{type:'ChatTabSelector'});});w.subscribe('threads-updated',ga);}Object.assign(y,i);f.exports=y;},null);
__d('ChatTabController',['Arbiter','BanzaiLogger','ChatActivity','ChatConfig','ChatNewMessageHandler','ChatTabActions','ChatTabLRUManager','ChatTabModel','ChatTabPolicy','ChatTabViewEvents','ChatTabViewInstances','ChatTabViewSelector','FBRTCCore','JSLogger','MercuryViewer','Style','UserAgent_DEPRECATED','ChatTabPresence','ChatTypeaheadBehavior','MercuryThreadInformer','MercuryThreadActions','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){if(c.__markCompiled)c.__markCompiled();c('ChatTabPresence');c('ChatTypeaheadBehavior');var y=c('MercuryThreadInformer').get(),z=c('MercuryThreadActions').get(),aa=c('MercuryThreads').get(),ba=k.get('tab_auto_close_timeout')||7200000,ca=u.create('tab_controller');function da(oa,pa,qa){var ra=o.get().tabs,sa=ra[oa],ta,ua;if(ra.length<2)return false;var va=ra.slice(oa+1),wa=ra.slice(0,oa),xa=va.concat(wa);if(!pa)xa.reverse();if(sa)xa.push(sa);for(var ya=0;ya<xa.length;ya++){ta=xa[ya];ua=r.get(ta.id);if(ua&&ua.isVisible()&&(!qa||ta.raised)){ua.focus();return true;}}return false;}function ea(oa,pa){var qa=pa&&pa.getRightmostHiddenTab();if(qa===oa)return null;return qa;}function fa(){return Math.floor(Math.random()*2147483648).toString(16);}function ga(oa,pa,qa,ra){m.raiseTab(oa,true,qa);var sa=pa&&pa.getLeftmostVisibleTab(),ta=pa&&pa.getTabsToShow();if(ta&&!ta[oa]&&sa){o.promoteThreadInPlaceOfThread(oa,sa,ea(oa,pa),true);}else m.promoteTab(oa);h.inform('chat/open-tab',oa);if(ra)return;var ua=r.get(oa);ua&&ua.focus();}function ha(oa,pa){if(!o.getTab(oa))m.raiseTab(oa,false);var qa=pa&&n.getLRUVisibleTab(pa),ra=pa&&pa.getTabsToShow();if(ra&&!ra[oa]&&qa)o.promoteThreadInPlaceOfThread(oa,qa,ea(oa,pa));}function ia(oa){s.subscribe('selected',function(ra,sa){ga(sa,oa);});h.subscribe('page_transition',function(ra,sa){m.closeFragileTabs();});h.subscribe('chat-visibility/go-offline',function(){m.closeAllTabs();});j.subscribe('idle',function(ra,sa){if(sa>ba){var ta=o.get().tabs;ta.forEach(function(ua){var va=ua.id;aa.getThreadMeta(va,function(wa){if(!wa.unread_count){ca.log('autoclose_idle_seen',{thread_id:va,idleness:sa});m.closeTab(va,'autoclose_idle_seen');}});});}});q.subscribe('nub-activated',function(ra,sa){ga(sa,oa);});q.subscribe('focus-tab',function(ra,sa){var ta=o.getTab(sa);if(ta&&ta.raised)ga(sa,oa,ta.signatureID,false);});function pa(ra,sa){i.log('VideoCallLoggerConfig',{event:'chat_tab_call_click'});t.startOutgoingCall(sa.userID,sa.clickSource,sa.audioOnly);}q.subscribe('video-call-clicked',pa);function qa(ra,sa){t.startMultiwayCall(sa.threadID,sa.usersToCall,sa.clickSource,sa.audioOnly);}q.subscribe('group-call-clicked',qa);q.subscribe('interaction-with-tab',function(ra,sa){var ta=o.getTab(sa);ta&&ta.raised&&z.markSeen(sa);});q.subscribe('esc-pressed',function(ra,sa){ca.log('close_esc',{thread_id:sa});var ta=o.indexOf(sa);m.closeTab(sa,'close_esc');setTimeout(function(){da(ta-1,true,true);},0);});y.subscribe('messages-received',function(ra,sa){for(var ta in sa){var ua=sa[ta];for(var va=0;va<ua.length;va++){var wa=ua[va];if(wa.author!=v.getID()){if(!wa.is_unread){ca.log('message_already_read',{action_id:wa.action_id,thread_id:wa.thread_id});continue;}aa.getThreadMeta(ta,function(xa){p.messageIsAllowed(xa,wa,function(){ha(ta,oa);l.newMessage(ta,wa);});});}}}});y.subscribe('thread-read-changed',function(ra,sa){for(var ta in sa)if(!sa[ta].mark_as_read){ca.log('autoclose_marked_unread',{thread_id:ta});m.closeTab(ta,'autoclose_marked_unread');}});q.subscribe('tab-pressed',function(ra,sa){return !da(o.indexOf(sa.id),sa.shiftPressed);});h.subscribe(u.DUMP_EVENT,function(ra,sa){sa.chat_controller={auto_close_timeout:ba};});this.openTab=function(ra,sa,ta,ua){ga(ra,sa,fa(),ua);if(ta)ta(r.get(ra));};}if(x.firefox()){var ja=function(){return w.get(document.body,'overflowX')+' '+w.get(document.body,'overflowY');},ka=ja(),la=function(){var oa=ja();if(oa!==ka){ka=oa;h.inform('overflow-applied-to-body');}};if('MutationObserver' in window){var ma=new MutationObserver(la),na={attributes:true,attributeFilter:['class','style']};ma.observe(document.documentElement,na);}else document.documentElement.addEventListener('DOMAttrModified',function(event){if(event.getTarget()===document.documentElement&&(event.attrName==='class'||event.attrName==='style'))la();},false);}f.exports=ia;},null);
__d('ChatTabViewPlaceholder',['DOM','ErrorUtils','React','ReactDOM','cx'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();function m(n,o,p,q,r,s){this.$ChatTabViewPlaceholder1={threadID:o,serverThreadID:p,signatureID:q,root:r,prevTab:s};this.$ChatTabViewPlaceholder2={visible:true,raised:true};n.then((function(t){try{var v=new t(this.$ChatTabViewPlaceholder1.threadID,this.$ChatTabViewPlaceholder1.serverThreadID,this.$ChatTabViewPlaceholder1.signatureID,this.$ChatTabViewPlaceholder1.root,this);v.setVisibleState(this.$ChatTabViewPlaceholder2.visible,this.$ChatTabViewPlaceholder2.raised);this.destroy();this.$ChatTabViewPlaceholder3=v.getTabElem();if(this.$ChatTabViewPlaceholder4)this.$ChatTabViewPlaceholder4(this.$ChatTabViewPlaceholder1.threadID,v);}catch(u){i.reportError(u,false);}}).bind(this));this.render(this.$ChatTabViewPlaceholder1.root,this.$ChatTabViewPlaceholder1.prevTab);}m.prototype.getTabElem=function(){return this.$ChatTabViewPlaceholder3;};m.prototype.onBeingReplaced=function(n){this.$ChatTabViewPlaceholder4=n;};m.prototype.updateSignatureID=function(n){this.$ChatTabViewPlaceholder1.signatureID=n;};m.prototype.getScrollTop=function(){return 0;};m.prototype.appendTo=function(n){h.appendContent(n,this.$ChatTabViewPlaceholder3);};m.prototype.insertBefore=function(n){h.insertBefore(n.getTabElem(),this.$ChatTabViewPlaceholder3);};m.prototype.isFocused=function(){return false;};m.prototype.hasEmptyInput=function(){return true;};m.prototype.destroy=function(){k.unmountComponentAtNode(this.$ChatTabViewPlaceholder3);h.remove(this.$ChatTabViewPlaceholder3);};m.prototype.nextTabIs=function(n){var o=n&&n.getTabElem();return !!(this.$ChatTabViewPlaceholder3&&this.$ChatTabViewPlaceholder3.nextSibling===o);};m.prototype.setVisibleState=function(n,o){this.$ChatTabViewPlaceholder2={visible:n,raised:!!o};this.render(this.$ChatTabViewPlaceholder1.root,this.$ChatTabViewPlaceholder1.prevTab);};m.prototype.render=function(n,o){var p=!this.$ChatTabViewPlaceholder2.visible,q=this.$ChatTabViewPlaceholder2.raised,r="fbNub"+(' '+"_50-v")+(p?' '+"hidden_elem":'')+(q?' '+"opened":'')+(' '+"placeholder")+(' '+"_50mz");if(!this.$ChatTabViewPlaceholder3){var s=h.create('div',{className:r});this.$ChatTabViewPlaceholder3=s;k.render(j.createElement('div',null,j.createElement('span',{className:"fbNubButton"}),'opened ? (',j.createElement('div',{className:"fbNubFlyout fbDockChatTabFlyout _16bz"},j.createElement('div',{className:"fbNubFlyoutTitlebar"}),j.createElement('div',{className:"fbNubFlyoutBody"})),')'),s);if(o&&o.getTabElem()){this.insertBefore(o);}else this.appendTo(n);}else this.$ChatTabViewPlaceholder3.className=r;};f.exports=m;},null);
__d('ChatTabViewLoader',['Bootloader','ChatTabViewPlaceholder','Promise','Run','requireWeak'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();var m;l('ChatTabView',function(p){return m=p;});var n=new j(function(p){k.onAfterLoad(function(){if(!m){h.loadModules(["ChatTabView"],function(q){m=q;p(q);});}else p(m);});}),o={make:function(p,q,r,s,t){if(m){return new m(p,q,r,s,t);}else return new i(n,p,q,r,s,t);}};f.exports=o;},null);
__d('ChatTabViewCoordinator',['Arbiter','ChatTabModel','ChatTabViewLoader','ChatTabViewSelector','CSS','JSLogger','FBRTCSupport'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=m.create('chat_tab_coordinator');function p(q,r){var s=new k(q),t={},u=false;function v(){var z=i.get(),aa={};z.tabs.forEach(function(ca){aa[ca.id]=1;});o.log('process_tab_changed',{model_tabs:Object.keys(aa),view_tabs:Object.keys(t)});for(var ba in t)if(!aa[ba]){o.log('remove_tab',{tab_id:ba});t[ba].destroy();delete t[ba];}w(z);x(z);if(z.tabNeedsFocus&&!z.tabNeedsFocus.isFocused())z.tabNeedsFocus.focus();}function w(z){var aa=null;z.tabs.forEach(function(ba){var ca=ba.id,da=false;if(!t[ca]){o.log('add_tab',{tab_id:ca});t[ca]=j.make(ca,ba.server_id,ba.signatureID,q,aa);da=true;if(t[ca].onBeingReplaced)t[ca].onBeingReplaced(function(fa,ga){t[fa]=ga;});}else t[ca].updateSignatureID(ba.signatureID);if(t[ca].isFocused())z.tabNeedsFocus=t[ca];if(!da&&!t[ca].nextTabIs(aa)){var ea=t[ca].getScrollTop();if(aa){t[ca].insertBefore(aa);}else t[ca].appendTo(q);if(ea)t[ca].setScrollTop(ea);}aa=t[ca];});}function x(z){var aa=r.getTabsToShow(z),ba=[],ca=false;z.tabs.forEach(function(da){if(!aa[da.id]){t[da.id].setVisibleState(false,da.raised);ba.push(da);}});z.tabs.forEach(function(da){if(aa[da.id]){t[da.id].setVisibleState(true,da.raised);ca|=da.raised;}});s.setTabData(ba);y(ca);}function y(z){if(!z&&u){h.inform('layer_hidden',{type:'ChatTab'});u=false;}else if(z&&!u){h.inform('layer_shown',{type:'ChatTab'});u=true;}}if(n.isSendWebrtcSupported())l.addClass(q,'videoCallEnabled');r.subscribe('tabs-changed',v);v();}f.exports=p;},null);
__d('TabsViewport',['Arbiter','ArbiterMixin','ChatTabModel','Dock','DOM','DOMDimensions','Event','Parent','Vector','ViewportBounds','areJSONRepresentationsEqual','csx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();var t=175,u=269,v=0;function w(){return t;}function x(){return u;}function y(z){this._root=z;var aa=this._recalculateWidth.bind(this);n.listen(window,'resize',aa);k.subscribe('resize',aa);h.subscribeOnce('sidebar/initialized',aa,h.SUBSCRIBE_NEW);j.addListener((function(){return this._recalculateTabs(true);}).bind(this));this._recalculateWidth();this._initialized=true;}Object.assign(y.prototype,i,{_root:null,_initialized:false,_availableWidth:0,_maxShown:1,_viewState:null,_recalculateWidth:function(){var z=y._getAvailableDockWidth(this._root),aa=Math.max(1,Math.floor(z/x())),ba=aa!=this._maxShown;if(!this._viewState||ba||z<=this._viewState.usedWidth||z>this._viewState.widthToShowNext){this._availableWidth=z;this._maxShown=aa;this._viewState=null;this._recalculateTabs(ba);}},_onTabsChanged:function(){if(this._initialized){this.inform('tabs-changed');this.inform('max-to-show-changed',this._maxShown);this.inform('max-to-show-change-completed');}},_recalculateTabs:function(z){var aa=y._getTabsToShow(j.get(),this._availableWidth);if(z||!r(this._viewState,aa)){this._viewState=aa;this._onTabsChanged();}},getMaxTabsToShow:function(){return this._maxShown;},checkWidth:function(){this._recalculateWidth();},hasRoomForRaisedTab:function(){return this._availableWidth-this._viewState.usedWidth>x();},getTabsToShow:function(){return JSON.parse(JSON.stringify(this._viewState.tabsToShow));},getShowingTabsOrder:function(){var z=j.get(),aa=this._viewState.tabsToShow;return z.tabs.filter(function(ba){return aa[ba.id];});},getRightmostHiddenTab:function(){var z=j.get(),aa=this._viewState.tabsToShow,ba=z.tabs.filter(function(da){return !aa[da.id];}),ca=ba.shift();return ca?ca.id:null;},getLeftmostVisibleTab:function(){var z=this.getShowingTabsOrder(),aa=z.pop();return aa?aa.id:null;},getRaisedVisibleTabs:function(){var z=[],aa=this.getShowingTabsOrder(),ba=aa.length;for(var ca=0;ca<ba;ca++)if(j.getTab(aa[ca].id).raised)z.push(aa[ca].id);return z;},shouldPromoteOnRaise:function(z){if(!this._viewState.tabsToShow[z])return true;if(this._viewState.nextToHide!=z)return false;var aa=j.getTab(z),ba=aa&&aa.raised;return !ba&&this._availableWidth-this._viewState.usedWidth<x()-w();}});Object.assign(y,{_getAvailableDockWidth:function(z){var aa=m.getViewportWithoutScrollbarDimensions().width;aa-=q.getLeft()+q.getRight();aa-=50;var ba=o.byClass(z,'fbDock'),ca=l.find(ba,"._56ox"),da=ca?p.getElementDimensions(ca).x:0;aa-=da;var ea=l.scry(ba,"._56oy");da+=p.getElementDimensions(ea.pop()).x;var fa=p.getElementDimensions(ba),ga=fa.x-da;if(ga>v)v=ga;aa-=v;aa-=15;return Math.max(aa,0);},_getTabsToShow:function(z,aa){aa=Math.max(aa,x()+1);function ba(ra,sa){return ra.raised||!sa?x():w();}var ca=JSON.parse(JSON.stringify(z.tabs)),da=-1,ea=null;if(z.promoted)ca.forEach(function(ra,sa){if(ra.id===z.promoted){da=sa;ea=ra;}});var fa=0,ga=false,ha=0,ia=!ea;ca.forEach(function(ra,sa){var ta=ba(ra,ga);ga=ga||!ra.raised;ra.leftmostOffset=fa+ta;fa+=ta;if(ra.leftmostOffset<aa)ha++;ia|=sa==da;ra.alreadyPlacedPromoted=ia;});function ja(ra,sa,ta){var ua={};for(var va=0;va<sa;va++){var wa=ra[va];if(!wa.alreadyPlacedPromoted&&va==sa-1){ua[ta]=true;}else ua[wa.id]=true;}return ua;}var ka=ja(ca,ha,z.promoted),la=ja(ca,ha-1,z.promoted),ma=null;for(var na in ka)if(!la[na])ma=na;var oa=ca[ha-1],pa=oa?oa.leftmostOffset:0,qa=Infinity;if(ha<ca.length)qa=ca[ha].leftmostOffset;return {nextToHide:ma,tabsToShow:ka,usedWidth:pa,widthToShowNext:qa};}});f.exports=y;},null);
__d('MNCommerceDialogContainer.react',['MNCommerceDialogStateStore','PureStoreBasedStateMixin','React'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=j.createClass({displayName:'MNCommerceDialogContainer',mixins:[i(h)],statics:{calculateState:function(){var l=h.getDialogContainer();return {dialogContainer:l};}},render:function(){var l=this.state.dialogContainer;if(!l)return null;return j.createElement(l,null);}});f.exports=k;},null);
__d('P2PDialogStore',['EventEmitter','P2PActionConstants','P2PDispatcher'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k,l;'use strict';var m,n={};k=babelHelpers.inherits(o,h);l=k&&k.prototype;function o(){l.constructor.call(this);m=j.register(this.onEventDispatched.bind(this));n={dialogClass:null,dialogProps:null};}o.prototype.getState=function(){return n;};o.prototype.onEventDispatched=function(p){var q=p.type,r=p.data;switch(q){case i.DIALOG_SHOWN:n.dialogClass=r.dialogClass;n.dialogProps=r.dialogProps;this.emit('change');break;case i.DIALOG_CLOSED:n.dialogClass=null;n.dialogProps=null;this.emit('change');break;}};f.exports=new o();},null);
__d('P2PDialogContainer.react',['P2PDialogStore','React','ReactLayeredComponentMixin'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=i.createClass({displayName:'P2PDialogContainer',mixins:[j],getInitialState:function(){return h.getState();},componentDidMount:function(){this.dialogStoreSub=h.addListener('change',this.onDialogStoreChange);},componentWillUnmount:function(){if(this.dialogStoreSub){this.dialogStoreSub.remove();this.dialogStoreSub=null;}},onDialogStoreChange:function(){this.setState(h.getState());},renderLayers:function(){if(!this.state.dialogClass)return {};var l=this.state.dialogClass;return {dialog:i.createElement(l,this.state.dialogProps)};},render:function(){return null;}});f.exports=k;},null);
__d("FBRTCCallSummaryUploader",["Bootloader"],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={init:function(){h.loadModules(["Banzai","FBRTCCallSummary","FBRTCCallSummaryStore"],function(j,k,l){var m=l.getInstance();j.subscribe(j.SEND,function(){k.logSavedSummaries(m);});});}};f.exports=i;},null);
__d('FBRTCMessageHandler',['Bootloader','FBRTCCallSummaryUploader','FBRTCMessageListener','FBRTCSupport'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=null,m=false,n=null,o={init:function(){if(!m&&k.isReceiveWebrtcSupported()){m=true;i.init();j.init(false);j.once('messageReceived',function(r){p();});j.once('multiwayMessageReceived',function(r){q();});}}};function p(){if(!l)h.loadModules(["FBRTCIncomingCallController","FBRTCIncomingCallDialog","FBRTCMissedVideoCallHandler","FBRTCUnsupportedBrowserMessage"],function(r,s,t,u){l=new r(s,u,new t());j.setMessageHandler(l.onMessageReceived,l);});}function q(){if(!n)h.loadModules(["FBRTCGroupCallIncomingController"],function(r){n=new r();j.setMultiwayMessageHandler(n.onMessageReceived,n);});}f.exports=o;},null);
__d('ChatApp',['CSS','ChatPerfInstrumentation','DOM','JSLogger','Promise','React','ReactDOM','csx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){'use strict';if(c.__markCompiled)c.__markCompiled();var p={init:function(v,w,x){if(this._isInitialized){k.create('chat_app').error('repeated_init');return;}this._rootElem=v;l.resolve().then(function(){return i.init();}).then(function(){return q();}).then(function(){return r(x);}).then(function(){return s(w,v);}).then(function(){return t();}).then((function(){this._isInitialized=this._isLoaded=true;i.logTTI();}).bind(this)).done(function(){return u(x);});},isInitialized:function(){return !!this._isInitialized;},isHidden:function(){return !this._isInitialized||this._isHidden;},hide:function(){if(this.isHidden())return;h.hide(this._rootElem);this._isHidden=true;},unhide:function(){if(this._isInitialized){if(this._isHidden){h.show(this._rootElem);this.tabsViewport.checkWidth();e(['Dock'],function(v){v.resizeAllFlyouts();});this._isHidden=false;}}else if(!this._isLoaded){e(['UIPagelet'],function(v){v.loadFromEndpoint('ChatTabsPagelet','ChatTabsPagelet');v.loadFromEndpoint('BuddylistPagelet','BuddylistPagelet');});this._isLoaded=true;}}};function q(){return new l(function(v){e(['MercuryBlockedParticipants','MercuryChannelHandler','MercuryDelayedRoger','MercuryDeliveryReceipts','MercuryDeliveryState','MercuryParticipants','MercuryStateCheck','MercuryThreads','MercuryUnreadState','MercuryUnseenState','MercurySyncDispatcher'],function(w,x,y,z,aa,ba,ca,da,ea,fa,ga){w.get();x.get().turnOn();y;z.get();aa.get();ba;da.get();fa.get();ea.get();ca.get();ga.get();v();});});}function r(v){return new l(function(w){e(['MercuryServerPayloadPreprocessor'],function(x){x.get().handleUpdate(v);w();});});}function s(v,w){return new l(function(x){e(['ChatTabController','ChatTabViewCoordinator','TabsViewport','MNCommerceDialogContainer.react','P2PDialogContainer.react','FBRTCMessageHandler','ChatOpenTabImpl'],function(y,z,aa,ba,ca,da,ea){p.tabsViewport=new aa(v);p.tabViewCoordinator=new z(v,p.tabsViewport);p.tabController=new y(p.tabsViewport);da.init();var fa=j.find(w,"._26-x");n.render(m.createElement(ba,null),fa);var ga=j.find(w,"._26-y");n.render(m.createElement(ca,null),ga);p.chatOpenTabImpl=ea;x();});});}function t(){return new l(function(v){e(['HotLikeSound','ChatOptions'],function(w,x){w.setCheckSoundEnabledFunc(function(){return x.getSetting('sound');});v();});});}function u(v){if(!v.threads_to_auto_open||!p.tabsViewport.hasRoomForRaisedTab())return;e(['ChatOpenTab'],function(w){w.openThread(v.threads_to_auto_open.thread_fbid,'autoOpenTab','',null,true);});}f.exports=p;},null);
__d('ChatSidebarComposeLink.react',['ChatOpenTab','React','ReactDOM','TooltipLink.react','URI','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=i.PropTypes,o=i.createClass({displayName:'ChatSidebarComposeLink',propTypes:{className:n.string.isRequired},componentDidMount:function(){h.listenOpenEmptyTab(j.findDOMNode(this),'sidebar');},render:function(){var p=m._("Tin nh\u1eafn m\u1edbi");return (i.createElement(k,{ajaxify:new l('/ajax/messaging/composer.php'),className:this.props.className,tooltip:p,rel:'dialog'}));}});f.exports=o;},null);
__d('SidebarFitWindowHeight',['Arbiter','ArbiterMixin','Event','Style','SubscriptionsHandler','UITinyViewportAction','Vector','mixin','queryThenMutateDOM'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q,r;q=babelHelpers.inherits(s,o(i));r=q&&q.prototype;function s(t){'use strict';r.constructor.call(this);this.$SidebarFitWindowHeight1=t;this.onViewportUpdate();m.subscribe('change',this.onViewportUpdate.bind(this));}s.prototype.onViewportUpdate=function(){'use strict';if(m.isTiny()){this.onScroll();var t=this.onScroll.bind(this);this.$SidebarFitWindowHeight2=new l();this.$SidebarFitWindowHeight2.addSubscriptions(j.listen(window,'scroll',t),h.subscribe('dom-scroll',t));}else{if(this.$SidebarFitWindowHeight3!==0){k.set(this.$SidebarFitWindowHeight1,'margin-top','0');this.$SidebarFitWindowHeight3=0;}this.$SidebarFitWindowHeight2&&this.$SidebarFitWindowHeight2.release();}};s.prototype.onScroll=function(){'use strict';p(this.updateScrollPosition.bind(this),this.resizeSidebar.bind(this),'SidebarFitWindowHeight/scroll');};s.prototype.updateScrollPosition=function(){'use strict';this.$SidebarFitWindowHeight4=n.getScrollPosition().y;this.$SidebarFitWindowHeight5||(this.$SidebarFitWindowHeight5=this.$SidebarFitWindowHeight1.offsetHeight);};s.prototype.resizeSidebar=function(){'use strict';var t=-Math.max(Math.min(this.$SidebarFitWindowHeight4,this.$SidebarFitWindowHeight5),0);k.set(this.$SidebarFitWindowHeight1,'margin-top',t+'px');if(t!=this.$SidebarFitWindowHeight3){this.$SidebarFitWindowHeight3=t;this.inform('resized',t);}};s.prototype.getOffset=function(){'use strict';return this.$SidebarFitWindowHeight3;};f.exports=s;},null);
__d('ChatSidebar',['Arbiter','ArbiterMixin','AsyncRequest','BanzaiODS','Bootloader','ChatConfig','ChatImpressionLogger','ChatSidebarActions','ChatSidebarComposeLink.react','ChatSidebarStore','ChatSidebarVisibility','CSS','DOM','DOMDimensions','Event','JSLogger','KeyEventController','LitestandClassicPlaceHolders','MercuryConfig','Parent','PresencePrivacy','PresenceUtil','React','ReactDOM','ReactComponentRenderer','Run','SidebarType','ScrollableArea','SidebarFitWindowHeight','Style','ViewportBounds','createArrayFromMixed','csx','cx','debounce','emptyFunction','ge'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra){if(c.__markCompiled)c.__markCompiled();var sa='chat_sidebar_visibility',ta,ua,va,wa,xa,ya,za,ab,bb,cb,db=null,eb,fb=w.create('chat_sidebar');k.setEntitySample(sa,.0001);function gb(){return q.getVisibleType()===ha.SIDEBAR;}function hb(){return q.getVisibleType()===ha.MINI_SIDEBAR;}function ib(vb,wb){if(!gb())return;if(wb){ab.hide();}else{ab.show();lb();}}function jb(){if(!gb()&&!hb()||!za)return 0;if(db===null){db=za.offsetWidth;if(hb())db=206;}return db;}function kb(){s.removeClass(document.documentElement,'sidebarMode');if(!q.isInitialized()){h.inform('reflow');la.inform('change');return;}db=null;ab.hide();cb.getCore().reset();s.hide(za);s.hide(xa);s.hide(ya);s.removeClass(document.documentElement,'miniSidebar');s.removeClass(za,"_51xq");wa&&wa.setProps({shown:false},function(){return qb(false);});fb.log('minisidebar_hide');h.inform('sidebar/hide',ub);h.inform('reflow');la.inform('change');}function lb(){o.show();if(!q.isInitialized()){tb();o.init();}pb();}function mb(){if(cb&&gb())cb.getCore().getElement().focus();}function nb(vb){var wb=r.getViewport().height;vb.forEach(function(xb){if(xb&&xb!==ta)wb-=u.getElementDimensions(xb).height;});if(eb)wb-=eb.getOffset();if(bb)wb-=u.getElementDimensions(bb).height;return Math.max(0,wb);}function ob(){s.hide(xa);s.show(ya);s.removeClass(document.documentElement,'miniSidebar');s.removeClass(za,"_51xq");wa&&wa.setProps({shown:false},function(){return qb(false);});db=null;s.show(za);s.addClass(document.documentElement,'sidebarMode');ab.show();fb.log('sidebar_show');h.inform('sidebar/show',ub);y.destroy('sidebar');la.inform('change');}function pb(){if(q.getVisibleType()!==ha.SIDEBAR)return;var vb=nb(ma(ya.childNodes)),wb=ab.getItemHeight(),xb=8,yb=Math.floor((vb-xb)/wb);ka.set(ta,'height',vb+'px');ab.setNumTopFriends(yb);if(z.ScrollableSidebarTypeaheadGK){cb.getView().setMaxHeight(vb);}else{var zb=Math.floor((vb-xb)/wb);zb=Math.max(zb-2,1);cb.getData().setMaxResults(zb);}h.inform('sidebar/resized',ub);h.inform('reflow');}function qb(vb){if(za===null)return;s.conditionClass(za,"_2e4g",vb);}function rb(){s.hide(ya);s.show(xa);s.show(za);s.addClass(document.documentElement,'sidebarMode');s.addClass(document.documentElement,'miniSidebar');s.addClass(za,"_51xq");var vb=nb([]);if(!wa){l.loadModules(["ChatMiniSidebar.react","ChatSearchSource"],function(wb,xb){if(!va)va=new xb({queryRequests:[{uri:'/ajax/mercury/composer_query.php'}]});wa=new fa(wb,xa);wa.setProps({dataSource:va,height:vb,maxEntries:50,onClickSearch:qb,onToggleSidebar:o.disable,shown:true});});}else wa.setProps({height:vb,shown:true});y.destroy('sidebar');fb.log('minisidebar_show');h.inform('minisidebar/show',ub);h.inform('reflow');la.inform('change');}function sb(){new j('/ajax/chat/settings.php').setHandler(qa).setErrorHandler(qa).setData({sidebar_mode:q.isEnabled(),window_id:ca.getSessionID()}).setAllowCrossPageTransition(true).send();}function tb(){var vb=true;if(!q.isEnabled()){fb.log('state_not_enabled');vb=false;}if(!r.isViewportCapable())if(!r.isViewportCapableForMiniSidebar()){fb.log('state_not_shown_viewport_mini');vb=false;}if(vb)k.bumpEntityKey(sa,'state_viewport_can_show');if(r.hasLowFriendCount()){fb.log('state_not_shown_num_friends');vb=false;}var wb=vb?'state_shown':'state_not_shown';fb.log(wb);k.bumpEntityKey(sa,wb);}var ub={init:function(vb,wb,xb){ub.init=qa;o.loaded();za=vb;ab=wb;cb=xb;ta=t.find(vb,'div.fbChatSidebarBody');xa=t.find(vb,"._51x-");ya=t.find(vb,"._51x_");bb=t.find(vb,"._5qqe");var yb=t.find(vb,"._x1u");if(yb)ea.render(da.createElement(p,{className:"_3a-4 _5q85"}),yb);if(m.get('sidebar_react_dropdown',false)){var zb=t.find(vb,"._1ltf");if(zb)ga.onAfterLoad(function(){l.loadModules(["ChatSidebarDropdown.react","SidebarType"],function(bc,cc){ea.render(da.createElement(bc,{sidebarType:cc.SIDEBAR,onToggleSidebar:o.disable}),zb);});});}v.listen(window,'resize',lb);x.registerKey('q',function(event){if(q.getVisibleType()!==ha.SIDEBAR)return;if(!ua)ua=t.scry(vb,'.inputsearch')[0];if(ua){ua.focus();event.prevent();}});var ac=t.find(vb,'div.fbChatSidebarMessage div.message');if(ac)ga.onAfterLoad(function(){l.loadModules(["ChatSidebarSheet.react"],function(bc){ea.render(da.createElement(bc,{root:vb,onUpdate:pb}),ac,pb);});});ab.setScrollContainer(aa.byClass(ab.getRoot(),'uiScrollableAreaWrap'));ab.subscribe(['render','show','hide'],pa(function(bc){var cc=ia.getInstance(ab.getRoot());cc&&cc.adjustGripper();}));h.subscribe('chat/option-changed',function(bc,cc){if(cc.name==='hide_groups')pb();});h.subscribe(['AppsDivebar/show-apps','AppsDivebar/hide-apps','Ticker/resized'],pb);xb.getCore().subscribe('sidebar/typeahead/active',ib);xb.subscribe('reset',function(){if(!xb.getCore().getValue()&&!ab.isVisible())ib(null,false);});ba.subscribe('privacy-user-presence-changed',lb);q.addListener(function(){var bc=q.getState(),cc=q.getPrevState();if(bc.visible!==cc.visible)switch(bc.visible){case ha.SIDEBAR:ob();break;case ha.MINI_SIDEBAR:rb();break;case ha.BUDDYLIST:kb();break;}if(bc.enabled!==cc.enabled){if(bc.enabled)setTimeout(mb,0);sb();}});lb();n.init(ab);la.addPersistentRight(jb);ub.inform('sidebar/initialized',ub,h.BEHAVIOR_PERSISTENT);h.inform('sidebar/initialized',ub,h.BEHAVIOR_PERSISTENT);eb=new ja(bb);eb.subscribe('resized',lb);},ensureLoaded:function(){if(!q.isEnabled())return;if(q.isLoaded())return;if(ra('pagelet_sidebar'))return;e(['UIPagelet'],function(vb){var wb=t.create('div',{id:'pagelet_sidebar'});t.appendContent(document.body,wb);vb.loadFromEndpoint('SidebarPagelet','pagelet_sidebar');});o.loaded();},hide:function(){if(!q.isEnabled())return;o.disable();},unhide:function(){if(q.isEnabled())return;o.enable();}};Object.assign(ub,i);f.exports=ub;},null);