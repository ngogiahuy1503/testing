/*!CK:2780130818!*//*1446070280,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["RqIOk"]); }

__d("ChatSidebarSections",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={MORE_ONLINE_FRIENDS:"more_online_friends",MORE_ONLINE_COWORKERS:"more_online_coworkers",OFFLINE_USERS:"offline_users",ORDERED_LIST:"ordered_list",ORDERED_COWORKERS:"ordered_coworkers",TYPEAHEAD:"typeahead",NOW_PINNED_LIST:"now_pinned_list"};},null,{});
__d("P2PPasswordProtectionParam",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={STATUS:"status"};},null,{});
__d("P2PPaymentCampaignNames",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={ZANGOOSE:"zangoose",SEVIPER:"seviper",PICHU:"pichu"};},null,{});
__d("P2PTransferParam",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={TRANSFER_ID:"transfer_id",STATUS:"status",SENDER_STATUS:"sender_status",RECEIVER_STATUS:"receiver_status",RISK_RESULT:"risk_result"};},null,{});
__d('AppsDivebarDisplayController',['AppsDivebarConfigData','AsyncRequest','Arbiter','CSS','UIPagelet','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n='173',o={isVisible:function(){if(typeof this._visible!='undefined')return this._visible;this._visible=!h.hidden;return this._visible;},showApps:function(){this._visible=true;var p={fb_source_category:'sidebar'};l.loadFromEndpoint('GamesDivebarPagelet','pagelet_canvas_nav_content',p);k.show('apps_gripper');k.show('pagelet_canvas_nav_content');k.addClass('pagelet_canvas_nav_content',"_4woj");j.inform('AppsDivebar/show-apps');new i('/ajax/feed/apps/resize').setData({height:''+n,menu:true}).setMethod('POST').send();},hideApps:function(){this._visible=false;k.hide('pagelet_canvas_nav_content');k.hide('apps_gripper');j.inform('AppsDivebar/hide-apps');new i('/ajax/feed/apps/resize').setData({height:'1',menu:true}).setMethod('POST').send();}};f.exports=o;},null);
__d('AsyncLoader',['AsyncRequest','BaseAsyncLoader'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k,l){this._endpoint=k;this._type=l;}Object.assign(j.prototype,i.prototype);j.prototype.send=function(k,l,m,n,o){new h(k).setData({ids:l}).setHandler(n).setErrorHandler(o).setAllowCrossPageTransition(true).setMethod('GET').setReadOnly(true).send();};f.exports=j;},null);
__d('BuddyListNub',['Arbiter','AsyncRequest','AvailableList','BootloadedComponent.react','ChannelConnection','ChannelConstants','ChatConfig','ChatOptions','ChatSidebarActions','ChatSidebarStore','ChatSidebarVisibility','ChatVisibility','CSS','Dock','DOM','Event','JSLogger','JSResource','KeyEventController','Keys','NubController','OrderedFriendsList','Parent','PresencePrivacy','PresenceStatus','PresenceUtil','React','ReactDOM','Run','SidebarType','Style','Toggler','csx','cx','emptyFunction','setTimeoutAcrossTransitions','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra){if(c.__markCompiled)c.__markCompiled();var sa,ta,ua=n.get('divebar_new_design',false),va=ua&&n.get('divebar_persistent',false),wa=ua?40:32,xa=253,ya=x.create('buddylist_nub');sa=babelHelpers.inherits(za,ba);ta=sa&&sa.prototype;function za(ab,bb,cb,db){'use strict';ta.constructor.call(this);ta.init.call(this,ab);this.root=ab;this.orderedList=bb;this.typeahead=cb;this.button=v.find(ab,'a.fbNubButton');this.unreadCount=v.find(ab,"span._5ayx");this.label=v.find(ab,'span.label');this.body=v.scry(ab,'div.fbNubFlyoutBody')[0];this.container=da.byClass(ab,"_56ox");this.typeaheadContainer=v.find(ab,'.fbChatTypeaheadViewContainer');var eb=v.find(ab,'div.fbNubFlyoutTitlebar');ma.createInstance(eb).setSticky(false);if(va)ma.createInstance(ab).setSticky(true);if(db)ja.onAfterLoad((function(){this.dropdown=ia.render(ha.createElement(k,{bootloadPlaceholder:ha.createElement('span',null),bootloadLoader:y('ChatSidebarDropdown.react'),onToggleSidebar:function(){},sidebarType:ka.BUDDYLIST}),db);}).bind(this));if(ua){bb.subscribeOnce('render',this.flyoutContentChanged.bind(this));ja.onAfterLoad((function(){var fb=v.find(eb,"div._4k48");if(fb)ia.render(ha.createElement(k,{bootloadPlaceholder:ha.createElement('span',null),bootloadLoader:y('ChatSidebarComposeLink.react'),className:"_3a-4"}),fb);var gb=v.find(this.button,"div._1us9");if(gb)ia.render(ha.createElement(k,{bootloadPlaceholder:ha.createElement('span',null),bootloadLoader:y('ChatSidebarComposeLink.react'),className:"_3a-4"}),gb);var hb=v.find(this.button,"div._1usa");if(hb)ia.render(ha.createElement(k,{bootloadPlaceholder:ha.createElement('span',null),bootloadLoader:y('ChatSidebarDropdown.react'),onToggleSidebar:function(){},sidebarType:ka.BUDDYLIST_NUB}),hb);}).bind(this));}else bb.subscribe('render',this.flyoutContentChanged.bind(this));bb.setScrollContainer(this.body);j.subscribe('buddylist/availability-changed',this._updateCount.bind(this));h.subscribe('chat/connect',this._handleConnect.bind(this));h.subscribe('chat/option-changed',(function(fb,gb){if(gb.name=='hide_groups'){this.onResize();}else if(gb.name==='hide_buddylist'&&va)gb.value?this.hide():this.show();}).bind(this));ea.subscribe('privacy-user-presence-changed',this._handleVisibilityChange.bind(this));this.message=v.find(ab,"div._4mq1");this.warningMsgText=null;this.warningMsgEventListener=null;this.showWarningTimeout=null;l.subscribe(l.CONNECTED,this._handleChannelConnected.bind(this));l.subscribe(l.SHUTDOWN,this._handleChannelShutdown.bind(this));l.subscribe(l.RECONNECTING,this._handleChannelReconnecting.bind(this));l.subscribe([l.MUTE_WARNING,l.UNMUTE_WARNING],this._updateView.bind(this));this.subscribe('show',this.onShow.bind(this));this.subscribe('hide',this.onHide.bind(this));this.subscribe('resize',this.onResize.bind(this));w.listen(ab,'keydown',this._onKeyDown.bind(this));w.listen(this.button,'click',this.onButtonClick.bind(this));z.registerKey('q',(function(event){if(this._isOpen){cb.getCore().getElement().focus();}else{this.onButtonClick();this.show();}event.prevent();}).bind(this));cb.getCore().subscribe('escape',this.hide.bind(this));cb.subscribe(['respond','reset'],(function(fb,gb){if(this._isOpen){if(gb&&gb.value&&gb.value===cb.getCore().getValue()&&cb.getView().isVisible()){u.setUseMaxHeight(this.root,false);this._hideBuddyList();}else this._showBuddyList();this.flyoutContentChanged();}}).bind(this));h.subscribe('sidebar/show',this.hide.bind(this));h.subscribe('minisidebar/show',this.hide.bind(this));h.subscribe('sidebar/hide',this._onSidebarHide.bind(this));this._orderedListCount=ca.getList().length;if(ua){cb.getCore().subscribe('focus',function(){t.addClass(eb,"_3f5-");});cb.getCore().subscribe('blur',(function(){t.removeClass(eb,"_3f5-");if(va){this._typeaheadActive=false;la.set(this.body,'max-height','285px');la.set(this.body,'height','285px');}}).bind(this));cb.getCore().subscribe('sidebar/typeahead/active',(function(fb,gb){if(va&&gb){this._typeaheadActive=true;la.set(this.body,'max-height','none');la.set(this.body,'height','auto');}else if(va&&!gb){this._typeaheadActive=false;la.set(this.body,'max-height','285px');la.set(this.body,'height','285px');}}).bind(this));}if(va){la.set(this.body,'max-height','285px');if(q.isEnabled()&&q.getVisibleType()===ka.BUDDYLIST&&!o.getSetting('hide_buddylist')&&!l.disconnected()&&!ea.isUserOffline())this.show();w.listen(eb,'click',(function(){this._syncHideBuddylist(true);}).bind(this));}this._handleVisibilityChange();ya.log('buddylist_initialized');}za.prototype._handleConnect=function(ab){'use strict';this._updateView(true);};za.prototype._getShutdownReason=function(ab){'use strict';switch(ab){case m.HINT_AUTH:return ra._("Phi\u00ean c\u1ee7a b\u1ea1n \u0111\u00e3 h\u1ebft h\u1ea1n. Vui l\u00f2ng \u0111\u0103ng nh\u1eadp.");case m.HINT_CONN:return ra._("{Chat} tr\u00ean Facebook hi\u1ec7n kh\u00f4ng kh\u1ea3 d\u1ee5ng.",[ra.param('Chat',ra._("Tr\u00f2 chuy\u1ec7n"))]);case m.HINT_MAINT:return ra._("{Chat} tr\u00ean Facebook \u0111ang ng\u1eebng ho\u1ea1t \u0111\u1ed9ng \u0111\u1ec3 b\u1ea3o tr\u00ec.",[ra.param('Chat',ra._("Tr\u00f2 chuy\u1ec7n"))]);default:return ra._("{Chat} tr\u00ean Facebook hi\u1ec7n kh\u00f4ng kh\u1ea3 d\u1ee5ng.",[ra.param('Chat',ra._("Tr\u00f2 chuy\u1ec7n"))]);}};za.prototype._getReconnectMsg=function(ab){'use strict';var bb;if(ab===null||false===navigator.onLine){bb=ra._("Kh\u00f4ng th\u1ec3 k\u1ebft n\u1ed1i \u0111\u1ec3 tr\u00f2 chuy\u1ec7n. Ki\u1ec3m tra k\u1ebft n\u1ed1i Internet c\u1ee7a b\u1ea1n.");}else if(ab>m.WARNING_COUNTDOWN_THRESHOLD_MSEC){var cb=v.create('a',{href:'#',className:'fbChatReconnectLink'},ra._("Th\u1eed l\u1ea1i")),db=v.create('div',null,cb);bb=v.create('div',{},ra._("Unable to connect to chat."));v.appendContent(bb,db);}else if(ab>1000){bb=ra._("Kh\u00f4ng th\u1ec3 k\u1ebft n\u1ed1i \u0111\u1ec3 tr\u00f2 chuy\u1ec7n. \u0110ang k\u1ebft n\u1ed1i l\u1ea1i trong {seconds}...",[ra.param('seconds',Math.floor(ab/1000))]);}else bb=ra._("Kh\u00f4ng th\u1ec3 k\u1ebft n\u1ed1i \u0111\u1ec3 tr\u00f2 chuy\u1ec7n. \u0110ang k\u1ebft n\u1ed1i l\u1ea1i...");return bb;};za.prototype._resetShowWarningTimeout=function(){'use strict';if(this.showWarningTimeout){clearTimeout(this.showWarningTimeout);this.showWarningTimeout=null;}};za.prototype._handleChannelConnected=function(ab){'use strict';this._resetShowWarningTimeout();if(this.orderedList.isVisible())s.goOnline();this.warningMsgText=null;this._updateView();};za.prototype._handleChannelShutdown=function(ab,bb){'use strict';this._resetShowWarningTimeout();this.warningMsgText=this._getShutdownReason(bb);this._updateView();};za.prototype._handleChannelReconnecting=function(ab,bb){'use strict';this._resetShowWarningTimeout();this.warningMsgText=this._getReconnectMsg(bb);if(bb>1000){if(bb>m.WARNING_COUNTDOWN_THRESHOLD_MSEC){if(this.warningMsgEventListener){this.warningMsgEventListener.remove();this.warningMsgEventListener=null;}this.warningMsgEventListener=w.listen(this.message,'click',(function(event){if(t.hasClass(event.getTarget(),'fbChatReconnectLink')){this._tryReconnect();event.kill();}}).bind(this));}this.showWarningTimeout=qa(this._handleChannelReconnecting.bind(this,ab,bb-1000),1000);}this._updateView();};za.prototype._tryReconnect=function(){'use strict';if(l.disconnected())l.reconnect();};za.prototype._handleVisibilityChange=function(){'use strict';this._updateView();if(!s.isOnline())this.hide();};za.prototype._updateView=function(ab){'use strict';var bb=this.container;if(bb){t.conditionClass(bb,'offline',!s.isOnline());t.conditionClass(bb,'error',l.disconnected());}if(l.disconnected())v.setContent(this.message,this.warningMsgText);var cb,db;if(!s.isOnline()){cb=ra._("{Chat} (T\u1eaft)",[ra.param('Chat',ra._("Tr\u00f2 chuy\u1ec7n"))]);}else if(l.disconnected()){cb=ra._("{Chat} (\u0110\u00e3 ng\u1eaft k\u1ebft n\u1ed1i)",[ra.param('Chat',ra._("Tr\u00f2 chuy\u1ec7n"))]);}else{var eb=fa.getOnlineCount();if(eb){var fb=v.create('span',{className:'count'},'('+eb+')');cb=ra._({"*":"{Chat} {number-available}"},[ra.param('Chat',ra._("Tr\u00f2 chuy\u1ec7n")),ra.param('number-available',fb,[0,eb])]);}else{cb=ra._("Tr\u00f2 chuy\u1ec7n");db=true;}}this._setUnread();this._setLabel(cb,db);this.buttonContentChanged();};za.prototype.onButtonClick=function(){'use strict';if(t.shown(this.typeahead.getElement())){var ab=this.subscribe('show',(function(){this.typeahead.getCore().getElement().focus();}).bind(this));setTimeout(this.unsubscribe.bind(this,ab),0);}if(!q.isLoaded()||!q.isInitialized())return true;var bb=q.isEnabled(),cb=r.shouldShowSidebarIgnoreEnabled(),db=r.shouldShowMiniSidebarIgnoreEnabled();if(!bb&&(cb||db)){p.enable();}else p.show();return !cb&&!db;};za.prototype.onHide=function(){'use strict';this._isOpen=false;if(this._buddyListRenderSubscription){this.orderedList.unsubscribe(this._buddyListRenderSubscription);this._buddyListRenderSubscription=null;}this._hideBuddyList();this.typeahead.getCore().reset();h.inform('buddylist/hide');};za.prototype._onKeyDown=function(event){'use strict';var ab=w.getKeyCode(event);if(ab===aa.ESC&&!t.hasClass(this.root,'menuOpened')){this.hide();return false;}else if(ab==aa.RETURN)p.enable();};za.prototype._onSidebarHide=function(event){'use strict';if(va){if(q.isEnabled()&&!o.getSetting('hide_buddylist')&&!l.disconnected()&&!ea.isUserOffline()){this.show();}else{this.hide();this.button.focus();}}else this.button.focus();};za.prototype.onResize=function(){'use strict';var ab=va&&!this._typeaheadActive?xa:u.getMaxFlyoutHeight(this.root)-60,bb=Math.max(250,ab),cb=Math.floor(bb/wa);this.orderedList.setNumTopFriends(cb);if(ua){var db=this.typeahead.getData(),eb=Math.max(cb-2,1);if(db.getMaxResults()!==eb)db.setMaxResults(eb);}};za.prototype._showBuddyList=function(){'use strict';if(!this._buddyListRenderSubscription&&!ua){this._buddyListRenderSubscription=this.orderedList.subscribe('render',u.setUseMaxHeight.bind(u,this.root,false));}else if(va)this._buddyListRenderSubscription=this.orderedList.subscribe('render',(function(){if(la.get(this.body,'height')!='285px')la.set(this.body,'height','285px');}).bind(this));t.hide(this.typeaheadContainer);this.orderedList.show();ya.bump('buddylist_show');};za.prototype._hideBuddyList=function(){'use strict';t.show(this.typeaheadContainer);this.orderedList.hide();ya.bump('buddylist_hide');};za.prototype.onShow=function(){'use strict';this._isOpen=true;if(l.disconnected()){this._tryReconnect();this._showBuddyList();}else s.goOnline(this._showBuddyList.bind(this));if(va)this._syncHideBuddylist(false);};za.prototype._setLabel=function(ab,bb){'use strict';var cb=this.label.textContent||this.label.innerText;if(cb!==ab){var db=this.label.cloneNode(true);v.setContent(db,ab);v.replace(this.label,db);this.label=db;}this.throbber&&t.conditionShow(this.throbber,!!bb);};za.prototype._setUnread=function(ab){'use strict';t.conditionShow(this.unreadCount,!!ab);};za.prototype._updateCount=function(){'use strict';this._updateView();};za.prototype._syncHideBuddylist=function(ab){'use strict';o.setSetting('hide_buddylist',ab,'buddylist');new i('/ajax/chat/settings.php').setHandler(pa).setErrorHandler(pa).setData({hide_buddylist:ab,window_id:ga.getSessionID()}).setAllowCrossPageTransition(true).send();};f.exports=za;},null);
__d('ChatHovercard',['Arbiter','AsyncLoader','Bootloader','JSLogger','debounce'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=5,n=new i('/ajax/chat/hovercard/sidebar.php','hover'),o=k.create('chat_hovercard');h.subscribe('Hovercard/dirty',n.reset.bind(n));function p(t,u){n.get(t,function(v){setTimeout(function(){if(!v){o.error('fetch_failure',{id:t});return;}j.loadModules(["Hovercard"],function(w){var x=w.getDialog(v);if(!x){o.error('no_hovercard',{id:t,endpoint:v});return;}if(t==u.getActiveID())u.showHovercard(t,x);});},0);});}function q(t,u){var v=[];function w(z){if(z>=0&&z<t.length)v.push(t[z]);}var x=t.indexOf(u);if(x>-1){w(x);for(var y=1;y<m;y++){w(x+y);w(x-y);}}return v.filter(function(z){return z;});}function r(t,u){var v=u.getActiveID();if(v){var w=t.getShowingUsers(),x=q(w,v);n.get(x,function(){});}}function s(t){var u=t.getHoverController();u.registerDefault(p);u.subscribe('hover',l(r.bind(null,t,u),100));}f.exports=s;},null);
__d('ChatOrderedListHover',['ArbiterMixin','CSS','ErrorUtils','Event','LayerHideOnBlur','Parent','cx','mixin','setTimeoutAcrossTransitions','shield'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r,s;function t(w){i.addClass(w,'fetching');}function u(w){i.removeClass(w,'fetching');}r=babelHelpers.inherits(v,o(h));s=r&&r.prototype;function v(w){'use strict';s.constructor.call(this);this._orderedList=w;this._root=w.getRoot();k.listen(this._root,'mouseover',this._mouseOver.bind(this));k.listen(this._root,'mouseleave',this._mouseLeave.bind(this));w.subscribe('click',q(this._hide,this));}v.prototype._mouseOver=function(event){'use strict';if(this._paused)return;var w=event.getTarget(),x=m.byClass(w,"_42fz")||m.byClass(w,"_5a58");x&&this._setActiveItem(x);};v.prototype._mouseLeave=function(event){'use strict';this._setActiveItem(null);};v.prototype._clearTimeouts=function(){'use strict';this._showTimeout&&clearTimeout(this._showTimeout);this._showTimeout=null;this._hideTimeout&&clearTimeout(this._hideTimeout);this._hideTimeout=null;};v.prototype._hide=function(){'use strict';if(this._showingDialog){this._showingDialog.hide();this._showingDialog=null;this._showingID=null;}};v.prototype._show=function(){'use strict';var w=this.getActiveID(),x=false;if(this._defaultHandler){x=true;j.applyWithGuard(this._defaultHandler,{},[w,this]);}if(x&&this._showingID!=this.getActiveID())t(this._activeItem);};v.prototype._setActiveItem=function(w){'use strict';if(w!=this._activeItem){this._clearTimeouts();this._activeItem&&u(this._activeItem);if(w){this._activeItem=w;var x=this._showingDialog?0:600;this._showTimeout=p((function(){return this._show();}).bind(this),x);this.inform('hover');}else{this._activeItem=null;this._hideTimeout=p((function(){return this._hide();}).bind(this),10);this.inform('leave');}}};v.prototype.registerDefault=function(w){'use strict';this._defaultHandler=w;};v.prototype.getActiveID=function(){'use strict';var w=this._activeItem&&this._orderedList.getUserForNode(this._activeItem);return w||null;};v.prototype.showHovercard=function(w,x){'use strict';if(w==this.getActiveID()&&w!=this._showingID){this._clearTimeouts();u(this._activeItem);this._hide();this._showingDialog=x;this._showingID=w;var y=x.subscribe('mouseenter',this._setActiveItem.bind(this,this._activeItem)),z=x.subscribe('mouseleave',(function(){y.unsubscribe();this._setActiveItem(null);}).bind(this)),aa=x.subscribe('hide',(function(){this.inform('hovercard_hide');y.unsubscribe();z.unsubscribe();aa.unsubscribe();}).bind(this));x.enableBehavior(l).setContext(this._activeItem).setPosition('left').show();this.inform('hovercard_show');}};Object.assign(v.prototype,{_root:null,_activeItem:null,_hideTimeout:null,_showTimeout:null,_showingDialog:null,_showingID:null,_defaultHandler:null});f.exports=v;},null);
__d('ChatSidebarConstants',['ChatConfig'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=h.get('divebar_new_design',false),j={LITESTAND_CLASSIC_SIZE:32,IMAGE_SIZE:i?32:28};Object.assign(j,{getImageSize:function(k){if(k===false)return j.IMAGE_SIZE;return j.LITESTAND_CLASSIC_SIZE;},getItemHeight:function(k){if(i)return j.IMAGE_SIZE+8;if(k===false)return j.IMAGE_SIZE+4;return j.LITESTAND_CLASSIC_SIZE+4;}});f.exports=j;},null);
__d('ChatSidebarItem.react',['AvailableListConstants','XUIBadge.react','ChatConfig','ChatSidebarConstants','Image.react','Link.react','ReactComponentWithPureRenderMixin','React','SplitImage.react','TextWithEmoticons.react','Timestamp.react','cx','ix'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u=o.PropTypes,v=j.get('divebar_new_design',false),w=j.get('divebar_rounded_profile',false),x=9,y=o.createClass({displayName:'ChatSidebarItem',mixins:[n],propTypes:{image:u.string,images:u.array,birthday:u.bool,context:u.string,href:u.string,imageSize:u.number,name:u.string,onClick:u.func,status:u.number,statusTime:u.string,unreadCount:u.number,isMessengerOnlyContact:u.bool},render:function(){var z="_55ln"+(this.props.context?' '+"_55lo":'')+(this.props.unreadCount?' '+"_5bom":'')+(v?' '+"_55za":'')+(w?' '+"_qhr":''),aa="_55lr";return (o.createElement(m,{className:z,href:{url:this.props.href},onClick:this.props.onClick,rel:'ignore'},o.createElement('div',{className:"_55lp"},o.createElement('div',{className:"_56p9"},o.createElement(p,{size:this.props.imageSize||k.IMAGE_SIZE,srcs:this.props.image||this.props.images}),o.createElement('div',{className:"_568w"})),o.createElement('div',{className:"_5bon"},this.renderBirthday(),this.renderUnreadCount(),this.renderStatus()),o.createElement('div',{className:aa},o.createElement(q,{renderEmoticons:true,renderEmoji:true,text:this.props.name})),o.createElement('div',{className:"_55ls"},this.props.context))));},renderUnreadCount:function(){var z=this.props.unreadCount;if(!z)return null;return (o.createElement(i,{count:z,maxcount:x,type:'regular'}));},renderStatus:function(){var z=this.getStatusSrc();if(!z&&!this.props.statusTime)return null;var aa=z?o.createElement(l,{className:"_568_",src:z}):null,ba=true,ca=this.props.unreadCount||0;if(ca>0){aa=this.props.statusTime?null:aa;ba=false;}return (o.createElement('div',{className:"_568z"},ba?this.renderLastActiveTime():null,aa));},renderLastActiveTime:function(){return (o.createElement('div',{className:"_568-"},this.props.statusTime));},renderBirthday:function(){if(!this.props.birthday)return null;var z=t('/images/gifts/icons/cake_icon.png');return (o.createElement(l,{className:"_5dv3",src:z}));},getStatusSrc:function(){if(this.props.isMessengerOnlyContact)return v?t('/images/chat/sidebar/buddylist_nub/phone.png'):t('/images/litestand_classic/sidebar/pushable.png');switch(this.props.status){case h.ACTIVE:return v?t('/images/chat/sidebar/buddylist_nub/greenDot.png'):t('/images/litestand_classic/sidebar/online.png');case h.MOBILE:return v?t('/images/chat/sidebar/buddylist_nub/phone.png'):t('/images/litestand_classic/sidebar/pushable.png');}return null;}});f.exports=y;},null);
__d('ChatSidebarThread.react',['ChatSidebarItem.react','ChatOpenTab','WebMessengerPermalinkConstants','React','MercuryThreadMetadataRawRenderer','Tooltip.react','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=k.PropTypes,p=k.createClass({displayName:'ChatSidebarThread',getInitialState:function(){return {maxNumParticipantsToRender:10};},propTypes:{image:o.string,imageSize:o.number,name:o.string,participants:o.array,numOtherParticipants:o.number,referrer:o.string,status:o.number,threadFBID:o.string,unreadCount:o.number},_renderParticipants:function(){var s=[],t=this.props.participants.length,u=this.props.numOtherParticipants,v=Math.min(this.state.maxNumParticipantsToRender,t);if(u-v==1)v--;for(var w=0;w<v;w++){var x=this.props.participants[w];s.push(k.createElement('li',{key:x.id},x.name));}if(v<u)s.push(k.createElement('li',{key:'more-participants'},n._("and {num} more...",[n.param('num',u-v)])));return (k.createElement('ul',null,s));},render:function(){var s=this.props.name,t=q(this.props.threadFBID,this.props.participants,this.props.numOtherParticipants),u=s?t:undefined,v=j.getURIPathForThreadID(this.props.threadFBID),w=r(this.props.image,this.props.participants),x=s?s:t;return (k.createElement(m,{display:'block',position:'above',tooltip:this._renderParticipants()},k.createElement(h,{context:u,href:v,imageSize:this.props.imageSize,image:this.props.image,images:w,name:x,onClick:this._openTab,referrer:this.props.referrer,status:this.props.status,unreadCount:this.props.unreadCount})));},_openTab:function(s){s.preventDefault();i.openThread(this.props.threadFBID,this.props.referrer);}});function q(s,t,u){return l.renderRawParticipantList(s,t,u,{names_renderer:l.renderShortNames});}function r(s,t){if(s)return null;return t.map(function(u){return u.image_src;}).filter(function(u){return u;});}f.exports=p;},null);
__d('ChatSidebarGroupThreadsGroup.react',['ChannelConnection','ChatSidebarThread.react','ChatSidebarSections','ChatSidebarConstants','PresencePrivacy','PresenceStatus','React','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=n.PropTypes,q=n.createClass({displayName:'ChatSidebarGroupThreadsGroup',propTypes:{groups:p.array.isRequired},render:function(){return (n.createElement('ul',null,this.props.groups.map(this._renderGroup)));},_renderGroup:function(r){var s=r.mercury_thread.participants,t=h.disconnected()||l.isUserOffline();return (n.createElement('li',{className:"_42fz"+(t?' '+"_570-":''),'data-id':r.uid,key:r.uid},n.createElement(i,{image:r.mercury_thread.image_src,imageSize:k.getImageSize(),name:r.mercury_thread.name,participants:r.participants_to_render,numOtherParticipants:s.length-1,referrer:j.ORDERED_LIST,status:m.getGroup(s),threadFBID:r.uid})));}});f.exports=q;},null);
__d('ChatSidebarLog',['AsyncSignal','Banzai','BanzaiLogger','Bootloader','ChatPerfEvent','csx','DOM','ErrorUtils','ModuleDependencies','JSLogger','Run','performanceAbsoluteNow'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();var t=q.create('chat_sidebar_load'),u=null,v=null,w=false,x=(Math.random()*2147483648|0).toString(36),y=Date.now(),z=null,aa=false;r.onLoad(function(){w=true;});try{e(['ChatSidebarStore','ChatSidebarVisibility'],function(ha,ia){u=ha;v=ia;});}catch(ba){t.warn('exception',{reason:ba.toString()});}function ca(ha,ia){if(ha&&ha.length>ia)return ha[ia];return null;}function da(ha){if(ha.name=='SyntaxError'||/syntaxerror/i.test(ha.message))aa=true;}function ea(){if(!z)z=j.create(babelHelpers._extends({retry:true},i.VITAL));return z;}function fa(ha,ia){setTimeout(function(){var ja=p.getMissing('ChatSidebar'),ka=k.getErrorUrls(),la=k.getLoadingUrls(),ma=[];for(var na in la)ma.push({url:na,time:la[na]});ma.sort(function(ua,va){return va.time-ua.time;});var oa={};for(var pa=0,qa=ma.length;pa<qa;pa++)oa[ma.url]=ma.time;var ra={start_gap:y-k.getStartTime(),page_loaded:w,page_id:x,timeout:ha,missing_total:ja?ja.length:null,module_1:ca(ja,0),module_2:ca(ja,1),module_3:ca(ja,2),error_url_total:ka.length,error_url_1:ca(ka,0),error_url_2:ca(ka,1),error_url_3:ca(ka,2),loading_url_total:ma.length,loading_url_1:ca(ma,0)?ca(ma,0).url:null,loading_time_1:ca(ma,0)?ca(ma,0).time:null,loading_url_2:ca(ma,1)?ca(ma,1).url:null,loading_time_2:ca(ma,1)?ca(ma,1).time:null,loading_url_3:ca(ma,2)?ca(ma,2).url:null,loading_time_3:ca(ma,2)?ca(ma,2).time:null},sa=null;if(!u){t.warn('require_'+ha,{missing:ja});sa='require';}if(u&&!u.isInitialized()){t.warn('init_'+ha,{missing:ja});sa='init';}if(u&&u.isInitialized()&&u.isEnabled()&&v&&v.shouldShowSidebar()){var ta=n.scry(ia,"._42fz");if(!ta||ta.length===0){t.warn('render_'+ha,{missing:ja});sa='render';}}if(sa){ra.symptom=sa;new h('/ajax/chat/sidebar_load.php',ra).send();ea().log('SidebarLoadFailureLoggerConfig',{start_gap:y-k.getStartTime(),page_loaded:w,page_id:x,timeout:ha,symptom:sa,has_syntax_error:aa});}},ha);}var ga={start:function(ha){this._serverStartTime=s();o.addListener(da);fa(5000,ha);fa(10000,ha);fa(15000,ha);fa(30000,ha);fa(60000,ha);},logRendered:function(){if(this._loggedPerformance)return;var ha=s();if(this._serverStartTime)j.log('ChatPerfLoggerConfig',{event:l.SIDEBAR_FROM_SERVER_TTI,duration:ha-this._serverStartTime});var ia=u&&u.getInitTime();if(ia)j.log('ChatPerfLoggerConfig',{event:l.SIDEBAR_FROM_CLIENT_TTI,duration:ha-ia});this._loggedPerformance=true;}};f.exports=ga;},null);
__d('ChatSidebarUser.react',['ChatOpenTab','ChatSidebarItem.react','WebMessengerPermalinkConstants','ReactComponentWithPureRenderMixin','React'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=l.PropTypes,n=l.createClass({displayName:'ChatSidebarUser',mixins:[k],propTypes:{birthday:m.bool,image:m.string,imageSize:m.number,name:m.string,sectionName:m.string.isRequired,slot:m.number,status:m.number,statusTime:m.string,unreadCount:m.number,userID:m.string.isRequired,isMessengerOnlyContact:m.bool},_openTab:function(event){h.openUserTab(this.props.userID,this.props.sectionName,{global_slot:this.props.slot});return event.preventDefault();},render:function(){var o=j.getURIPathForIDOrVanity(this.props.userID);return (l.createElement(i,{onClick:this._openTab,href:o,imageSize:this.props.imageSize,image:this.props.image,name:this.props.name,status:this.props.status,birthday:this.props.birthday,statusTime:this.props.statusTime,context:this.props.context,unreadCount:this.props.unreadCount,isMessengerOnlyContact:this.props.isMessengerOnlyContact}));}});f.exports=n;},null);
__d('ChatUnreadCount',['ArbiterMixin','ChatConfig','Map','MercuryIDs','MercurySingletonProvider','MercuryThreadInformer','MercuryThreads','MercuryUnreadState','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q,r;q=babelHelpers.inherits(s,p(h));r=q&&q.prototype;s.getForFBID=function(u){'use strict';return t.getForFBID(u);};s.get=function(){'use strict';return t.get();};function s(u){'use strict';r.constructor.call(this);this.$ChatUnreadCount1=u;this.$ChatUnreadCount2=m.getForFBID(u);this.$ChatUnreadCount3=n.getForFBID(u);this.$ChatUnreadCount4=new j();this.$ChatUnreadCount5=o.getForFBID(u);this.setupSubscriptions();}s.prototype.getUnreadCountForUID=function(u){'use strict';if(!i.get('unread_count_enabled')||!u)return null;var v=k.getThreadIDFromUserID(u);if(!this.$ChatUnreadCount5.getIsThreadUnread(v)){this.$ChatUnreadCount4['delete'](u);return 0;}var w=this.$ChatUnreadCount3.getOrFetch(v),x=w&&w.unread_count;this.$ChatUnreadCount4.set(u,x);return x;};s.prototype.setupSubscriptions=function(){'use strict';if(!i.get('unread_count_enabled'))return;this.$ChatUnreadCount2.subscribe('threads-updated',(function(u,v){var w=Object.keys(v).some((function(x){var y=k.getUserIDFromThreadID(x);if(y===null)return false;var z=this.$ChatUnreadCount4.get(y)||0;return this.getUnreadCountForUID(y)!==z;}).bind(this));if(w)this.inform('unread-count-changed');}).bind(this));this.$ChatUnreadCount2.subscribe('unread-updated',(function(){return this.inform('unread-count-changed');}).bind(this));};var t=new l(s);f.exports=s;},null);
__d('ChatSidebarUserGroup.react',['AvailableList','AvailableListConstants','ChannelConnection','ChatContexts','ChatSidebarSections','ChatSidebarUser.react','LastMobileActiveTimes','PresencePrivacy','PresenceStatus','React','ShortProfiles','SubscriptionsHandler','WorkModeConfig','cx','shield','ChatUnreadCount'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=c('ChatUnreadCount').get(),x=q.PropTypes,y=Object.keys(l).map(function(aa){return l[aa];}),z=q.createClass({displayName:'ChatSidebarUserGroup',propTypes:{ids:x.array.isRequired,sectionName:x.oneOf(y).isRequired},getInitialState:function(){return {userData:[]};},_onAvailabilityChanged:function(aa,ba){if(!ba||this.props.ids.indexOf(ba)!==-1)this.forceUpdate();},componentWillMount:function(){this.componentWillReceiveProps(this.props);},componentDidMount:function(){this._subscriptions=new s();this._subscriptions.addSubscriptions(h.subscribe(i.ON_AVAILABILITY_CHANGED,this._onAvailabilityChanged),w.subscribe('unread-count-changed',v(this.forceUpdate,this)));},componentWillUnmount:function(){this._subscriptions.release();},componentWillReceiveProps:function(aa){r.getMulti(aa.ids,(function(ba){var ca=aa.ids.map(function(da){return ba[da];});this.setState({userData:ca});}).bind(this));},_renderProfile:function(aa,ba){var ca=t.is_work_user;if(aa.id===0||!(aa.is_friend||aa.is_nonfriend_messenger_contact||ca))return null;var da=p.get(aa.id),ea=da!==i.ACTIVE?n.getShortDisplay(aa.id):null,fa=j.disconnected()||!o.allows(aa.id),ga=k.getShortDisplay(aa.id);return (q.createElement('li',{className:"_42fz"+(ga?' '+"_52zj":'')+(fa?' '+"_570-":''),'data-id':aa.id,key:aa.id},q.createElement(m,{birthday:aa.is_birthday,context:ga,image:aa.thumbSrc,imageSize:this.props.imageSize,name:aa.name,sectionName:this.props.sectionName,slot:ba,status:da,statusTime:ea,userID:aa.id,unreadCount:w.getUnreadCountForUID(aa.id),isMessengerOnlyContact:aa.is_messenger_only})));},render:function(){return (q.createElement('ul',this.props,this.state.userData.map(this._renderProfile)));}});f.exports=z;},null);
__d('ChatSidebarOrderedList.react',['Animation','BanzaiODS','ChatConfig','ChatQuietLinks','ChatSidebarConstants','ChatSidebarGroupThreadsGroup.react','ChatSidebarLog','ChatSidebarSections','ChatSidebarUserGroup.react','PresencePrivacy','ReactComponentWithPureRenderMixin','React','ReactDOM','Run','Scroll','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){if(c.__markCompiled)c.__markCompiled();var y='chat_sidebar_visibility',z=j.get('divebar_new_design',false),aa=s.PropTypes;i.setEntitySample(y,.0001);var ba=s.createClass({displayName:'ChatSidebarOrderedList',propTypes:{topUsers:aa.array.isRequired,availableUsers:aa.array.isRequired,isSidebar:aa.bool.isRequired,scrollContainer:aa.object,groups:aa.array.isRequired},getInitialState:function(){return {renderBelowFold:false};},componentDidMount:function(){n.logRendered&&n.logRendered();k.nukeLinks(t.findDOMNode(this));this._logFriendCount();u.onAfterLoad((function(){this.setState({renderBelowFold:true});}).bind(this));},_scrollToSeparator:function(da){if(!this.props.scrollContainer)return;var ea=this.props.scrollContainer.scrollHeight,fa=this.props.scrollContainer.clientHeight,ga=v.getTop(this.props.scrollContainer),ha=Math.min(da.offsetTop,ea-fa);if(ga!==ha){var ia=Math.abs(ha-ga)/this.props.scrollContainer.clientHeight*500;new h(this.props.scrollContainer).to('scrollTop',ha).ease(h.ease.end).duration(ia).go();}},_renderOfflineSection:function(){var da=l.getImageSize(this.props.isSidebar),ea=this.props.topUsers.filter(function(ga){return !q.allows(ga);});ea.splice(-2);var fa=s.createElement('a',{ajaxify:'/ajax/chat/privacy/settings_dialog.php?ref=whitelist_separator',href:'#',rel:'dialog'},x._("S\u1eeda"));return [s.createElement('div',{key:'users_separator1',className:"_554m"},s.createElement(ca,null,x._("B\u1ea0N B\u00c8 KH\u00c1C"))),s.createElement('div',{key:'users_separator2',className:"_554m blackbirdWhitelist"},s.createElement('div',{className:"_554o"},s.createElement('div',{className:"_554n"},s.createElement('div',{className:"_5v-d"},s.createElement('span',{className:"_554t"},x._("Nh\u1eefng ng\u01b0\u1eddi b\u1ea1n n\u00e0y kh\u00f4ng th\u1ec3 nh\u00ecn th\u1ea5y b\u1ea1n trong tr\u00f2 chuy\u1ec7n. {=link}",[x.param('=link',fa)])))))),s.createElement(p,{key:o.OFFLINE_USERS,sectionName:o.OFFLINE_USERS,ids:ea,imageSize:da})];},_renderOnlineSection:function(){if(this.props.availableUsers.length===0||!this.state.renderBelowFold)return null;var da=l.getImageSize(this.props.isSidebar),ea=s.createElement(p,{key:o.MORE_ONLINE_FRIENDS,sectionName:o.MORE_ONLINE_FRIENDS,ids:this.props.availableUsers,imageSize:da});return [s.createElement('div',{key:'users_separator',ref:'usersSeparator',onClick:(function(){return (this._scrollToSeparator(t.findDOMNode(this.refs.usersSeparator)));}).bind(this),className:(!z?"_554m":'')+(' '+"moreOnlineFriends")},s.createElement(ca,null,x._("{MORE ONLINE FRIENDS} ({=count})",[x.param('MORE ONLINE FRIENDS',x._("B\u1ea0N B\u00c8 KH\u00c1C")),x.param('=count',this.props.availableUsers.length)]))),ea];},_renderGroupsSection:function(){if(this.props.groups.length===0)return null;return [s.createElement('div',{key:'group_separator',ref:'groupSeparator',onClick:(function(){return (this._scrollToSeparator(t.findDOMNode(this.refs.groupSeparator)));}).bind(this),className:(!z?"_554m":'')+(' '+"moreOnlineFriends")},s.createElement(ca,null,x._("CU\u1ed8C TR\u00d2 CHUY\u1ec6N NH\u00d3M"))),s.createElement(m,{key:'group_threads_section',groups:this.props.groups})];},render:function(){var da=l.getImageSize(this.props.isSidebar),ea=this.props.topUsers;if(q.getVisibility()==q.ONLINE)ea=this.props.topUsers.filter(function(ga){return q.allows(ga);});var fa=q.getOnlinePolicy()==q.ONLINE_TO_WHITELIST&&q.getVisibility()?this._renderOfflineSection():this._renderOnlineSection();return (s.createElement('li',{className:z?"_bxd":null},s.createElement(p,{key:o.ORDERED_LIST,ids:ea,imageSize:da,sectionName:o.ORDERED_LIST}),this._renderGroupsSection(),fa));},_logFriendCount:function(){this._logTimeout=setTimeout((function(){i.bumpEntityKey(y,this.props.availableUsers.length===0?'state_list_empty':'state_list_mounted');}).bind(this),5000);}}),ca=s.createClass({displayName:'ChatSidebarSeparator',mixins:[r],render:function(){var da=z?null:s.createElement('div',{className:"_554q"},s.createElement('span',{className:"_554r"}));return (s.createElement('div',{className:"_554o"},s.createElement('div',{className:"_554n"},s.createElement('span',{className:"_554p"},this.props.children),da)));}});f.exports=ba;},null);
__d('ChatSortUsers',['AvailableListConstants','PresencePrivacy','PresenceStatus','ShortProfiles','TokenizeUtil'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();function m(q,r){var s=i.allows(q),t=i.allows(r);if(s!==t)return s?-1:1;return 0;}var n={};function o(q){if(n[q])return n[q];var r=(k.getNowUnsafe(q)||{}).name;if(r)return n[q]=l.flatten(r);return '~';}var p={sortAlphabetical:function(q,r){var s=o(q),t=o(r);if(s!==t)return s<t?-1:1;return 0;},sortMobile:function(q,r){var s=j.get(q)===h.MOBILE,t=j.get(r)===h.MOBILE;if(s!==t)return t?-1:1;return p.sortAlphabetical(q,r);}};f.exports=p;},null);
__d('PresenceOrderedList',['AvailableListConstants','ChatSortUsers','immutable','InitialChatFriendsList','PresencePrivacy','PresenceStatus'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();function n(){'use strict';this.$PresenceOrderedList1=this.$PresenceOrderedList2();var o=this.$PresenceOrderedList3(this.$PresenceOrderedList1),p=o[0],q=o[1];this.$PresenceOrderedList4=p;this.$PresenceOrderedList5=q;}n.prototype.getSorted=function(o){'use strict';var p=[];this.$PresenceOrderedList1.forEach(function(q){var r=q[0],s=q[1];if(p.length>=o)return false;if(l.getFriendVisibility(r)==l.BLACKLISTED)return true;if(s==m.get(r))p.push(r);});return j.OrderedSet(p);};n.prototype.getNoPresenceSorted=function(){'use strict';return this.$PresenceOrderedList4;};n.prototype.getNoPresenceIndex=function(o){'use strict';return this.$PresenceOrderedList5.get(o);};n.prototype.getAvailableSorted=function(o){'use strict';var p=j.Set(m.getOnlineIDs());if(o)p=p.subtract(o);return p.sort(i.sortMobile);};n.prototype.$PresenceOrderedList2=function(){'use strict';var o=j.List(k.list||[]);return o.map(function(p){var q=p.slice(0,-2),r=Number(p.slice(-1));return [q,r];});};n.prototype.$PresenceOrderedList3=function(){'use strict';var o=[],p={},q=0;this.$PresenceOrderedList1.forEach(function(r){var s=r[0],t=r[1];if(t==h.ACTIVE){o.push(s);p[s]=q++;}});return [j.OrderedSet(o),j.Map(p)];};f.exports=new n();},null);
__d('ChatOrderedList',['Arbiter','ArbiterMixin','AvailableList','AvailableListConstants','CSS','ChatConfig','ChatHovercard','ChatOptions','ChatOrderedListHover','ChatSidebarConstants','ChatSidebarInboxConfig','ChatSidebarOrderedList.react','ChatVisibility','DOM','DataStore','JSLogger','OrderedFriendsList','Parent','PresenceOrderedList','PresencePrivacy','PresenceStatus','React','ReactDOM','createObjectFrom','csx','debounceAcrossTransitions','mixin','shield'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia){if(c.__markCompiled)c.__markCompiled();var ja,ka,la=null;ja=babelHelpers.inherits(ma,ha(i));ka=ja&&ja.prototype;function ma(na,oa){'use strict';ka.constructor.call(this);this._isSidebar=na;this._root=oa;this._isVisible=false;this._excludedIds={};this._numTopFriends=5;this._groups=[];this._hoverController=null;this._orderedList=u.find(this._root,'.fbChatOrderedList');this._scrollableOrderedList=y.byClass(this._root,'scrollableOrderedList');this._scrollableArea=y.byClass(this._root,'scrollable');if(this._isSidebar)new n(this);h.subscribe(w.DUMP_EVENT,(function(pa,qa){qa.chat_lists=qa.chat_lists||{sorted_list:this.getSortedList(),ordered_list:x.getList(),available_list:z.getAvailableSorted(),excluded_list:this._excludedIds};}).bind(this));aa.subscribe('privacy-user-presence-changed',ia(this._render,this));j.subscribe(k.ON_AVAILABILITY_CHANGED,ia(this._render,this));}ma.prototype.getShowingUsers=function(){'use strict';return u.scry(this._root,"li._42fz,li._5a58").map(this.getUserForNode);};ma.prototype.getUserForNode=function(na){'use strict';return v.get(na,'id')||v.get(na,'serverthreadid');};ma.prototype.getHoverController=function(){'use strict';if(!this._hoverController)this._hoverController=new p(this);return this._hoverController;};ma.prototype.getItemHeight=function(){'use strict';return q.getItemHeight(this._isSidebar);};ma.prototype.getRoot=function(){'use strict';return this._root;};ma.prototype.getSortedList=function(){'use strict';return z.getSorted(this._numTopFriends);};ma.prototype.hide=function(){'use strict';if(!this._isVisible)return;this._isVisible=false;l.hide(this._scrollableOrderedList||this._root);this.inform('hide');};ma.prototype.setNumTopFriends=function(na){'use strict';var oa=this._getGroups(),pa=na-oa.length;if(pa>m.get('min_top_friends'))na=pa;na--;if(na!==this._numTopFriends||oa.length!==this._groups.length){this._groups=oa;this._numTopFriends=na;this._render();}};ma.prototype._renderOrderedList=function(){'use strict';if(!this._isVisible)return;var na=this.getSortedList(),oa=z.getAvailableSorted(na),pa=r.component;if(pa){da.render(ca.createElement(pa,{showCount:r.show_count,showPresence:r.show_presence,threadCount:this._numTopFriends}),this._orderedList);}else da.render(ca.createElement(s,{availableUsers:oa.toArray(),isSidebar:this._isSidebar,scrollContainer:this._scrollContainer,topUsers:na.toArray(),groups:this._getGroups()}),this._orderedList);this.inform('render');};ma.prototype._render=function(){'use strict';this._render=ga(this._renderOrderedList.bind(this),300);this._render();};ma.prototype.show=function(){'use strict';if(this._isVisible)return;this._isVisible=true;l.show(this._scrollableOrderedList||this._root);this._render();this.inform('show');};ma.prototype.isVisible=function(){'use strict';return this._isVisible;};ma.prototype.setScrollContainer=function(na){'use strict';if(u.contains(na,this._root))this._scrollContainer=na;};ma.prototype._getGroups=function(){'use strict';if(!o.getSetting('hide_groups')){return x.getGroups();}else return [];};f.exports=ma;},null);
__d('ChatSidebarDropdown',['AppsDivebarDisplayController','Arbiter','AsyncRequest','ChatOptions','ChatSidebarActions','ChatTabActions','ChatVisibility','CSS','FBRTCCallBlockingStore','JSLogger','PresenceState','cx','ge'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();function u(v,w,x,y,z){'use strict';this._menu=w;this._popover=v.getPopover();this._selectedValues={};this._menuIsRendered=false;this._editingFavoriteList=false;this._hasAppsOption=z;this._logger=q.create('blackbird');this._menu.subscribe('itemclick',this._onClick.bind(this));this._popover.subscribe('init',this._onLayerInit.bind(this));this._popover.subscribe('show',this._updateTickerVisibility.bind(this));i.subscribe('chat/option-changed',this._onOptionChanged.bind(this));}u.prototype._onLayerInit=function(){'use strict';this._menuIsRendered=true;o.addClass(this._popover.getLayer().getContentRoot(),"_5vm9");this._displayBrowserNotificationsIfNeeded();this._updateVisibility();this._updateVideoCallVisibility();i.subscribe('chat-visibility/go-online',this._updateVisibility.bind(this));i.subscribe('chat-visibility/go-offline',this._updateVisibility.bind(this));p.addListener(this._updateVideoCallVisibility.bind(this));this._updateSelectedItems();if(this._editingFavoriteList)this._updateEditFavoriteListLabel(this._editingFavoriteList);if(this._hasAppsOption)this._registerAppHandlers();};u.prototype._updateSelectedItems=function(){'use strict';this._menu.forEachItem((function(v){var w=v.getValue&&v.getValue();if(w in this._selectedValues){var x=this._selectedValues[w];if(x){v.select();}else v.deselect();}}).bind(this));};u.prototype._registerAppHandlers=function(){'use strict';this._updateAppsVisibility();i.subscribe('AppsDivebar/hide-apps',this._updateAppsVisibility.bind(this));i.subscribe('AppsDivebar/show-apps',this._updateAppsVisibility.bind(this));};u.prototype._updateTickerVisibility=function(){'use strict';var v=t('pagelet_ticker');o.conditionClass(this._popover.getLayer().getContentRoot(),"_2rox",!v||v.offsetHeight===0);};u.prototype._updateAppsVisibility=function(){'use strict';o.conditionClass(this._popover.getLayer().getContentRoot(),"_2vh",!h.isVisible());};u.prototype._updateVisibility=function(){'use strict';o.conditionClass(this._popover.getLayer().getContentRoot(),"_5vma",!n.isOnline());};u.prototype._updateVideoCallVisibility=function(){'use strict';o.conditionClass(this._popover.getLayer().getContentRoot(),"_2jvw",p.getBlockingStatus());};u.prototype._displayBrowserNotificationsIfNeeded=function(){'use strict';if(window.webkitNotifications){var v;this._menu.forEachItem(function(w){if(w.getValue&&w.getValue()==='browser_notif')v=w;});if(v){o.show(v.getRoot());if(window.webkitNotifications.checkPermission()!==0)v.deselect();}}};u.prototype._onChangeSettingResponse=function(v,w,x){'use strict';r.doSync();};u.prototype._onChangeSettingError=function(v,w,x){'use strict';k.setSetting(v,!w,'sidebar_menu_error');};u.prototype._onChangeFinally=function(){'use strict';this._pendingChange=false;};u.prototype._onOptionChanged=function(v,w){'use strict';var x=w.name,y=w.value;if(this._menuIsRendered){this._menu.forEachItem(function(z){if(z.getValue&&z.getValue()===x)if(z.isSelected()&&!y){z.deselect();}else if(!z.isSelected()&&y)z.select();});}else this._selectedValues[x]=y;};u.prototype._onClick=function(v,w){'use strict';if(this._pendingChange)return false;var x=false,y=w.item.getValue(),z=true;switch(y){case 'sidebar':this.toggleSidebar();break;case 'online':if(!n.isOnline()){n.goOnline();}else this._logVisibilityChange(y,true);x=true;break;case 'offline':if(n.isOnline()){n.goOffline();}else this._logVisibilityChange(y,true);x=true;break;case 'videoon':p.turnOnVideoCalling();x=true;break;case 'videooff':x=true;break;case 'advanced_settings':case 'turn_off_dialog':i.inform('chat/advanced-settings-dialog-opened');x=true;this._logVisibilityChange(y,false);break;case 'browser_notif':if(!w.item.isSelected()&&window.webkitNotifications&&window.webkitNotifications.checkPermission()!==0){window.webkitNotifications.requestPermission((function(){this.changeSetting(y,!w.item.isSelected());}).bind(this));}else this.changeSetting(y,!w.item.isSelected());x=true;break;case 'sound':this.changeSetting(y,!w.item.isSelected());x=true;break;case 'close_all_tabs':m.closeAllTabs();this._logVisibilityChange(y,false);x=true;break;case 'show_apps':if(!h.isVisible())h.showApps();x=true;break;case 'hide_apps':if(h.isVisible())h.hideApps();x=true;break;case 'show_ticker':i.inform('ChatSidebarDropdown/openTicker');x=true;break;case 'hide_ticker':i.inform('ChatSidebarDropdown/closeTicker');x=true;break;case 'hide_groups':var aa=w.item.isSelected();this.changeSetting('hide_groups',!aa);x=true;break;}if(x){this.hideMenu();return z;}};u.prototype._logVisibilityChange=function(v,w){'use strict';this._logger.error(w?'sidebar_dropdown_visibility_error':'sidebar_dropdown_set_visibility',{action:v});};u.prototype.changeSetting=function(v,w){'use strict';if(this._pendingChange)return false;this._pendingChange=true;var x={};x[v]=w;k.setSetting(v,w,'sidebar_menu');new j('/ajax/chat/settings.php').setHandler(this._onChangeSettingResponse.bind(this,v,w)).setErrorHandler(this._onChangeSettingError.bind(this,v,w)).setFinallyHandler(this._onChangeFinally.bind(this)).setData(x).setAllowCrossPageTransition(true).send();};u.prototype.hideMenu=function(){'use strict';if(this._menuIsRendered)this._popover.hideLayer();};u.prototype.toggleSidebar=function(){'use strict';l.toggle();this.hideMenu();return false;};f.exports=u;},null);
__d('ChatSidebarTypeaheadDataSource',['MercuryConfig','MercuryTypeaheadDataSource','Run','ShortProfiles'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l,m;l=babelHelpers.inherits(n,i);m=l&&l.prototype;function n(o){'use strict';o=o||{};o.kanaNormalization=true;if(h.ScrollableSidebarTypeaheadGK)o.maxResults=30;m.constructor.call(this,o);if(h.LinkedAgents&&h.LinkedAgents.length>0)j.onAfterLoad((function(){return this.bootstrap();}).bind(this));}n.prototype.init=function(){'use strict';m.init.call(this);this.updateBootstrapData();};n.prototype.bootstrap=function(){'use strict';m.bootstrap.call(this);};n.prototype.updateBootstrapData=function(){'use strict';if(this.isBootstrapped())return;m.updateBootstrapData.call(this);};n.prototype.fetchAll=function(){'use strict';k.fetchAll();};n.prototype.refreshData=function(){'use strict';this.fetchAll();e(['AvailableList'],(function(o){o.update();}).bind(this));};n.prototype.query=function(o,p,q,r){'use strict';this.logQuery({event:'query_dive_bar',query:o});return m.query.call(this,o,p,q,r);};n.prototype.respond=function(o,p,q){'use strict';var r=m.respond.call(this,o,p,q);this.logResponse({event:'query_response_dive_bar',response_query:o,response_uids:p});return r;};f.exports=n;},null);
__d('ChatTypeaheadCore',['Event','Keys','TypeaheadCore','emptyFunction','shield'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n;m=babelHelpers.inherits(o,j);n=m&&m.prototype;o.prototype.init=function(p,q,r){'use strict';n.init.call(this,p,q,r);this.informBeginActive=false;this.informEndActive=false;this.data.subscribe('respond',(function(){if(this.informBeginActive){this.informBeginActive=false;this.inform('sidebar/typeahead/active',true);}else if(this.informEndActive){this.informEndActive=false;this.inform('sidebar/typeahead/active',false);}}).bind(this));};o.prototype.keydown=function(event){'use strict';this.data.fetchAll();var p=h.getKeyCode(event);if(p===i.ESC){this.view.clearContent();setTimeout(l(this.reset,this),0);if(!this.getValue()){this.element.blur();this.inform('escape');}return event.kill();}return n.keydown.call(this,event);};o.prototype.checkValue=function(){'use strict';var p=this.getValue(),q=this.value;if(p==q)return;if(q&&!p){this.typeaheadActive=false;this.informEndActive=true;}else if(!q&&p){this.typeaheadActive=true;this.informBeginActive=true;this.inform('sidebar/typeahead/preActive');}n.checkValue.call(this);};function o(){'use strict';m.apply(this,arguments);}Object.assign(o.prototype,{handleTab:k});f.exports=o;},null);
__d('ChatTypeaheadRenderer',['AvailableListConstants','ChatConfig','ChatSidebarConstants','ChatSidebarHeader.react','ChatSidebarSections','ChatSidebarThread.react','ChatSidebarUser.react','ChatTypeaheadConstants','DOM','LastMobileActiveTimes','MercuryIDs','PresenceStatus','React','ReactDOM','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w={};function x(ca,da){if(!(ca in w))w[ca]=p.create('li');u.render(da,w[ca]);return w[ca];}function y(ca){return x(ca.text,t.createElement(k,{className:i.get('divebar_new_design',false)?"_4ebb":''},ca.text));}function z(ca){var da=ca.mercury_thread.participants.map(function(ea){return r.getUserIDFromParticipantID(ea);});return x(ca.uid,t.createElement(m,{image:ca.mercury_thread.image_src,imageSize:j.getImageSize(),name:ca.mercury_thread.name,participants:ca.participants_to_render,numOtherParticipants:da.length-1,referrer:l.TYPEAHEAD,status:s.getGroup(da),threadFBID:ca.uid}));}function aa(ca){var da=s.get(ca.uid),ea=da===h.MOBILE?q.getShortDisplay(ca.uid):null,fa=ca.render_type==o.NON_FRIEND_TYPE||ca.render_type==o.PAGE_TYPE||ca.render_type==o.FB4C_TYPE?ca.subtext:null;return x(ca.uid,t.createElement(n,{image:ca.photo,imageSize:j.getImageSize(),name:ca.text,sectionName:l.TYPEAHEAD,status:da,statusTime:ea,userID:ca.uid,context:fa}));}function ba(ca,da){if(ca.type===o.HEADER_TYPE)return y(ca);if(ca.type==o.THREAD_TYPE)return z(ca);return aa(ca);}f.exports=ba;},null);
__d('ChatTypeaheadView',['BucketedTypeaheadView','ChatTypeaheadConstants','CurrentUser','DOM','MercuryConfig','React','ReactDOM','ScrollableArea','MercuryThreadSearchUtils','Style','WorkModeConfig','XUISpinner.react','arrayContains','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w,x;w=babelHelpers.inherits(y,h);x=w&&w.prototype;function y(z,aa){'use strict';if(l.ScrollableSidebarTypeaheadGK){var ba=o.renderDOM();k.appendContent(z,ba.root);var ca=o.fromNative(ba.root);x.constructor.call(this,ba.content,aa);this.$ChatTypeaheadView1=ba;this.$ChatTypeaheadView2=ca;}else x.constructor.call(this,z,aa);this.showingLoadingIndicator=false;this.typeObjects={};this.typeObjectsOrder=[];this.typeObjects[i.NON_FRIEND_TYPE]={uid:i.NON_FRIEND_TYPE,type:i.HEADER_TYPE,text:v._("NG\u01af\u1edcI KH\u00c1C")};this.typeObjects[i.PAGE_TYPE]={disabled:true,uid:i.PAGE_TYPE,type:i.HEADER_TYPE,text:v._("Doanh nghi\u1ec7p")};this.typeObjects[i.THREAD_TYPE]={uid:i.THREAD_TYPE,type:i.HEADER_TYPE,text:v._("CU\u1ed8C TR\u00d2 CHUY\u1ec6N NH\u00d3M")};this.typeObjects[i.FB4C_TYPE]={uid:i.FB4C_TYPE,type:i.HEADER_TYPE,text:v._("B\u1ea1n \u0111\u1ed3ng nghi\u1ec7p")};this.typeObjects[i.FRIEND_TYPE]={disabled:true,uid:i.FRIEND_TYPE,type:i.HEADER_TYPE,text:v._("B\u1ea0N B\u00c8")};this.$ChatTypeaheadView3();}y.prototype.reset=function(){'use strict';if(this.value==='')this.clearContent();this.index=-1;this.items=[];this.results=[];this.value='';this.inform('reset');return this;};y.prototype.clearContent=function(){'use strict';this.hideLoadingIndicator();k.empty(this.content);};y.prototype.buildBuckets=function(z,aa){'use strict';var ba=aa.filter(function(ca){var da=ca.render_type||ca.type;if(da==='thread'){var ea='fbid:'+j.getID();if(!t(ca.mercury_thread.participants,ea))return false;var fa=ca.participants_to_render.some(function(ha){return p.queryMatchesName(z,ha.name);}),ga=p.queryMatchesName(z,ca.mercury_thread.name);if(!fa&&!ga)return false;}return true;}).reverse();this.$ChatTypeaheadView3(z);return x.buildBuckets.call(this,z,ba);};y.prototype.getDefaultIndex=function(z){'use strict';if(z.length===0)return -1;var aa=z.length-1;while(!this.isHighlightable(z[aa])&&aa>=0)aa--;return aa;};y.prototype.showLoadingIndicator=function(){'use strict';if(!this.showingLoadingIndicator){n.render(m.createElement('div',{className:'spinnerContainer'},m.createElement(s,{className:"_3-8i",background:'light',size:'small',paused:false})),this.content);this.showingLoadingIndicator=true;}};y.prototype.hideLoadingIndicator=function(){'use strict';if(this.showingLoadingIndicator){n.unmountComponentAtNode(this.content);this.showingLoadingIndicator=false;}};y.prototype.showNoResults=function(){'use strict';var z=v._("Kh\u00f4ng t\u00ecm th\u1ea5y ng\u01b0\u1eddi b\u1ea1n");if(r.is_work_user)z=v._("Kh\u00f4ng t\u00ecm th\u1ea5y \u0111\u1ed3ng nghi\u1ec7p.");this.hideLoadingIndicator();k.setContent(this.content,k.create('div',{className:"noResults _3-9a"},z));};y.prototype.hide=function(){'use strict';this.clearContent();return x.hide.call(this);};y.prototype.next=function(){'use strict';x.next.call(this);if(l.ScrollableSidebarTypeaheadGK)this.$ChatTypeaheadView2.scrollIntoView(this.selected,false);};y.prototype.prev=function(){'use strict';x.prev.call(this);if(l.ScrollableSidebarTypeaheadGK)this.$ChatTypeaheadView2.scrollIntoView(this.selected,false);};y.prototype.setMaxHeight=function(z){'use strict';q.set(this.$ChatTypeaheadView1.wrap,'max-height',z+'px');};y.prototype.render=function(z,aa,ba){'use strict';if(l.ScrollableSidebarTypeaheadGK)var ca=this.value!==z||this.$ChatTypeaheadView2.isScrolledToBottom();if(!aa.length){if(z&&z.length>1)this.showLoadingIndicator();}else this.hideLoadingIndicator();x.render.call(this,z,aa,ba);if(l.ScrollableSidebarTypeaheadGK&&ca)this.$ChatTypeaheadView2.scrollToBottom(false);};y.prototype.$ChatTypeaheadView3=function(z){'use strict';if(l.WWWMessengerMoneyPennyGK&&z&&l.HoistAgentsKeywords&&l.HoistAgentsKeywords.indexOf(z.toLowerCase())!==-1){this.typeObjectsOrder=[i.NON_FRIEND_TYPE,i.THREAD_TYPE,i.FB4C_TYPE,i.FRIEND_TYPE,i.PAGE_TYPE];}else this.typeObjectsOrder=[i.NON_FRIEND_TYPE,i.PAGE_TYPE,i.THREAD_TYPE,i.FB4C_TYPE,i.FRIEND_TYPE];};f.exports=y;},null);
__d('legacy:ChatTypeaheadBehavior',['ChatTypeaheadBehavior'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();if(!b.TypeaheadBehaviors)b.TypeaheadBehaviors={};b.TypeaheadBehaviors.chatTypeahead=function(i){i.enableBehavior(h);};},3);
__d("XGamesGripperNoteUpdaterController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/async\/games\/gripper_note_viewed\/",{});},null,{});
__d('SidebarAppTickerResizer',['Animation','Arbiter','AsyncRequest','ChatSidebarActions','ChatSidebarStore','CSS','cx','debounce','DOMQuery','Event','SidebarType','SimpleDrag','TickerController','$','queryThenMutateDOM','XGamesGripperNoteUpdaterController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=1e-07,x=1,y=85,z=173,aa=300,ba=46,ca=90,da=82,ea=150;function fa(ga,ha,ia,ja,ka){'use strict';this.$SidebarAppTickerResizer1=u('pagelet_ticker');this.$SidebarAppTickerResizer2=u('pagelet_canvas_nav_content');this.$SidebarAppTickerResizer3=this.$SidebarAppTickerResizer1.parentNode;this.$SidebarAppTickerResizer4=ka;this.$SidebarAppTickerResizer2.style.height=ia;this.$SidebarAppTickerResizer5(ga,ha);if(ia===null)if(ja!==null){this.$SidebarAppTickerResizer6();this.$SidebarAppTickerResizer7(this.$SidebarAppTickerResizer8());}else i.subscribe('AppsDivebar/show-apps',this.$SidebarAppTickerResizer6.bind(this));if(!ka){this.$SidebarAppTickerResizer9();m.hide(ga);}i.subscribe('ChatSidebarDropdown/closeTicker',this.$SidebarAppTickerResizer9.bind(this));i.subscribe('ChatSidebarDropdown/openTicker',this.$SidebarAppTickerResizer10.bind(this));i.subscribe('sidebar/show',this.$SidebarAppTickerResizer11.bind(this));if(ja){var la=p.scry(document.body,'#pagelet_ticker')[0],ma=la&&la.parentNode,na,oa=function(){ja.hide();if(na)na.unsubscribe();},pa=function(){if(!m.shown(ma))return;var qa=c('XGamesGripperNoteUpdaterController').getURIBuilder().getURI();new j().setURI(qa).send();ja.show();if(na)na.unsubscribe();na=i.subscribe('sidebar/hide',oa);};if(ma&&m.shown(ma)){pa();}else na=i.subscribe('ticker/show',pa);}this.$SidebarAppTickerResizer12=o(this.$SidebarAppTickerResizer6.bind(this),200);q.listen(window,'resize',this.$SidebarAppTickerResizer12);i.inform('Ticker/resized');}fa.prototype.$SidebarAppTickerResizer11=function(){'use strict';t.show(this.$SidebarAppTickerResizer1);};fa.prototype.$SidebarAppTickerResizer6=function(ga){'use strict';v((function(){this.$SidebarAppTickerResizer13();}).bind(this),(function(){var ha=Math.round(parseFloat(this.$SidebarAppTickerResizer1.style.height));if(ha>Math.round(this.$SidebarAppTickerResizer14())||this.$SidebarAppTickerResizer15&&this.$SidebarAppTickerResizer15>x){var ia=this.$SidebarAppTickerResizer15/this.$SidebarAppTickerResizer16*100,ja=this.$SidebarAppTickerResizer17(0,this.$SidebarAppTickerResizer14()-ia);if(!(ga&&ga.type==='resize'))this.$SidebarAppTickerResizer18(ja);k.show();}}).bind(this));};fa.prototype.$SidebarAppTickerResizer14=function(){'use strict';if(!this.$SidebarAppTickerResizer4)return 0;if(l.getVisibleType()!==r.SIDEBAR)return ca;return Math.min(ca,(this.$SidebarAppTickerResizer16-this.$SidebarAppTickerResizer19-da)*100/this.$SidebarAppTickerResizer16);};fa.prototype.$SidebarAppTickerResizer5=function(ga,ha){'use strict';var ia=new s(ga);ia.subscribe('start',this.$SidebarAppTickerResizer20.bind(this));ia.subscribe(['update','end'],this.$SidebarAppTickerResizer21.bind(this));var ja=new s(ha);ja.subscribe('start',this.$SidebarAppTickerResizer20.bind(this));ja.subscribe('update',this.$SidebarAppTickerResizer22.bind(this));ja.subscribe('end',this.$SidebarAppTickerResizer23.bind(this));};fa.prototype.$SidebarAppTickerResizer20=function(ga,event){'use strict';this.$SidebarAppTickerResizer24=event.clientY;this.$SidebarAppTickerResizer13();this.$SidebarAppTickerResizer25();};fa.prototype.$SidebarAppTickerResizer13=function(){'use strict';this.$SidebarAppTickerResizer19=this.$SidebarAppTickerResizer2.offsetTop;this.$SidebarAppTickerResizer26=this.$SidebarAppTickerResizer1.offsetHeight;this.$SidebarAppTickerResizer16=this.$SidebarAppTickerResizer3.offsetHeight;this.$SidebarAppTickerResizer15=this.$SidebarAppTickerResizer2.offsetHeight;this.$SidebarAppTickerResizer27=this.$SidebarAppTickerResizer15;};fa.prototype.$SidebarAppTickerResizer25=function(){'use strict';m.addClass(this.$SidebarAppTickerResizer3,"_4vfq");};fa.prototype.$SidebarAppTickerResizer28=function(){'use strict';m.removeClass(this.$SidebarAppTickerResizer3,"_4vfq");};fa.prototype.$SidebarAppTickerResizer21=function(ga,event){'use strict';var ha=this.$SidebarAppTickerResizer15/this.$SidebarAppTickerResizer16*100,ia=this.$SidebarAppTickerResizer17(event.clientY-this.$SidebarAppTickerResizer24,this.$SidebarAppTickerResizer14()-ha);if(ga=='end'){this.$SidebarAppTickerResizer28();this.$SidebarAppTickerResizer18(ia);}k.show();};fa.prototype.$SidebarAppTickerResizer22=function(ga,event){'use strict';var ha=-this.$SidebarAppTickerResizer15,ia=this.$SidebarAppTickerResizer8()-this.$SidebarAppTickerResizer15,ja=this.$SidebarAppTickerResizer29(event.clientY-this.$SidebarAppTickerResizer24,ha,ia);this.$SidebarAppTickerResizer17(-ja,this.$SidebarAppTickerResizer14());this.$SidebarAppTickerResizer27=this.$SidebarAppTickerResizer15+ja;this.$SidebarAppTickerResizer27=Math.max(x,this.$SidebarAppTickerResizer27);this.$SidebarAppTickerResizer2.style.height=this.$SidebarAppTickerResizer27+'px';};fa.prototype.$SidebarAppTickerResizer23=function(ga,event){'use strict';var ha=this.$SidebarAppTickerResizer27,ia=this.$SidebarAppTickerResizer30(this.$SidebarAppTickerResizer27),ja=this.$SidebarAppTickerResizer17(this.$SidebarAppTickerResizer15-ia,this.$SidebarAppTickerResizer14());if(this.$SidebarAppTickerResizer15!=ia){this.$SidebarAppTickerResizer7(ia);this.$SidebarAppTickerResizer18(ja);}new h(this.$SidebarAppTickerResizer2).from('height',ha).to('height',ia).duration(aa).go();};fa.prototype.$SidebarAppTickerResizer17=function(ga,ha){'use strict';var ia=this.$SidebarAppTickerResizer26+ga,ja=ia/this.$SidebarAppTickerResizer16*100;ja=Math.max(w,Math.min(ha,ja));this.$SidebarAppTickerResizer1.style.height=ja+'%';if(ja!=w){m.removeClass(this.$SidebarAppTickerResizer1,'hidden_elem');this.$SidebarAppTickerResizer11();}return ja;};fa.prototype.$SidebarAppTickerResizer30=function(ga){'use strict';var ha=this.$SidebarAppTickerResizer31(),ia=this.$SidebarAppTickerResizer8();return ga<ia-ba?ga<ha-ba?x:ha:ia;};fa.prototype.$SidebarAppTickerResizer31=function(){'use strict';return y;};fa.prototype.$SidebarAppTickerResizer8=function(){'use strict';return z;};fa.prototype.$SidebarAppTickerResizer32=function(ga){'use strict';var ha=this.$SidebarAppTickerResizer8();return ga<0?x:ga>ha?ha:ga;};fa.prototype.$SidebarAppTickerResizer29=function(ga,ha,ia){'use strict';return ga<ha?ha:ga>ia?ia:ga;};fa.prototype.$SidebarAppTickerResizer18=function(ga){'use strict';new j('/ajax/feed/ticker/resize').setData({height:''+ga}).setMethod('POST').send();i.inform('Ticker/resized');};fa.prototype.$SidebarAppTickerResizer7=function(ga){'use strict';new j('/ajax/feed/apps/resize').setData({height:''+ga}).setMethod('POST').send();};fa.prototype.$SidebarAppTickerResizer33=function(ga){'use strict';var ha=this.$SidebarAppTickerResizer26,ia=this.$SidebarAppTickerResizer16*ga/100;new h(this.$SidebarAppTickerResizer1).from('height',ha).to('height',ia).duration(ea).ondone((function(){this.$SidebarAppTickerResizer1.style.height=ga+'%';this.$SidebarAppTickerResizer18(ga===0?'0.0':ga);k.show();}).bind(this)).go();};fa.prototype.$SidebarAppTickerResizer9=function(){'use strict';this.$SidebarAppTickerResizer13();this.$SidebarAppTickerResizer33(0);};fa.prototype.$SidebarAppTickerResizer10=function(){'use strict';this.$SidebarAppTickerResizer1.style.height='40px';t.show(this.$SidebarAppTickerResizer1,(function(){this.$SidebarAppTickerResizer13();var ga=(this.$SidebarAppTickerResizer16-this.$SidebarAppTickerResizer19-da-this.$SidebarAppTickerResizer15)*50/this.$SidebarAppTickerResizer16;this.$SidebarAppTickerResizer33(ga);}).bind(this));};f.exports=fa;},null);
__d('ChatAnimatedGifs',['URI'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={shouldHideBody:function(j){if(!j.has_attachment)return false;for(var k=0;k<j.attachments.length;k++){var l=j.attachments[k];if(l.preview_url){var m=i.getRawUrlFromSafeUrl(l.preview_url);if(j.body==m)return true;}}return false;},getRawUrlFromSafeUrl:function(j){return new h(j).getQueryData().url;}};f.exports=i;},null);
__d('ChatPrivacyActionController',['ChatVisibility','JSLogger','PresencePrivacy'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=function(l,m){this._userID=l;this._logger=i.create('blackbird');this._getState=function(){if(h.isOnline())return j.allows(this._userID)?k.NORMAL:k.BLOCKED;return k.OFFLINE;};this._togglePrivacy=function(){var n=this._getState();switch(this._getState()){case k.OFFLINE:if(h.isOnline()){this._logger.error('tabs_already_online');break;}this._logger.log('tabs_go_online',{tab_id:this._userID});h.goOnline((function(){if(!j.allows(this._userID)){if(this._getState()!==k.BLOCKED)this._logger.error('privacy_action_controller_blocked_inconsistency');this._togglePrivacy();}}).bind(this));break;case k.BLOCKED:j.allow(this._userID);this._logger.log('tabs_unblock',{tab_id:this._userID});break;case k.NORMAL:j.disallow(this._userID);this._logger.log('tabs_block',{tab_id:this._userID});break;}};setTimeout((function(){var n=(function(){m&&m(this._getState());}).bind(this);n();this._subscribeToken=j.subscribe('privacy-changed',n);}).bind(this),0);};k.OFFLINE='offline';k.BLOCKED='blocked';k.NORMAL='normal';Object.assign(k.prototype,{togglePrivacy:function(){this._logger.log('gear_menu_toggle_privacy',{tab_id:this._userID});this._togglePrivacy();},destroy:function(){this._subscribeToken&&j.unsubscribe(this._subscribeToken);}});f.exports=k;},null);
__d('ChatDateBreak.react',['ChatConfig','React','Timestamp.react','cx','formatDate','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=i.PropTypes,o=i.createClass({displayName:'ChatDateBreak',propTypes:{date:n.instanceOf(Date).isRequired},shouldComponentUpdate:function(p){return this.props.date.getTime()!==p.date.getTime();},render:function(){var p=this.props.date,q;if(h.get('webmessenger_chat_tab_redesign')){q=l(this.props.date,{today:'g:ia',withinWeek:'D g:ia',thisYear:'M jS, g:ia',older:'m/d/Y g:ia'});return (i.createElement('time',{className:m(this.props.className,"_5w-5")},i.createElement('span',{className:"_5w-6"},q)));}q=l(p,{today:'g:ia',withinWeek:'l g:ia',thisYear:'F jS, g:ia',older:'F j, Y g:i a'});var r=Math.round(p.getTime()/1000);return (i.createElement('div',babelHelpers._extends({},this.props,{className:m(this.props.className,"_5w-5")}),i.createElement('div',{className:"_5w-6"},i.createElement(j,{time:r,verbose:q,text:q}))));}});f.exports=o;},null);
__d('P2PAPIUtils',['CreditCardFormParam','fbt','guid'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k={getRandomDigits:function(l){return Math.random().toString().slice(2,2+l);},genRequestID:function(){return 'id:'+j()+':'+Date.now();},genOfflineThreadingID:function(){return Date.now()+''+k.getRandomDigits(6);},getUncaughtErrorMessage:function(){return i._("R\u1ea5t ti\u1ebfc, \u0111\u00e3 x\u1ea3y ra l\u1ed7i. Vui l\u00f2ng th\u1eed l\u1ea1i sau.");},prepareCardMutationData:function(l){var m={},n=l[h.CARD_NUMBER].replace(/ /g,'');m[h.CARD_NUMBER]=n;if(typeof l[h.CARD_EXPIRATION]==='string'){var o=l[h.CARD_EXPIRATION].split('/');m[h.MONTH]=o[0];m[h.YEAR]=o[1];m[h.CARD_EXPIRATION]={};m[h.CARD_EXPIRATION][h.MONTH]=m[h.MONTH];m[h.CARD_EXPIRATION][h.YEAR]=m[h.YEAR];}else{m[h.MONTH]=l[h.CARD_EXPIRATION][h.MONTH];m[h.YEAR]=l[h.CARD_EXPIRATION][h.YEAR];}return babelHelpers._extends({},l,m);}};f.exports=k;},null);
__d("XMoneypennyPaymentsCreateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/moneypenny\/payments\/_create\/",{});},null,{});
__d("XP2PAddressesController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/addresses\/",{});},null,{});
__d("XP2PAddressCreateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/address\/_create\/",{});},null,{});
__d("XP2PBannerDismissalsUpdateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/banner_dismissals\/_update\/",{banner_type:{type:"String",required:true}});},null,{});
__d("XP2PBannerStatesController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/banner_states\/",{});},null,{});
__d("XP2PBannerViewsUpdateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/banner_views\/_update\/",{banner_type:{type:"String",required:true}});},null,{});
__d("XP2PCardBINValidateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/card_bin\/validate\/",{bin_number:{type:"String",required:true}});},null,{});
__d("XP2PCreditCardDeleteController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/credit_cards\/_delete\/",{});},null,{});
__d("XP2PCreditCardUpdateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/credit_cards\/_update\/",{});},null,{});
__d("XP2PCreditCardCreateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/credit_cards\/_create\/",{});},null,{});
__d("XP2PCreditCardVerifyController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/credit_cards\/_verify\/",{});},null,{});
__d("XP2PCreditCardsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/credit_cards\/",{});},null,{});
__d("XP2PCurrentUserProfileDataController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/current_user_profile_data\/",{});},null,{});
__d("XP2PExtensiveTransferDetailsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/transaction\/details\/",{id:{type:"String",required:true}});},null,{});
__d("XP2PFriendPickerController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/friend_picker\/",{limit:{type:"Int",defaultValue:100},query:{type:"String"}});},null,{});
__d("XP2PPasswordProtectionStatusController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/password_protection_status\/",{});},null,{});
__d("XP2PPasswordProtectionStatusUpdateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/password_protection_status\/_update\/",{});},null,{});
__d("XP2PPlatformMsgrCommerceCartCreateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/platform\/msgr_commerce\/create\/",{});},null,{});
__d("XP2PPlatformSetShippingAddressController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/platform\/set_shipping_address\/",{});},null,{});
__d("XP2PPresetCreditCardSetController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/preset_credit_card\/_set\/",{});},null,{});
__d("XP2PProductItemBannerController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/product_item_banner\/",{other_user_id:{type:"String",required:true}});},null,{});
__d("XP2PProductItemBannerDismissalController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/product_item_banner\/_dismiss\/",{platform_context_id:{type:"String",required:true}});},null,{});
__d("XP2PProductItemBannerMarkSoldController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/product_item_banner\/_mark_sold\/",{platform_context_id:{type:"String",required:true}});},null,{});
__d("XP2PTransactionsCampaignCreateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/transactions\/campaign\/_create\/",{});},null,{});
__d("XP2PTransactionsCancelController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/transactions\/_cancel\/",{});},null,{});
__d("XP2PTransactionsCreateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/transactions\/_create\/",{});},null,{});
__d("XP2PTransactionsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/transactions\/",{since:{type:"Int"}});},null,{});
__d("XP2PTransactionsDeclineController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/transactions\/_decline\/",{});},null,{});
__d("XP2PUserEligibilityController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/p2p\/user_eligibility\/",{user_ids:{type:"StringVector",required:true}});},null,{});
__d('P2PAPI',['AsyncRequest','CreditCardFormParam','CurrentEnvironment','P2PActions','P2PAPIUtils','P2PPasswordProtectionParam','P2PPaymentCampaignNames','P2PTransferParam','PaymentTokenProxyUtils','ImmutableObject','URI','XMoneypennyPaymentsCreateController','XP2PAddressesController','XP2PAddressCreateController','XP2PBannerDismissalsUpdateController','XP2PBannerStatesController','XP2PBannerViewsUpdateController','XP2PCardBINValidateController','XP2PCreditCardDeleteController','XP2PCreditCardUpdateController','XP2PCreditCardCreateController','XP2PCreditCardVerifyController','XP2PCreditCardsController','XP2PCurrentUserProfileDataController','XP2PExtensiveTransferDetailsController','XP2PFriendPickerController','XP2PPasswordProtectionStatusController','XP2PPasswordProtectionStatusUpdateController','XP2PPlatformMsgrCommerceCartCreateController','XP2PPlatformSetShippingAddressController','XP2PPresetCreditCardSetController','XP2PProductItemBannerController','XP2PProductItemBannerDismissalController','XP2PProductItemBannerMarkSoldController','XP2PTransactionsCampaignCreateController','XP2PTransactionsCancelController','XP2PTransactionsCreateController','XP2PTransactionsController','XP2PTransactionsDeclineController','XP2PUserEligibilityController','emptyFunction','isEmpty'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa){'use strict';if(c.__markCompiled)c.__markCompiled();var xa=function(za){if(!j.messengerdotcom)return p.getURI({tpe:za});return (new r('/ajax/payment/token_proxy.php').addQueryData('tpe',za));},ya={getAllCreditCards:function(){var za=da.getURIBuilder().getURI();new h().setURI(za).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler((function(ab){var bb=ab.getPayload();if(!bb.error)k.updateCreditCards(bb);}).bind(this)).send();},createTransaction:function(za){var ab=ra.getURIBuilder().getURI(),bb={},cb=za.formData,db=za.success||va,eb=za.error||va;bb[i.CREDENTIAL_ID]=cb[i.CREDENTIAL_ID];bb.amount=cb.amount;bb.receiver_id=cb.receiverId;bb.offline_threading_id=l.genOfflineThreadingID();bb.group_thread_fbid=cb.group_thread_fbid;bb.platform_context_id=cb.platform_context_id;bb.shipping_address_id=cb.shippingAddressID;bb.shipping_option_id=cb.shippingOptionID;bb.memo_text=cb.memoText;new h().setData(bb).setMethod('POST').setURI(ab).setAllowCrossPageTransition(true).setHandler((function(fb){var gb=fb?fb.getPayload():{};if(gb.error){eb(gb.error);}else{db(gb);this.getAllCreditCards();}}).bind(this)).setErrorHandler((function(){eb({message:l.getUncaughtErrorMessage()});}).bind(this)).send();},addCreditCard:function(za){k.ignoreCreditCardChannelEvents();var ab=ba.getURIBuilder().getURI().getPath(),bb=za.onSuccess||va,cb=xa(ab);za=l.prepareCardMutationData(za);var db=new q(za),eb=za.platformContext;k.creditCardSaving();new h().setAllowCrossOrigin(true).setURI(cb).setData(za).setMethod('POST').setHandler((function(fb){var gb=fb.getPayload();if(!gb.errors){db=q.set(db,gb);k.addCreditCard(db);if(gb.isPreset)k.transferAccepted();if(eb)k.checkoutCreditCardSelected(gb[i.CREDENTIAL_ID]);bb();}else k.addCreditCardError(babelHelpers._extends({requestID:db.requestID},gb));k.allowCreditCardChannelEvents();}).bind(this)).setErrorHandler((function(){k.addCreditCardError({requestID:db.requestID,errors:{general:{message:l.getUncaughtErrorMessage()}}});k.allowCreditCardChannelEvents();}).bind(this)).send();},getTransactions:function(za){za=za||{};var ab={},bb=za,cb=sa.getURIBuilder().getURI(),db=new q(bb);if(bb.since)ab.since=bb.since;return new h().setData(ab).setURI(cb).setMethod('GET').setReadOnly(true).setHandler((function(eb){var fb=eb.getPayload();if(!fb.error){k.updateTransfers(fb);}else k.updateTransfersError(babelHelpers._extends({requestID:db.requestID},fb));}).bind(this)).setErrorHandler((function(){k.updateTransfersError({error:{message:l.getUncaughtErrorMessage()},requestID:db.requestID});}).bind(this)).send();},getExtensiveTransferDetailsByID:function(za){var ab=fa.getURIBuilder().setString('id',za).getURI();new h().setURI(ab).setMethod('GET').setReadOnly(true).setHandler((function(bb){var cb=bb.getPayload();if(!cb.error)k.extensiveTransferDetailsLoaded(cb);}).bind(this)).send();},getNUXTransactions:function(){var za=new Date(),ab=Math.round(za.setDate(za.getDate()-15)/1000),bb=sa.getURIBuilder().getURI();return new h().setData({since:ab}).setURI(bb).setMethod('GET').setReadOnly(true).setHandler((function(cb){var db=cb.getPayload();if(!db.error)k.updateNUXTransfers(db);}).bind(this)).send();},updatePresetCreditCard:function(za){var ab=la.getURIBuilder().getURI();new h().setData(za).setURI(ab).setMethod('POST').setHandler((function(bb){var cb=bb.getPayload();if(!cb.error){k.updatePresetCreditCard(babelHelpers._extends({},cb,{requestID:za.requestID}));k.transferAccepted();}else k.updatePresetCreditCardError(babelHelpers._extends({},cb,{requestID:za.requestID}));}).bind(this)).setErrorHandler((function(){k.updatePresetCreditCardError({error:{message:l.getUncaughtErrorMessage()},requestID:za.requestID});}).bind(this)).send();},updateCreditCard:function(za){k.ignoreCreditCardChannelEvents();var ab=aa.getURIBuilder().getURI().getPath(),bb=xa(ab);za=l.prepareCardMutationData(za);var cb=new q(za);new h().setAllowCrossOrigin(true).setURI(bb).setData(za).setMethod('POST').setHandler((function(db){var eb=db.getPayload();if(!eb.errors){k.updateCreditCard(cb);}else k.updateCreditCardError(babelHelpers._extends({},eb,{requestID:cb.requestID}));k.allowCreditCardChannelEvents();}).bind(this)).setErrorHandler((function(){k.updateCreditCardError({errors:{general:{message:l.getUncaughtErrorMessage()}},requestID:cb.requestID});k.allowCreditCardChannelEvents();}).bind(this)).send();},deleteCreditCard:function(za){var ab=z.getURIBuilder().getURI();new h().setData(za).setMethod('POST').setURI(ab).setHandler((function(bb){var cb=bb.getPayload();if(!cb.error){k.deleteCreditCard(babelHelpers._extends({},cb,{requestID:za.requestID}));}else k.deleteCreditCardError(babelHelpers._extends({},cb,{requestID:za.requestID}));}).bind(this)).setErrorHandler((function(){k.deleteCreditCardError({error:{message:l.getUncaughtErrorMessage()},requestID:za.requestID});}).bind(this)).send();},getPasswordProtectionSetting:function(za){var ab=ha.getURIBuilder().getURI(),bb=za.success||va,cb=za.error||va;new h().setURI(ab).setMethod('GET').setReadOnly(true).setHandler((function(db){var eb=db?db.getPayload():[];if(eb.error){cb();}else bb(eb);}).bind(this)).setErrorHandler((function(){cb();}).bind(this)).send();},setPasswordProtectionSetting:function(za){var ab=ia.getURIBuilder().getURI(),bb=za.formData,cb=za.success||va,db=za.error||va,eb={};eb[m.STATUS]=bb[m.STATUS];new h().setData(eb).setURI(ab).setMethod('POST').setHandler((function(fb){var gb=fb?fb.getPayload():{};if(gb.error){db(gb.error);}else cb();}).bind(this)).setErrorHandler((function(){db();}).bind(this)).send();},declineTransaction:function(za){var ab=ta.getURIBuilder().getURI(),bb=za.formData,cb=za.success||va,db=za.error||va,eb={};eb[o.TRANSFER_ID]=bb[o.TRANSFER_ID];new h().setData(eb).setURI(ab).setMethod('POST').setHandler((function(fb){var gb=fb?fb.getPayload():{},hb={};if(gb.error){db(gb.error);}else{cb();hb[o.TRANSFER_ID]=eb[o.TRANSFER_ID];k.transferDeclined(hb);}}).bind(this)).setErrorHandler((function(){db();}).bind(this)).send();},cancelTransaction:function(za){var ab=qa.getURIBuilder().getURI(),bb=za.formData,cb=za.success||va,db=za.error||va,eb={};eb[o.TRANSFER_ID]=bb[o.TRANSFER_ID];new h().setData(eb).setURI(ab).setMethod('POST').setHandler((function(fb){var gb=fb?fb.getPayload():{};if(gb.error){db(gb.error);}else cb();}).bind(this)).setErrorHandler((function(){db();}).bind(this)).send();},verifyCreditCard:function(za){var ab=ca.getURIBuilder().getURI().getPath(),bb=xa(ab);new h().setAllowCrossOrigin(true).setURI(bb).setData(za).setMethod('POST').setHandler((function(cb){var db=cb.getPayload();if(!db.error){k.verifyCreditCard(babelHelpers._extends({},db,{requestID:za.requestID}));}else k.verifyCreditCardError(babelHelpers._extends({},db,{requestID:za.requestID}));}).bind(this)).setErrorHandler((function(){k.verifyCreditCardError({error:{message:l.getUncaughtErrorMessage()},requestID:za.requestID});}).bind(this)).send();},validateBINNumber:function(za){za=za||{};var ab=new q(za),bb=y.getURIBuilder().setString('bin_number',za.binNumber).getURI();return new h().setURI(bb).setMethod('GET').setReadOnly(true).setHandler((function(cb){var db=cb.getPayload();if(!db.error){k.binNumberValidated(babelHelpers._extends({},db,{requestID:za.requestID}));}else k.binNumberValidatedError(babelHelpers._extends({},db,{requestID:ab.requestID}));}).bind(this)).send();},getUserEligibility:function(za){za=za||{};var ab=ua.getURIBuilder().setStringVector('user_ids',za.userIDs).getURI();return new h().setURI(ab).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler((function(bb){var cb=bb.getPayload();if(!cb.error)k.userEligibilityUpdated(cb);}).bind(this)).send();},getFriendsList:function(za,ab){var bb=ga.getURIBuilder().setInt('limit',za).setString('query',ab).getURI();return new h().setURI(bb).setMethod('GET').setReadOnly(true).setHandler((function(cb){var db=cb.getPayload();if(!db.error)k.friendsListUpdated(db);}).bind(this)).send();},getBannerStates:function(){var za=w.getURIBuilder().getURI();new h().setURI(za).setMethod('GET').setReadOnly(true).setHandler((function(ab){var bb=ab.getPayload();if(!bb.error)k.bannerStatesUpdated(bb);}).bind(this)).send();},incrementBannerViews:function(za){var ab=x.getURIBuilder().setString('banner_type',za).getURI();new h().setMethod('POST').setURI(ab).send();},incrementBannerDismissals:function(za){var ab;k.bannerDismissed(za);ab=v.getURIBuilder().setString('banner_type',za).getURI();new h().setMethod('POST').setURI(ab).send();},createMoneypennyTransfer:function(za){var ab=s.getURIBuilder().getURI();new h().setMethod('POST').setURI(ab).setData({item_id:za.item_id,credential_id:za.credential_id,amount:za.amount,external_request_id:za.external_request_id}).setHandler((function(bb){var cb=bb.getPayload();if(!cb.error){k.moneypennyTransferCreated(babelHelpers._extends({},cb,{requestID:za.requestID}));this.getAllCreditCards();}else k.moneypennyTransferCreatedError(babelHelpers._extends({},cb,{requestID:za.requestID}));}).bind(this)).setErrorHandler(function(){k.moneypennyTransferCreatedError({error:{message:l.getUncaughtErrorMessage()},requestID:za.requestID});}).send();},createFinancialIncentivesTransfer:function(za){var ab=pa.getURIBuilder().getURI(),bb=za.success||va,cb=za.error||va,db={};db[i.CREDENTIAL_ID]=za.credential_id;db.external_request_id=l.genOfflineThreadingID();db.campaign_name=n.SEVIPER;new h().setData(db).setURI(ab).setMethod('POST').setHandler(function(eb){var fb=eb.getPayload();if(fb.error){cb(fb.error);}else bb();}).send();},getPlatformContextByOtherUserID:function(za){za=za||{};var ab=ma.getURIBuilder().setString('other_user_id',za.otherUserID).getURI();return new h().setURI(ab).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler((function(bb){var cb=bb.getPayload();if(!cb.error&&!wa(cb))k.addPlatformContext(cb);}).bind(this)).send();},dismissPlatformContextBanner:function(za){var ab;k.platformContextBannerDismissed(za);ab=na.getURIBuilder().setString('platform_context_id',za).getURI();new h().setMethod('POST').setURI(ab).send();},markSoldPlatformContextProductItem:function(za){var ab;k.platformContextProductItemSold(za);ab=oa.getURIBuilder().setString('platform_context_id',za).getURI();new h().setMethod('POST').setURI(ab).send();},getAddresses:function(){var za=t.getURIBuilder().getURI();return new h().setURI(za).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler(function(ab){var bb=ab.getPayload();if(!bb.error)k.updateAddresses(bb);}).send();},addAddress:function(za){var ab=u.getURIBuilder().getURI(),bb,cb=za.platformContext;za=za||{};bb={label:za.label,care_of:za.care_of,city:za.city,street1:za.street1,street2:za.street2,state:za.state,zip:za.zip};k.addressSaving();return new h().setData(bb).setURI(ab).setMethod('POST').setHandler((function(db){var eb=db.getPayload();if(!eb.errors){k.addAddress(babelHelpers._extends({},eb,bb,{requestID:za.requestID}));if(cb){k.checkoutAddressSelected(eb.id);this.setPlatformContextShippingAddress({platformContextID:cb.id,shippingAddressID:eb.id});}}else k.addAddressError(babelHelpers._extends({},eb,{requestID:za.requestID}));}).bind(this)).setErrorHandler(function(){k.addAddressError({errors:{general:{message:l.getUncaughtErrorMessage()}},requestID:za.requestID});}).send();},createMCCart:function(za){var ab=ja.getURIBuilder().getURI(),bb,cb=za.productItemID;za=za||{};bb={item_id:cb};k.checkoutCartInitiated();return new h().setData(bb).setURI(ab).setMethod('POST').setHandler(function(db){var eb=db.getPayload();if(!eb.error){k.addPlatformContext(babelHelpers._extends({},eb));k.checkoutCartCreated({sellerID:za.sellerID,productItemID:cb});}else k.addPlatformContextError(babelHelpers._extends({itemID:cb},eb));}).setErrorHandler(function(){k.addPlatformContextError({itemID:cb,error:{message:l.getUncaughtErrorMessage()}});}).send();},setPlatformContextShippingAddress:function(za){var ab=ka.getURIBuilder().getURI(),bb,cb=za.platformContextID,db=za.shippingAddressID;za=za||{};bb={platform_context_id:cb,shipping_address_id:db};k.checkoutProcessing(true);return new h().setData(bb).setURI(ab).setMethod('POST').setHandler(function(eb){k.checkoutProcessing(false);var fb=eb.getPayload();if(!fb.error)k.addPlatformContext(babelHelpers._extends({},fb));}).send();},getCurrentUserProfileData:function(){var za=ea.getURIBuilder().getURI();return new h().setURI(za).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler(function(ab){var bb=ab.getPayload();if(!bb.error){k.checkoutBuyerProfileUpdated(bb);}else k.checkoutBuyerProfileUpdated({});}).setErrorHandler(function(){k.checkoutBuyerProfileUpdated({});}).send();}};f.exports=ya;},null);
__d('P2PUserEligibilityStore',['P2PActionConstants','EventEmitter','MercuryIDs','P2PAPI','P2PDispatcher','P2PGKValues'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n,o;'use strict';var p,q;n=babelHelpers.inherits(r,i);o=n&&n.prototype;function r(){o.constructor.call(this);q={};p=l.register(this.onEventDispatched.bind(this));}r.prototype.onEventDispatched=function(s){var t=s.data,u=s.type;switch(u){case h.USER_ELIGIBILITY_UDPATED:this.handleEligibilityUpdated(t);this.emit('change');break;}};r.prototype.getEligibilityByUserIDs=function(s){var t=[],u,v,w={};for(var x=0;x<s.length;x++){v=s[x];u=q[v];if(u===undefined){q[v]=false;t.push(v);}w[v]=q[v];}if(m.P2PEnabled&&t.length)k.getUserEligibility({userIDs:t});return w;};r.prototype.getEligibilityByUserID=function(s){var t=this.getEligibilityByUserIDs([s]);return t[s];};r.prototype.getEligibilityByThreadID=function(s){return (this.getEligibilityByUserID(j.getUserIDFromThreadID(s)));};r.prototype.handleEligibilityUpdated=function(s){for(var t=0;t<s.length;t++)q[s[t].user_id]=s[t].p2p_eligible;};f.exports=new r();},null);
__d('MessageBubbleMixin',['DOMDimensions','ReactDOM'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=2,k={getInitialState:function(){return {bubbleWidth:null};},componentDidMount:function(){this._restyleBubble(this.props);},componentDidUpdate:function(l){if(l.maxWidth!==this.props.maxWidth||l.body!==this.props.body||!l.attachments&&this.props.attachments)this._restyleBubble(l);},_restyleBubble:function(l){if(this.props.attachments){this.setState({bubbleWidth:null});return;}var m=i.findDOMNode(this.refs.bubble);if(l.maxWidth!==this.props.maxWidth||h.getElementDimensions(m).width>this.props.maxWidth){var n=this.props.maxWidth;this.setState({bubbleWidth:n},this._shrinkBubble);return;}this._shrinkBubble();},_shrinkBubble:function(){var l=i.findDOMNode(this.refs.bubble),m=h.getElementDimensions(l).width,n=i.findDOMNode(this.refs.content),o=n?h.getElementDimensions(n).width+h.measureElementBox(i.findDOMNode(this.refs.contentWrapper),'width',true,false,false):0,p=o+j;if(o>0&&p<this.props.maxWidth&&m-p-this.getBoxWidth()>0)this.setState({bubbleWidth:p});}};f.exports=k;},null);
__d('ChatBubble.react',['ChatConfig','DOMDimensions','MercuryMessageBody.react','MessageBubbleMixin','React','ReactDOM','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){'use strict';if(c.__markCompiled)c.__markCompiled();var p=l.PropTypes,q=null,r=l.createClass({displayName:'ChatBubble',mixins:[k],propTypes:{attachments:p.node,body:p.string,maxWidth:p.number.isRequired,threadID:p.string},_renderContent:function(){if(!this.props.body)return null;return (l.createElement('div',{className:"_d97",ref:'contentWrapper'},l.createElement('span',{className:"_5yl5",ref:'content'},l.createElement(j,{body:this.props.body,ranges:this.props.ranges,threadID:this.props.threadID}))));},render:function(){var s=this.props.body||'';return (l.createElement('div',babelHelpers._extends({},this.props,{className:o("_5w1r"+(h.get('webmessenger_chat_tab_redesign')?' '+"_3_om":''),this.props.className),ref:'bubble',style:{maxWidth:this.props.maxWidth,width:this.state.bubbleWidth,wordWrap:s.length>=15?'break-word':'inherit'}}),this._renderContent(),this.props.attachments));},contentWraps:function(){var s=m.findDOMNode(this.refs.content),t=s.getClientRects(),u=i.getElementDimensions(s).height;return t&&t.length>1&&t[0].height<u;},getBoxWidth:function(){if(!q)q=i.measureElementBox(m.findDOMNode(this.refs.bubble),'width',true,true,false);return q;}});f.exports=r;},null);
__d('ChatMessage.react',['BootloadedComponent.react','ChatAnimatedGifs','ChatAuthorPhotoBlock.react','ChatBubble.react','ChatConfig','MercuryTimestamp','CSS','CurrentUser','ImmutableObject','JSResource','MercuryAttachment','MercuryAttachmentType','MercuryErrorInfo','MercuryIDs','MercuryMessageError.react','MercuryMessageInfo','MercuryShareStyleMap','MercuryThreads','MercuryDisplayTimeFilterMessageRenderer','React','ReactDOM','XUISpinner.react','cx','fbt','isRTL','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){'use strict';if(c.__markCompiled)c.__markCompiled();var ha=aa.PropTypes,ia=aa.createClass({displayName:'ChatMessage',propTypes:{message:ha.instanceOf(p).isRequired,maxBubbleWidth:ha.number.isRequired,onAttachmentLoad:ha.func,onStickerClick:ha.func},componentDidMount:function(){n.conditionClass(ba.findDOMNode(this),"_2cnu",this.isOneLine());},isOneLine:function(){var ka=this.props.message;return (w.isInbound(ka)&&!this.refs.attachmentsInside&&this.refs.bubble&&!this.refs.bubble.contentWraps());},shouldComponentUpdate:function(ka,la){return ka.message!==this.props.message;},render:function(){var ka=this.props.message,la=r.get(ka).length>0,ma=w.isInbound(ka),na=u.isGroupChat(ka.thread_id),oa=fa(ka.body),pa=t.hasErrorStatus(ka),qa="_5wd4"+(ma?' '+"_1nc7":'')+(!ma?' '+"_1nc6":'')+(la?' '+"_2_-t":'')+(ma&&na?' '+"_5ysy":'')+(pa?' '+"_1zcs":'')+(oa?' '+"direction_rtl":'')+(!oa?' '+"direction_ltr":'');if(l.get('webmessenger_chat_tab_redesign')){var ra={};if(!ma){ra['data-hover']='tooltip';ra['data-tooltip-position']='right';ra['aria-label']=ea._("{time}",[ea.param('time',m.getPreciseTimestamp(ka.timestamp))]);}return (aa.createElement('div',babelHelpers._extends({className:ga(this.props.className,qa)},ra),this._renderInner(),this._renderUndertext()));}return (aa.createElement(j,babelHelpers._extends({},this.props,{authorID:ka.author,className:ga(this.props.className,qa),hideName:!ma||!na,hidePhoto:!ma,timestamp:ka.timestamp}),this._renderInner(),this._renderUndertext()));},_renderInner:function(){var ka=this.props.message;if(ka.is_filtered_content)return (aa.createElement('div',{className:"_5wd9 _5wdc uiBoxYellow clearfix",ref:'inner'},z.renderFilteredContent(ka)));return (aa.createElement('div',{className:"_5wd9",ref:'inner'},this._renderBubble(),this._renderAttachments('outside')));},_renderUndertext:function(){if(this.props.message.is_filtered_content)return null;return (aa.createElement('div',{className:"_3ry4",ref:'undertext'},aa.createElement(v,{className:"_5wda clearfix",message:this.props.message,ref:'status'}),this._renderSpoofWarning()));},_renderSpoofWarning:function(){return (this.props.message.is_spoof_warning?aa.createElement(h,{bootloadPlaceholder:aa.createElement('span',null),bootloadLoader:q('MercurySpoofWarning.react'),authorID:this.props.message.author,className:"_5wdb"}):null);},_getAttachmentPlaceholder:function(){return (aa.createElement('div',{style:{padding:'20px',text_align:'center'}},aa.createElement(ca,null)));},_renderAttachments:function(ka){var la=this.props.message,ma=y.getForFBID(o.getID()).getThreadMetaNow(la.thread_id),na=ma?ma.custom_like_icon:null,oa=ka=='inside'?'attachmentsInside':'attachmentsOutside',pa=r.get(la).filter(function(qa){var ra=r.isBubblePreferred(qa);if(!l.get('webmessenger_chat_tab_redesign'))ra=ra||la.body;return ra&&ka==='inside'||!ra&&ka==='outside';});if(pa.length>0)return (aa.createElement(h,{bootloadPlaceholder:this._getAttachmentPlaceholder(),bootloadLoader:q('MercuryAttachments.react'),className:(ka==='outside'?"_3e7u":'')+(!!la.body?' '+"_16ys":'')+(l.get('webmessenger_chat_tab_redesign')?' '+"_n4o":''),attachments:pa,customLike:na,isChat:true,maxWidth:this.props.maxBubbleWidth,message:la,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,ref:oa}));},_renderBubble:function(){var ka=this.props.message,la=ka.body,ma=this._renderAttachments('inside'),na=w.isInbound(ka);if(i.shouldHideBody(ka))la='';if(la||ma)return (aa.createElement('div',{className:"_5wde"+(l.get('webmessenger_chat_tab_redesign')?' '+"_n4o":'')},aa.createElement(k,{attachments:ma,body:la,className:"_5wdf"+(ja(ka,na)?' '+"_3okg":''),maxWidth:this.props.maxBubbleWidth,ranges:ka.ranges,ref:'bubble',threadID:ka.thread_id})));}});function ja(ka,la){if(l.get('webmessenger_chat_tab_redesign'))return false;var ma=r.get(ka);if(!ka.body&&ma)return !ma.some(function(na){if(na.attach_type!==s.SHARE||!na.share)return false;var oa=x.getStyleFactory(na.share);if(oa){var pa=oa.factory;return (pa.requiresNoBubbleTail&&pa.requiresNoBubbleTail(na,la));}return false;});return true;}f.exports=ia;},null);
__d('ChatMessageGroup.react',['ChatConfig','ChatDateBreak.react','ChatMessage.react','immutable','ImmutableObject','MercuryParticipants','MercuryTimestamp','React','StoreAndPropBasedStateMixin','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){'use strict';if(c.__markCompiled)c.__markCompiled();var s=o.PropTypes,t=new l({name:'',href:'#',image_src:''}),u=h.get('chattab_rounded_profile',false),v=o.createClass({displayName:'ChatMessageGroup',mixins:[p(m)],propTypes:{activeMessageID:s.string,author:s.string,hasDateBreak:s.bool,isCanonical:s.bool,isFromViewer:s.bool,isPageMessage:s.bool,maxBubbleWidth:s.number,messages:s.instanceOf(k.List).isRequired,onAttachmentLoad:s.func,onStickerClick:s.func},statics:{calculateState:function(x){return {participants:w(x)};}},shouldComponentUpdate:function(x,y){return (this.props.activeMessageID!==x.activeMessageID||this.props.isFromViewer!==x.isFromViewer||!k.is(this.props.messages,x.messages)||!k.is(this.state.participants,y.participants));},render:function(){return (o.createElement('div',{className:"_4tdt"},this._renderProfileColumn(),this._renderName(),o.createElement('div',{className:"_4tdv"},this._renderMessages())));},_renderProfileColumn:function(){if(this.props.isFromViewer)return null;var x=this.state.participants.get(this.props.author)||t,y=r._("{name} {time}",[r.param('name',x.name),r.param('time',n.getPreciseTimestamp(this.props.messages.last().timestamp))]);return (o.createElement('div',{className:"_31o4"+(u?' '+"_3njy":'')},o.createElement('a',{'aria-label':y,className:"_4tdw",'data-hover':'tooltip','data-tooltip-position':'left',href:x.href,ref:'link'},o.createElement('img',{src:x.image_src,ref:'image'}))));},_renderName:function(){if(this.props.isCanonical||this.props.isFromViewer)return null;var x=this.state.participants.get(this.props.messages.first().author);if(!x)return null;return (o.createElement('div',{className:"_4tdx"},x.short_name));},_renderMessages:function(){var x=this.props.messages.size,y=[];this.props.messages.forEach((function(z,aa,ba){var ca=z.message_id===this.props.activeMessageID;if(ca&&!(aa===0&&this.props.hasDateBreak))y.push(o.createElement(i,{date:new Date(z.timestamp),key:'db:'+z.message_id}));y.push(o.createElement(j,{isFromViewer:this.props.isFromViewer,key:z.message_id,maxBubbleWidth:this.props.maxBubbleWidth,message:z,nextTimestamp:this._getNextTimestamp(ba,x,aa),onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick}));}).bind(this));return y;},_getNextTimestamp:function(x,y,z){return z<y-1?x.get(z+1).timestamp:this.props.nextTimestamp;}});function w(x){return k.Map().withMutations(function(y){x.readReceipts.forEach(function(z,aa){y.set(aa,m.getOrFetch(aa));});y.set(x.author,m.getOrFetch(x.author));});}f.exports=v;},null);
__d('ChatConversation.react',['ChatConfig','ChatDateBreak.react','ChatMessage.react','immutable','MercuryActionType','MercuryLogMessage.react','MercuryShareAttachmentRenderLocations','React','cx','invariant','ChatMessageGroup.react','MessageList.react'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){'use strict';if(c.__markCompiled)c.__markCompiled();var r,s;if(h.get('webmessenger_chat_tab_redesign')){r=c('ChatMessageGroup.react');s=c('MessageList.react');}var t=o.PropTypes,u=1000*60*60,v=o.createClass({displayName:'ChatConversation',propTypes:{contextBanner:t.object,isCanonical:t.bool.isRequired,loadMoreMessages:t.func,maxBubbleWidth:t.number.isRequired,messages:t.instanceOf(k.List).isRequired,onAttachmentLoad:t.func,onStickerClick:t.func,viewer:t.string.isRequired},componentWillReceiveProps:function(w){!(w.maxBubbleWidth===this.props.maxBubbleWidth)?q(0):undefined;},render:function(){if(h.get('webmessenger_chat_tab_redesign'))return (o.createElement('div',null,this.props.contextBanner,o.createElement(s,{DateBreak:i,deliveryTimestamp:0,isCanonical:this.props.isCanonical,location:n.CHAT,LogMessage:m,loadMoreMessages:this.props.loadMoreMessages,maxBubbleWidth:this.props.maxBubbleWidth,MessageGroup:r,messages:this.props.messages,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,readReceipts:k.OrderedMap(),viewer:this.props.viewer})));var w=this.props.messages.toArray(),x=[];for(var y=0;y<w.length;y++){var z=w[y],aa=y>0?w[y-1]:null;if(!aa||z.timestamp-aa.timestamp>u)x.push(o.createElement(i,{date:new Date(z.timestamp),key:'db:'+z.message_id}));if(z.action_type==l.LOG_MESSAGE){x.push(o.createElement(m,{className:"_5w0o",key:z.message_id,message:z,onImageLoad:this.props.onAttachmentLoad}));}else x.push(o.createElement(j,{key:z.message_id,message:z,maxBubbleWidth:this.props.maxBubbleWidth,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick}));}return (o.createElement('div',null,this.props.contextBanner,x));}});f.exports=v;},null);
__d('MercuryMessageList',['immutable','LogHistory','Map','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l=i.getInstance('mercury_message_list');function m(o){this.$MercuryMessageList1=h.List(o||[]);this.$MercuryMessageList2();}m.prototype.append=function(o){var p;this.$MercuryMessageList1=(p=this.$MercuryMessageList1).push.apply(p,o);this.$MercuryMessageList2();n('append',o);};m.prototype.prepend=function(o){var p;this.$MercuryMessageList1=(p=this.$MercuryMessageList1).unshift.apply(p,o);this.$MercuryMessageList2();n('prepend',o);};m.prototype.update=function(o){var p=o.filter((function(q){return this.contains(q);}).bind(this));if(p.length===0)return;this.$MercuryMessageList1=this.$MercuryMessageList1.withMutations((function(q){p.forEach((function(r){var s=this.$MercuryMessageList3.get(r.message_id);if(s!==undefined)q.set(s,r);}).bind(this));}).bind(this));n('update',p);};m.prototype.reorder=function(o){this.$MercuryMessageList1=h.List(o);this.$MercuryMessageList2();n('reorder',o);};m.prototype.at=function(o){return this.$MercuryMessageList1.get(o);};m.prototype.contains=function(o){return this.$MercuryMessageList3.has(o.message_id);};m.prototype.toArray=function(){return this.$MercuryMessageList1.toArray();};m.prototype.toMap=function(){return new j(h.Seq(this.$MercuryMessageList1).map(function(o){return [o.message_id,o];}));};m.prototype.$MercuryMessageList2=function(){this.$MercuryMessageList3=new j(h.Seq(this.$MercuryMessageList1).map(function(o,p){return [o.message_id,p];}));};function n(event,o){k(function(){l.debug(event,{messageIDs:o.map(function(p){return p.message_id;})});},0);}f.exports=m;},null);
__d('MercuryMessageStore',['MercuryAPIArgsSource','LogHistory','MercuryMessages','MercuryViewer','MercuryMessageList','SubscriptionsHandler','MercuryThreadInformer','MercuryThreadlistConstants','mixInEventEmitter','setImmediate','setTimeoutAcrossTransitions','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){'use strict';if(c.__markCompiled)c.__markCompiled();var s=c('MercuryThreads').get(),t=i.getInstance('mercury_message_store');function u(w,x,y){this.$MercuryMessageStore1=w;this.$MercuryMessageStore2=new l();this.$MercuryMessageStore3=y?j.getForFBID(y):j.get();this.$MercuryMessageStore4=1;this.$MercuryMessageStore5=null;this.$MercuryMessageStore6=0;this.$MercuryMessageStore7=x||o.RECENT_MESSAGES_LIMIT;this.$MercuryMessageStore8=y?n.getForFBID(y):n.get();this.$MercuryMessageStore9=new m();this.$MercuryMessageStore9.addSubscriptions(this.$MercuryMessageStore8.subscribe('messages-received',(function(z,aa){return this.$MercuryMessageStore10(aa);}).bind(this)),this.$MercuryMessageStore8.subscribe('messages-updated',(function(z,aa){return aa[this.$MercuryMessageStore1]&&this.$MercuryMessageStore11(aa[this.$MercuryMessageStore1]);}).bind(this)),this.$MercuryMessageStore8.subscribe('messages-reordered',(function(z,aa){return aa[this.$MercuryMessageStore1]&&this.$MercuryMessageStore12();}).bind(this)));t.debug('constructed',{threadID:this.$MercuryMessageStore1});this.$MercuryMessageStore13();}u.prototype.setNewThreadID=function(w){this.$MercuryMessageStore14=w;};u.prototype.destroy=function(){this.$MercuryMessageStore9&&this.$MercuryMessageStore9.release();t.debug('destroyed',{threadID:this.$MercuryMessageStore1});};u.prototype.subscribe=function(w){return this.addRetroactiveListener('updated',w);};u.prototype.fetchMoreMessages=function(){if(this.hasFetchedAll())return false;this.$MercuryMessageStore13();return true;};u.prototype.hasFetchedAll=function(){if(this.$MercuryMessageStore3.hasLoadedExactlyNMessages(this.$MercuryMessageStore1,this.$MercuryMessageStore6)&&this.$MercuryMessageStore3.hasLoadedAllMessages(this.$MercuryMessageStore1))return true;return s.isNewEmptyLocalThread(this.$MercuryMessageStore1);};u.prototype.$MercuryMessageStore13=function(){var w=this.$MercuryMessageStore6+this.$MercuryMessageStore7*this.$MercuryMessageStore4;t.debug('fetching',{threadID:this.$MercuryMessageStore1,limit:w});this.$MercuryMessageStore3.getThreadMessagesRange(this.$MercuryMessageStore1,0,w,this.$MercuryMessageStore15.bind(this),null,h.MERCURY);if(this.$MercuryMessageStore4<10)this.$MercuryMessageStore4+=1;if(this.$MercuryMessageStore3.hasLoadedNMessages(this.$MercuryMessageStore1,w))q((function(){this.$MercuryMessageStore12();}).bind(this));};u.prototype.$MercuryMessageStore15=function(w){if(w&&w.length){this.$MercuryMessageStore5=w[0].timestamp;this.$MercuryMessageStore6=w.length;t.debug('fetched',{threadID:this.$MercuryMessageStore1,earliestMessageTimestamp:this.$MercuryMessageStore5,count:this.$MercuryMessageStore6});}else if(w&&!w.length&&!this.$MercuryMessageStore6)this.$MercuryMessageStore16(u.THREAD_IS_EMPTY);};u.prototype.$MercuryMessageStore10=function(w){var x=[],y=w[this.$MercuryMessageStore1];if(y&&y.length)x=x.concat(y);if(this.$MercuryMessageStore14){var z=w[this.$MercuryMessageStore14];if(z&&z.length){x=x.concat(z);this.$MercuryMessageStore14=null;}}if(x.length){this.$MercuryMessageStore2.append(x);this.$MercuryMessageStore6+=x.length;var aa=x.every(function(ba){return ba.author!=k.getID();});this.$MercuryMessageStore16(u.MESSAGES_RECEIVED,{allFromOthers:aa});}};u.prototype.$MercuryMessageStore11=function(w){this.$MercuryMessageStore2.update(this.$MercuryMessageStore3.getMessagesFromIDs(Object.keys(w)));this.$MercuryMessageStore17();this.$MercuryMessageStore16(u.MESSAGES_CHANGED);};u.prototype.$MercuryMessageStore12=function(){if(!this.$MercuryMessageStore5)return;this.$MercuryMessageStore2.reorder(this.$MercuryMessageStore3.getThreadMessagesSinceTimestamp(this.$MercuryMessageStore1,this.$MercuryMessageStore5));this.$MercuryMessageStore17();this.$MercuryMessageStore16(u.MESSAGES_REORDERED);};u.prototype.$MercuryMessageStore16=function(w,x){var y=this.$MercuryMessageStore2.toArray();this.releaseHeldEventType('updated');this.emitAndHold('updated',babelHelpers._extends({messages:y,eventType:w},x));v(this.$MercuryMessageStore1,w,y);};u.prototype.$MercuryMessageStore17=function(){var w=this.$MercuryMessageStore2.at(0);if(w)this.$MercuryMessageStore5=w.timestamp;};function v(w,x,y){r(function(){t.debug('update:'+x,{threadID:w,messageIDs:y.map(function(z){return z.message_id;})});},0);}Object.assign(u,{MESSAGES_FETCHED:'fetched',MESSAGES_CHANGED:'changed',MESSAGES_RECEIVED:'received',MESSAGES_REORDERED:'reordered',THREAD_IS_EMPTY:'thread-is-empty'});p(u,{updated:true});f.exports=u;},null);
__d('ChatTabMessagesView',['Animation','Arbiter','BanzaiLogger','CSS','ChatConversation.react','ChatPerfInstrumentation','ChatTabViewEvents','ChatTypingIndicators.react','ChatWelcomeMessage','CurrentUser','DOM','Event','immutable','MercuryLastMessageIndicator.react','LiveTimer','MercuryIDs','MercuryViewer','MercuryMessageStore','MessengerContextBannerBootloader','MessengerHotLikePreviewEvents','React','ReactDOM','ReactComponentRenderer','MercuryShareAttachmentRenderLocations','Scroll','ServerTime','StickerActions','StickerState','StickerStoreController','Style','SubscriptionsHandler','UserAgent_DEPRECATED','arrayContains','getElementPosition','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa){'use strict';if(c.__markCompiled)c.__markCompiled();var qa=64,ra=null,sa=20;function ta(va){if(ra===null){var wa=va.childNodes[0];ka.set(va,'overflow','scroll');ra=wa.clientWidth-qa;ka.set(va,'overflow','');}return ra;}function ua(va,wa,xa,ya,za,ab,bb,cb,db){this.loadingIcon=za;this.threadID=va;this.sheetController=wa;this.scrollContainer=xa;this.conversationElem=ya;this.contextBannerEligible=db;this.contextBannerElem=null;this.tabView=cb;v.restart(ga.get()/1000);this._loadingMoreMessages=false;this._initialLoadFinished=false;function eb(){n.inform('interaction-with-tab',va);}this._subscriptions=new la();this._subscriptions.addSubscriptions(i.subscribe('overflow-applied-to-body',this.scrollToBottom.bind(this)),s.listen(this.scrollContainer,'mousedown',eb));if(ma.firefox()){var fb='WheelEvent' in window?'wheel':'DOMMouseScroll';this.scrollContainer.addEventListener(fb,eb,false);}else this._subscriptions.addSubscriptions(s.listen(this.scrollContainer,'mousewheel',eb));this._subscriptions.addSubscriptions(s.listen(this.scrollContainer,'scroll',pa(this.scrolling,50,this)));var gb;ca.render(ba.createElement(o,{threadID:this.threadID,indicatorsWillShow:(function(){return (gb=this.isScrolledToBottom());}).bind(this),indicatorsDidShow:(function(){return (gb&&this.scrollToBottom(true));}).bind(this),viewer:q.getID()}),bb);var hb;this.lastMessageIndicatorNode=ab;this.lastMessageIndicator=new da(u,this.lastMessageIndicatorNode);this.lastMessageIndicator.setProps({threadID:this.threadID,hideTyping:true,indicatorWillShow:(function(){return hb=this.isScrolledToBottom();}).bind(this),indicatorDidShow:(function(){return hb&&this.scrollToBottom(true);}).bind(this)});this.initializeConversation();}Object.assign(ua.prototype,{initializeConversation:function(){this._store=new y(this.threadID);this._conversation=new da(l,this.conversationElem);this._conversation.setProps({isCanonical:w.isCanonical(this.threadID),loadMoreMessages:this._loadMoreMessages.bind(this),maxBubbleWidth:ta(this.scrollContainer),messages:t.List(),onAttachmentLoad:(function(va){var wa=this.scrollContainer,xa=fa.getTop(wa)+wa.clientHeight;if(xa+va>=wa.scrollHeight)this.scrollToBottom();}).bind(this),onStickerClick:this._onStickerClick.bind(this),viewer:q.getID()});this._subscriptions.addSubscriptions(this._store.subscribe(this._updateMessageFromStore.bind(this)),aa.addListener(aa.START,(function(va,wa){if(this.threadID!==wa)return;this._likePreview=va;this._conversation.setProps({messages:this._getNormalizedMessages()},this.scrollToBottom.bind(this));this.scrollToBottom();clearInterval(this._scrollToBottomInterval);this._scrollToBottomInterval=setInterval(this.scrollToBottom.bind(this),50);}).bind(this)),aa.addListener(aa.STOP,(function(va){if(this.threadID!==va)return;this._likePreview=null;}).bind(this)),aa.addListener(aa.FINISH_ANIMATION,(function(va){clearInterval(this._scrollToBottomInterval);}).bind(this)),aa.addListener(aa.REMOVE,(function(va){if(this.threadID!==va)return;clearInterval(this._scrollToBottomInterval);this._likePreview=null;this._conversation.setProps({messages:this._getNormalizedMessages()});}).bind(this)));},_updateMessageFromStore:function(va){if(va.eventType==y.MESSAGES_RECEIVED&&va.allFromOthers&&!this.isScrolledToBottom()){this.sheetController.openNewMessagesSheet();this._newMessagesSheetOpened=true;}if(va.eventType==y.MESSAGES_REORDERED){this._loadingMoreMessages=false;k.hide(this.loadingIcon);}var wa=this.isScrolledToBottom(),xa=this._getLoadingHeight(),ya=this.scrollContainer.scrollHeight,za=fa.getTop(this.scrollContainer);this._messages=va.messages;var ab=p.getWelcomeMessage(this.threadID);if(ab)this._messages.push(ab);this._conversation.setProps({messages:this._getNormalizedMessages()},(function(){if(wa||this._shouldScrollToBottom){this.scrollToBottom();this.setShouldScrollToBottom(false);}else if(va.eventType==y.MESSAGES_REORDERED)this.scrollToPosition(this.scrollContainer.scrollHeight-ya-xa+za);if(!this._initialLoadFinished){this._initialLoadFinished=true;m.logCHAT_CONVERSATION_TTI();}if(this._store.hasFetchedAll()&&this.contextBannerEligible)this.renderContextBanner(this.threadID);}).bind(this));this.lastMessageIndicator.setProps({lastMessage:this._messages.length>0?this._messages[this._messages.length-1]:null});if(va.eventType==y.MESSAGES_RECEIVED&&this._shouldShowStickerReplyNUX(this._messages)&&this.tabView&&this.tabView.isFocused())this.tabView.showStickerReplyNUX();if(va.eventType==y.MESSAGES_CHANGED)this._checkToAnimateSticker();},setShouldScrollToBottom:function(va){this._shouldScrollToBottom=va;},scrolling:function(){this._checkToAnimateSticker();if(this.isScrolledNearTop()&&!this._loadingMoreMessages&&!this.isScrolledToBottom()&&!this.tabView._isDragDropActive)if(this._store.fetchMoreMessages()){k.show(this.loadingIcon);this._loadingMoreMessages=true;}if(!this._newMessagesSheetOpened)return;if(this.isScrolledToBottom()){this.sheetController.closeNewMessagesSheet();this._newMessagesSheetOpened=false;}},getScrollTop:function(){return this.scrollContainer&&fa.getTop(this.scrollContainer);},destroy:function(){r.scry(this.conversationElem,'.stickerContainer').forEach(function(va){return ca.unmountComponentAtNode(va);});this.unmountContextBanner();ca.unmountComponentAtNode(this.conversationElem);this._subscriptions&&this._subscriptions.release();ca.unmountComponentAtNode(this.lastMessageIndicatorNode);delete this.lastMessageIndicator;this._store&&this._store.destroy();this.destroyed=true;},_getLoadingHeight:function(){return this.loadingHeight||this.loadingIcon.clientHeight;},_shouldShowStickerReplyNUX:function(va){if(!ia.shouldShowStickerReplyNUX()||!va.length)return false;var wa=va[va.length-1];if(wa.author===x.getID())return false;if(wa.has_attachment)return wa.attachments.some(function(xa){return xa.attach_type==='sticker';});return false;},isScrolledToBottom:function(va){var wa=this.scrollContainer;va=va||sa;return fa.getTop(wa)+wa.clientHeight>=wa.scrollHeight-va;},isScrolledNearTop:function(){return fa.getTop(this.scrollContainer)<this.scrollContainer.clientHeight;},scrollToBottom:function(va){this.scrollToPosition(this.scrollContainer.scrollHeight,va);},scrollToPosition:function(va,wa){this._scrollTopAnimation&&this._scrollTopAnimation.stop();if(wa===true){this._scrollTopAnimation=new h(this.scrollContainer).to('scrollTop',va).ease(h.ease.end).duration(400).go();}else fa.setTop(this.scrollContainer,va);},_loadMoreMessages:function(){return this._store.fetchMoreMessages();},_onStickerClick:function(va,wa){if(!va)return;j.log('StickersLoggerConfig',{event:'click_sticker',packid:va,stickerid:wa});var xa=this.tabView;ia.onTrayDataReady(function(){if(na(ia.getPackIDsInTray(),va)){var ya=ia.getPack(va);if(ya&&ya.isPromoted)ha.addPack(va);xa.setStickersFlyoutPackID(va);}else ja.showStore(va);});},_checkToAnimateSticker:function(){var va=oa(this.scrollContainer);i.inform('chatScrolled/'+this.threadID,{scrollTop:fa.getTop(this.scrollContainer),top:va.y,viewHeight:va.height});},setNewThreadID:function(va){this._store.setNewThreadID(va);},_getNormalizedMessages:function(){if(this._likePreview){this._messages.push(this._likePreview);}else this._messages=this._messages.filter(function(va){return !va.is_like_preview;});return t.List(this._messages);},renderContextBanner:function(va,wa){z.getBootloadedComponent(va,ea.CHAT,(function(xa){ka.set(this.conversationElem,'padding-top','80px');this._conversation.setProps({contextBanner:xa});}).bind(this),wa,(function(xa){ka.set(this.conversationElem,'padding-top',xa+'px');}).bind(this));},unmountContextBanner:function(){if(this._conversation)this._conversation.setProps({contextBanner:null});}});f.exports=ua;},null);
__d('ChatTabOfficeStatus',['fbt','formatDate','CSS'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=1,l=2,m=3,n={update:function(o,p){if(!o||!p||!p.officeStatus)return;this._updateIcon(o,p);this._updateTooltip(o,p);},_updateIcon:function(o,p){j.removeClass(o,'officeStatusNone');j.removeClass(o,'officeStatusAvailable');j.removeClass(o,'officeStatusSporadic');j.removeClass(o,'officeStatusOutOfOffice');switch(p.officeStatus){case k:j.addClass(o,'officeStatusAvailable');break;case l:j.addClass(o,'officeStatusSporadic');break;case m:j.addClass(o,'officeStatusOutOfOffice');break;default:j.addClass(o,'officeStatusNone');break;}},_updateTooltip:function(o,p){var q='';switch(p.officeStatus){case k:q+=h._("M\u1ede C\u1eecA");q+='\n';break;case l:q+=h._("TH\u1ec8NH THO\u1ea2NG");q+='\n';break;case m:q+=h._("HO\u00c0N TO\u00c0N V\u1eaeNG M\u1eb6T");q+='\n';break;default:q+=h._("KH\u00d4NG X\u00c1C \u0110\u1ecaNH");q+='\n';break;}if(p.officeStatusComment)q+=p.officeStatusComment;if(p.officeStatusLocation)q+=' ('+p.officeStatusLocation+')';if(p.officeStatusComment||p.officeStatusLocation)q+='\n';if(p.officeStatusEndDate){var r=i(p.officeStatusEndDate,'M d, Y');q+=h._("Cho \u0111\u1ebfn {date}",[h.param('date',r)]);}o.setAttribute('aria-label',q);o.setAttribute('data-hover','tooltip');}};f.exports=n;},null);
__d('ChatAddToThreadButton.react',['Link.react','ReactComponentWithPureRenderMixin','React','TrackingNodes','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();var n=j.PropTypes,o=j.createClass({displayName:'ChatAddToThreadButton',mixins:[i],propTypes:{isFBAtWork:n.bool,onClick:n.func,shown:n.bool},render:function(){var p=this.props.isFBAtWork?m._("Th\u00eam \u0111\u1ed3ng nghi\u1ec7p \u0111\u1ec3 tr\u00f2 chuy\u1ec7n"):m._("Th\u00eam b\u1ea1n b\u00e8 kh\u00e1c v\u00e0o cu\u1ed9c tr\u00f2 chuy\u1ec7n"),q=k.getTrackingInfo(k.types.ADD_TO_THREAD);return (j.createElement(h,{'aria-label':p,className:"addToThread"+(' '+"button")+(!this.props.shown?' '+"hidden_elem":''),'data-ft':q,'data-hover':'tooltip','data-tooltip-alignv':'top',onClick:this.props.onClick}));}});f.exports=o;},null);
__d('ChatArchiveWarning.react',['Image.react','ReactComponentWithPureRenderMixin','React','cx','ix'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();var m=j.PropTypes,n=j.createClass({displayName:'ChatArchiveWarning',mixins:[i],propTypes:{isFBAtWork:m.bool,shown:m.bool},render:function(){var o=this.props.isFBAtWork?l('images/chat/tab/archive-grey.png'):l('images/chat/tab/archive.png');return (j.createElement(h,{src:o,className:"titanArchiveWarning"+(' '+"button")+(!this.props.shown?' '+"hidden_elem":''),'data-hover':'tooltip','data-tooltip-alignh':'center','aria-label':'All employee-to-employee conversations will be archived'}));}});f.exports=n;},null);
__d('ChatCloseButton.react',['Link.react','ReactComponentWithPureRenderMixin','React','TrackingNodes','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();var m=j.PropTypes,n=j.createClass({displayName:'ChatCloseButton',mixins:[i],propTypes:{onClick:m.func,onKeyUp:m.func,onMouseDown:m.func,active:m.bool},getDefaultProps:function(){return {active:false};},render:function(){var o=k.getTrackingInfo(k.types.CLOSE_BUTTON),p=l._("Nh\u1ea5n Esc \u0111\u1ec3 \u0111\u00f3ng"),q=l._("\u0110\u00f3ng tab");return (j.createElement(h,{'aria-label':this.props.active?p:q,className:'close button','data-ft':o,'data-hover':'tooltip','data-tooltip-position':'above',onClick:this.props.onClick,onKeyUp:this.props.onKeyUp,onMouseDown:this.props.onMouseDown}));}});f.exports=n;},null);
__d('ChatNubLogger',['BanzaiLogger','ScriptPath','pageID'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k='TimeSpentChatNubLoggerConfig',l={INPUT_ACTIVE:'active',INPUT_INACTIVE:'inactive'},m={ENTER:'enter',LEAVE:'leave'},n=l.INPUT_INACTIVE,o=0,p=false;function q(){if(n==l.INPUT_ACTIVE&&!p){n=l.INPUT_INACTIVE;r(m.LEAVE);o=0;}else if(n==l.INPUT_INACTIVE&&p){n=l.INPUT_ACTIVE;o=Date.now();r(m.ENTER);}}function r(event){var t=h.create({retry:true});t.log(k,{event:event,client_event_time_ms:Date.now(),active_time_ms:event==m.LEAVE?Date.now()-o:0,page_id:j,script_path:i.getScriptPath(),page_data:i.getPageInfo()?i.getPageInfo().extraData:{}});}var s={processEvent:function(t){switch(t){case 'focus':p=true;break;case 'blur':p=false;break;default:break;}q();}};f.exports=s;},null);
__d('ContextualLayerAutoFlipHorizontal',['ContextualLayerAutoFlip'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i,j;i=babelHelpers.inherits(k,h);j=i&&i.prototype;k.prototype.getValidPositions=function(l){'use strict';return [l.getPosition()];};function k(){'use strict';i.apply(this,arguments);}f.exports=k;},null);
__d('StickerContextualDialog.react',['ContextualLayerAutoFlipHorizontal','MercuryConfig','ReactAbstractContextualDialog','ReactLayer','cx'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();var m=i.WWW2lc?7:47,n=k.createClass(j.createSpec({addedBehaviors:[h],displayName:'StickerXUIContextualDialog',theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:m,length:16}}}));n.WIDTH={NORMAL:312,WIDE:400};f.exports=n;},null);
__d('ChatStickerButton.react',['BootloadedComponent.react','JSResource','Link.react','ReactComponentWithPureRenderMixin','React','ReactLayeredComponentMixin','StickerActions','StickerContextualDialog.react','StickerStateStore','StoreAndPropBasedStateMixin','XUISpinner.react','cx','emptyFunction','fbt','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){'use strict';if(c.__markCompiled)c.__markCompiled();var w=l.PropTypes,x=278,y=l.createClass({displayName:'ChatStickerButton',_clickGuard:false,mixins:[k,m,q(p)],propTypes:{className:w.string,ContextualDialogClass:w.func.isRequired,disabled:w.bool,flyoutClassName:w.string,flyoutWidth:w.number,isChat:w.bool,onStickerSelect:w.func.isRequired,onEmoticonSelect:w.func.isRequired,onFlyoutShown:w.func,onFlyoutHidden:w.func,threadID:w.string},statics:{calculateState:function(z){var aa=p.getState();return {shown:aa.showTray&&z.threadID===aa.threadID};}},getDefaultProps:function(){return {ContextualDialogClass:o,disabled:false,flyoutWidth:x,onStickerSelect:t,onEmoticonSelect:t};},componentWillUnmount:function(){if(this.state.shown)this._hideFlyout();},render:function(){return (l.createElement(j,{className:v(this.props.className,this.state.shown?"open":''),onClick:this.showFlyout,onMouseDown:this._prepareForClick,role:'button',title:u._("Ch\u1ecdn m\u1ed9t nh\u00e3n d\u00e1n ho\u1eb7c c\u1ea3m x\u00fac"),ref:'link'},l.createElement('i',{className:"_4l9x"})));},renderLayers:function(){var z=this.props.ContextualDialogClass;return {contextualDialog:l.createElement(z,{alignment:this.props.flyoutAlignment,className:"_5e-r",contextRef:(function(){return this.refs.link;}).bind(this),onBeforeHide:this._handleBeforeHide,onBlur:this._hideFlyout,position:'above',shown:this.state.shown,width:this.props.flyoutWidth},l.createElement(h,{bootloadPlaceholder:l.createElement('div',{style:{padding:'30px',textAlign:'center'}},l.createElement(r,{size:'large'})),bootloadLoader:i('StickersFlyout.react'),className:this.props.flyoutClassName,onShown:(function(aa){if(this.props.onFlyoutShown)this.props.onFlyoutShown(aa);}).bind(this),onHidden:(function(){if(this.props.onFlyoutHidden)this.props.onFlyoutHidden();}).bind(this),onEscKeyDown:this._hideFlyout,onStickerSelect:this._handleStickerSelected,onEmoticonSelect:this._handleEmoticonSelected,shown:this.state.shown}))};},_prepareForClick:function(){this._clickGuard=this.state.shown;},showFlyout:function(z){z&&z.stopPropagation();if(this._clickGuard||this.props.disabled){this._clickGuard=false;return;}n.showStickerTray(this.props.threadID);},_handleBeforeHide:function(){if(this.state.shown){this._hideFlyout();return false;}},_hideFlyout:function(){n.hideStickerTray();},_handleStickerSelected:function(z){this.props.onStickerSelect(z);},_handleEmoticonSelected:function(z){this._hideFlyout();this.props.onEmoticonSelect(z);}});f.exports=y;},null);
__d('ChatFileUploader.react',['ChatFileUploaderMixin','InlineBlock.react','MercuryConfig','React','ReactDOM','cx','createCancelableFunction','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){'use strict';if(c.__markCompiled)c.__markCompiled();var p=k.createClass({displayName:'ChatFileUploader',mixins:[h],getDefaultProps:function(){return {uploaderIsFromHigherLevel:true};},shouldComponentUpdate:function(){return false;},componentDidMount:function(){this._uploaderCallback=n(this.setUpSubscriptionsHandler);this.props.initFileUploaderFn(l.findDOMNode(this.refs.form),l.findDOMNode(this.refs.input),l.findDOMNode(this.refs.attachID)).then(this._uploaderCallback);},componentWillUnmount:function(){if(this._uploaderCallback)this._uploaderCallback.cancel();},render:function(){return (k.createElement('form',{ref:'form',action:j.upload_url,method:'post'},k.createElement('input',{type:'hidden',ref:'attachID',name:'attach_id'}),k.createElement(i,{className:"_m _4q60 itemLabel"},k.createElement('input',{type:'file',className:"_n",name:'attachment[]',multiple:'true',ref:'input'}),k.createElement('span',{className:"_4q61 itemAnchor"},o._("Th\u00eam t\u1eadp tin...")))));}});f.exports=p;},null);
__d('NotificationSettingsDialog',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={show:function(i){e(['MercuryThreadActions'],function(j){j.get().openNotificationSettings(i);});}};f.exports=h;},null);
__d('ChatTabMenu.react',['AsyncDialog','AsyncRequest','Bootloader','ChatConfig','ChatFileUploader.react','ChatPrivacyActionController','ChatTabActions','Dialog','MercuryConfig','MercuryIDs','MercuryLogMessageType','MercuryMessengerBlockingUtils','MercuryParticipants','MercuryThreadMuter','MercuryViewer','MercurySourceType','NFXChatHeadGK','Promise','ReactComponentWithPureRenderMixin','React','PopoverMenu.react','ReactMenu','MenuSeparator.react','Run','Toggler','TrackingNodes','URI','WebMessengerDeleteThreadDialog','WebMessengerThreadPermalinks','XNFXStartForMessageThreadController','WorkModeConfig','WorkFileUploadsGating','NotificationSettingsDialog','MessengerNotificationSettingsGKModule','cx','fbt','goURI','MercuryMessageObject','MercuryThreadIDMap','MercuryThreadActions','MercuryThreads','MercuryMessageActions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra){'use strict';if(c.__markCompiled)c.__markCompiled();var sa=c('MercuryMessageObject').get(),ta=c('MercuryThreadIDMap').get(),ua=c('MercuryThreadActions').get(),va=c('MercuryThreads').get(),wa=c('MercuryMessageActions').get(),xa=ca.Item,ya=aa.PropTypes,za=aa.createClass({displayName:'ChatTabMenu',_privacyActionController:undefined,_fileUploaderPromise:undefined,mixins:[z],propTypes:{attachmentsShelf:ya.object,nameConversationFunc:ya.func,isGroupChat:ya.bool,isEmptyChat:ya.bool,hasMessageBlocked:ya.bool,hasSecretModeOn:ya.bool,onFileUploaderMounted:ya.func,onSubmit:ya.func,onUpdateAttachmentsShelf:ya.func,onUploadFinished:ya.func,otherUserID:ya.string,sheetController:ya.object.isRequired,showAddFriend:ya.func,threadID:ya.string.isRequired},getInitialState:function(){return {url:null,privacyText:'',muted:false};},getDefaultProps:function(){return {show:true,isMuted:false,hasSwitchToWork:false};},componentDidMount:function(){ja.getThreadURI(this.props.threadID,(function(ab){this.isMounted()&&this.setState({url:ab});}).bind(this));if(!this.props.isGroupChat)this._privacyActionController=new m(q.getUserIDFromThreadID(this.props.threadID),(function(ab){return this._updatePrivacyLink(ab);}).bind(this));},componentDidUpdate:function(ab,bb){if(this.props.isMuted&&!ab.isMuted){this.props.sheetController.openThreadIsMutedTabSheet();}else if(!this.props.isMuted&&ab.isMuted)this.props.sheetController.closeThreadIsMutedTabSheet();if(this.props.hasMessageBlocked){this.props.sheetController.openMessageBlockedTabSheet();}else this.props.sheetController.closeMessageBlockedTabSheet();if(this.props.hasSecretModeOn){this.props.sheetController.openSecretModeSheet();}else this.props.sheetController.closeSecretModeSheet();},_initFileUploader:function(ab,bb,cb){if(this._fileUploaderPromise){this._fileUploaderPromise.then(function(db){db.updateElements(ab,bb,cb);});}else this._fileUploaderPromise=new y((function(db,eb){ea.onAfterLoad((function(){j.loadModules(["MercuryFileUploader"],(function(fb){var gb=new fb(this.props.attachmentsShelf,ab,bb,cb);db(gb);}).bind(this));}).bind(this));}).bind(this));return this._fileUploaderPromise;},componentWillUnmount:function(){this._privacyActionController&&this._privacyActionController.destroy();this._fileUploaderPromise&&this._fileUploaderPromise.then(function(ab){ab.destroy();});},_unmuteThread:function(){ua.unmute(this.props.threadID);fa.hide();},_togglePrivacyFunc:function(){this._privacyActionController&&this._privacyActionController.togglePrivacy();},_renderFileUploader:function(){return (aa.createElement(xa,{className:"_37_x"},aa.createElement(l,{onFileUploaderMounted:this.props.onFileUploaderMounted,attachmentsShelf:this.props.attachmentsShelf,initFileUploaderFn:this._initFileUploader,onUploadFinished:this.props.onUploadFinished,onUpdateAttachmentsShelf:this.props.onUpdateAttachmentsShelf,onSubmit:this.props.onSubmit})));},_renderOpenFullConversation:function(){if(this.state.url)return (aa.createElement(xa,{onclick:(function(){return ra(this.state.url);}).bind(this)},qa._("Xem to\u00e0n b\u1ed9 cu\u1ed9c tr\u00f2 chuy\u1ec7n")));return null;},_renderAddFriend:function(){if(!this.props.showAddFriend)return null;var ab=la.is_work_user?qa._("Th\u00eam \u0111\u1ed3ng nghi\u1ec7p v\u00e0o Tr\u00f2 chuy\u1ec7n..."):qa._("Th\u00eam b\u1ea1n b\u00e8 v\u00e0o cu\u1ed9c tr\u00f2 chuy\u1ec7n...");return (aa.createElement(xa,{onclick:this.props.showAddFriend},ab));},_renderTogglePrivacy:function(){if(!this.props.isGroupChat&&this.state.privacyText)return (aa.createElement(xa,{onclick:this._togglePrivacyFunc},this.state.privacyText));return null;},_renderNotificationSettings:function(){if(oa.inGK){var ab=na.show.bind(null,this.props.threadID);return (aa.createElement(xa,{onclick:ab},qa._("C\u00e0i \u0111\u1eb7t th\u00f4ng b\u00e1o")));}return null;},_renderMuteConversation:function(){if(!this.props.isMuted){var ab=u.showMuteChangeDialog.bind(null,this.props.threadID,null);return (aa.createElement(xa,{onclick:ab},qa._("T\u1eaft \u00e2m cu\u1ed9c tr\u00f2 chuy\u1ec7n...")));}else return (aa.createElement(xa,{onclick:this._unmuteThread},qa._("B\u1eadt ti\u1ebfng cu\u1ed9c tr\u00f2 chuy\u1ec7n")));},_renderDeleteConversation:function(){return (aa.createElement(xa,{onclick:this._deleteConversation},qa._("X\u00f3a cu\u1ed9c tr\u00f2 chuy\u1ec7n...")));},_renderReportSpam:function(){if(!this.props.isGroupChat)return (aa.createElement(xa,{onclick:this._reportSpamClicked},qa._("B\u00e1o c\u00e1o l\u00e0 th\u01b0 r\u00e1c ho\u1eb7c l\u1ea1m d\u1ee5ng...")));return null;},_blockMessagesItem:function(){if(!this.props.isGroupChat&&s.gk_result&&!this.props.hasMessageBlocked)return (aa.createElement(xa,{onclick:this._messageBlockedClicked},qa._("Ch\u1eb7n tin nh\u1eafn...")));if(!this.props.isMultichat&&s.gk_result&&this.props.hasMessageBlocked)return (aa.createElement(xa,{onclick:this._messageUnblockedClicked},qa._("B\u1ecf ch\u1eb7n tin nh\u1eafn...")));return null;},_renderCreateGroup:function(){if(this.props.isGroupChat)return (aa.createElement(xa,{onclick:this._createGroupClicked},qa._("T\u1ea1o nh\u00f3m")));return null;},_renderSwitchToWork:function(){if(this.props.hasSwitchToWork)return (aa.createElement(xa,{onclick:this._switchToWorkUserClicked},qa._("Chuy\u1ec3n sang t\u00e0i kho\u1ea3n Work")));return null;},_renderConversationName:function(){if(this.props.isGroupChat&&this.state.url)return (aa.createElement(xa,{onclick:this.props.nameConversationFunc},qa._("Ch\u1ec9nh s\u1eeda t\u00ean cu\u1ed9c tr\u00f2 chuy\u1ec7n")));return null;},_renderLeaveConversation:function(){if(this.props.isGroupChat)return (aa.createElement(xa,{onclick:this._unsubscribeLinkClicked},qa._("R\u1eddi kh\u1ecfi cu\u1ed9c tr\u00f2 chuy\u1ec7n...")));return null;},_renderEnableDesktopNotifications:function(){if(p.DesktopNotificationsGK&&"Notification" in window&&window.Notification.permission!=="granted")return (aa.createElement(xa,{onclick:this._enableDesktopNotif},qa._("Enable Desktop Notifications")));return null;},_renderPeopleList:function(){if(this.props.isGroupChat&&this.state.url)return (aa.createElement(xa,{onclick:this._showParticipants},qa._("Ch\u1ec9nh s\u1eeda ng\u01b0\u1eddi tham gia...")));return null;},_renderToggleSecretMode:function(){if(!k.get('enable_secret_mode'))return null;if(this.props.hasSecretModeOn){return (aa.createElement(xa,{onclick:this._secretModeTurnOff},qa._("Turn off secret mode...")));}else return (aa.createElement(xa,{onclick:this._secretModeTurnOn},qa._("Turn on secret mode...")));},render:function(){var ab=this._renderReportSpam(),bb=this._blockMessagesItem(),cb=this._renderCreateGroup(),db=aa.createElement(ca,{className:"chatReact"+(!this.props.show?' '+"hidden_elem":'')},this._renderOpenFullConversation(),ma.canUploadFiles?this._renderFileUploader():null,this._renderToggleSecretMode(),this._renderAddFriend(),this._renderTogglePrivacy(),this._renderConversationName(),this._renderPeopleList(),aa.createElement(da,null),this._renderNotificationSettings(),this._renderSwitchToWork(),this._renderMuteConversation(),this._renderDeleteConversation(),this._renderLeaveConversation(),ab||bb?aa.createElement(da,null):null,bb,ab,cb?aa.createElement(da,null):null,cb,this._renderEnableDesktopNotifications()),eb=qa._("T\u00f9y ch\u1ecdn"),fb=ga.getTrackingInfo(ga.types.DROPDOWN_BUTTON);return (aa.createElement(ba,{menu:db},aa.createElement('a',{'data-ft':fb,'data-hover':'tooltip','aria-label':eb,'data-tooltip-alignh':'center',className:"button"+(this.props.isEmptyChat?' '+"hidden_elem":'')})));},getFileUploaderPromise:function(){return this._fileUploaderPromise;},_updatePrivacyLink:function(ab){var bb;if(ab==m.OFFLINE){bb=qa._("Chuy\u1ec3n sang tr\u1ef1c tuy\u1ebfn");this.setState({privacyText:bb});return;}if(this.props.isGroupChat||this.props.otherUserID===undefined)return;var cb='fbid:'.concat(this.props.otherUserID);t.get(cb,(function(db){if(!db.is_friend){bb=null;}else if(ab==m.BLOCKED){bb=qa._("B\u1eadt tr\u00f2 chuy\u1ec7n v\u1edbi {name}",[qa.param('name',db.short_name)]);}else bb=qa._("T\u1eaft tr\u00f2 chuy\u1ec7n v\u1edbi {name}",[qa.param('name',db.short_name)]);this.setState({privacyText:bb});}).bind(this));},_showParticipants:function(){ta.getServerIDFromClientID(this.props.threadID,function(ab){h.send(new i(new ha('/ajax/browser/dialog/multichat_members/').addQueryData({id:ab})));});},_unsubscribeLinkClicked:function(){var ab=[];ab.push({name:'unsubscribe',label:qa._("R\u1eddi cu\u1ed9c tr\u00f2 chuy\u1ec7n"),handler:(function(){return this._unsubscribeToThread();}).bind(this)});ab.push(o.CANCEL);new o().setTitle(qa._("R\u1eddi cu\u1ed9c tr\u00f2 chuy\u1ec7n?")).setBody(qa._("B\u1ea1n s\u1ebd ng\u1eebng nh\u1eadn \u0111\u01b0\u1ee3c tin nh\u1eafn t\u1eeb cu\u1ed9c tr\u00f2 chuy\u1ec7n n\u00e0y v\u00e0 m\u1ecdi ng\u01b0\u1eddi s\u1ebd th\u1ea5y b\u1ea1n r\u1eddi \u0111i.")).setButtons(ab).show();},_unsubscribeToThread:function(){if(!va.isEmptyLocalThread(this.props.threadID)){var ab=sa.constructLogMessageObject(w.CHAT_WEB,this.props.threadID,r.UNSUBSCRIBE,{removed_participants:[v.getID()]});wa.send(ab);}n.closeTab(this.props.threadID,'unsubscribed');return true;},_deleteConversation:function(){ia.show(this.props.threadID);},_reportSpamClicked:function(){var ab=new ha('/ajax/chat/report.php').addQueryData({id:this.props.otherUserID}).addQueryData({src:'top_report_link'});if(x.result)ab=ka.getURIBuilder().setString('thread_fbid',this.props.otherUserID).setEnum('location','www_chat_head').getURI();h.send(new i(ab));},_messageBlockedClicked:function(){ua.blockMessages(this.props.threadID);},_messageUnblockedClicked:function(){ua.unblockMessages(this.props.threadID);},_secretModeTurnOff:function(){ua.turnOffSecretMode(this.props.threadID);},_secretModeTurnOn:function(){ua.turnOnSecretMode(this.props.threadID);},_createGroupClicked:function(){va.getThreadMeta(this.props.threadID,function(ab){if(!ab.is_canonical){var bb=new ha('/ajax/groups/create_get.php').addQueryData({ref:'web_messenger_dock',parent_id:'0'}),cb=ab.participants.map(function(db){return q.getUserIDFromParticipantID(db);}).filter(function(db){return db;});bb.addQueryData({members:cb});if(ab.name)bb.addQueryData({name:ab.name});h.send(new i(bb));}});},_switchToWorkUserClicked:function(){var ab=[];ab.push({name:'move',label:qa._("Chuy\u1ec3n cu\u1ed9c tr\u00f2 chuy\u1ec7n"),handler:(function(){return this._switchToWork();}).bind(this)});ab.push(o.CANCEL);new o().setTitle(qa._("Chuy\u1ec3n cu\u1ed9c tr\u00f2 chuy\u1ec7n sang t\u00e0i kho\u1ea3n c\u00f4ng vi\u1ec7c?")).setBody(qa._("B\u1ea1n c\u00f3 mu\u1ed1n chuy\u1ec3n cu\u1ed9c tr\u00f2 chuy\u1ec7n n\u00e0y \u0111\u1ec3 cu\u1ed9c tr\u00f2 chuy\u1ec7n hi\u1ec3n th\u1ecb trong t\u00e0i kho\u1ea3n c\u00f4ng vi\u1ec7c c\u1ee7a m\u00ecnh kh\u00f4ng?")).setButtons(ab).show();},_switchToWork:function(){if(!va.isEmptyLocalThread(this.props.threadID)){var ab=sa.constructLogMessageObject(w.CHAT_WEB,this.props.threadID,r.SWITCH_TO_WORK,{removed_participants:[v.getID()]});wa.send(ab);}n.closeTab(this.props.threadID,'unsubscribed');return true;},_enableDesktopNotif:function(){b.Notification.requestPermission();}});f.exports=za;},null);
__d('ChatTabSheetListener',['ChatPrivacyActionController','MercuryIDs','MercuryParticipants','MercuryThreadInformer','MercuryThreads','MercuryViewer'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();function n(o,p){this.$ChatTabSheetListener1=p;this.$ChatTabSheetListener2=o;this.$ChatTabSheetListener3=i.getUserIDFromThreadID(this.$ChatTabSheetListener2);k.get().subscribe('threads-updated',(function(){return this.$ChatTabSheetListener4();}).bind(this));if(this.$ChatTabSheetListener3)this.$ChatTabSheetListener5=new h(this.$ChatTabSheetListener3,(function(q){return this.$ChatTabSheetListener6(q);}).bind(this));}n.prototype.destroy=function(){this.$ChatTabSheetListener5&&this.$ChatTabSheetListener5.destroy();};n.prototype.$ChatTabSheetListener4=function(){var o=l.get();o.getThreadMeta(this.$ChatTabSheetListener2,(function(p){var q=m.getID(),r=p.participants.filter(function(s){return s!==q;});r.length<1&&!o.isNewEmptyLocalThread(this.$ChatTabSheetListener2)?this.$ChatTabSheetListener1.openNoRecipientsSheet():this.$ChatTabSheetListener1.closeNoRecipientsSheet();}).bind(this));};n.prototype.$ChatTabSheetListener6=function(o){switch(o){case h.OFFLINE:this.$ChatTabSheetListener1.closeUserBlockedSheet();this.$ChatTabSheetListener1.openOfflineSheet();break;case h.NORMAL:this.$ChatTabSheetListener1.closeUserBlockedSheet();this.$ChatTabSheetListener1.closeOfflineSheet();break;case h.BLOCKED:this.$ChatTabSheetListener1.closeOfflineSheet();j.get(i.getParticipantIDFromUserID(this.$ChatTabSheetListener3),(function(p){p.is_friend?this.$ChatTabSheetListener1.openUserBlockedSheet():this.$ChatTabSheetListener1.closeUserBlockedSheet();}).bind(this));break;}};f.exports=n;},null);
__d('ChatTabSheetController',['Bootloader','ChatTabSheetListener','Deferred','MercuryIDs'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=function(m,n,o,p){this._threadID=m;this._rootElement=n;this._tabElement=o;this._view=p;this._deferred=new j();this._isLoading=false;this._listener=new i(this._threadID,this);};Object.assign(l.prototype,{openAddFriendsSheet:function(){this._load((function(){this._addFriendsTabSheet.open();}).bind(this));},openMessageBlockedTabSheet:function(){this._load((function(){this._threadIsMessageBlockedSheet.open();}).bind(this));},getAddFriendsParticipants:function(){return this._addFriendsTabSheet?this._addFriendsTabSheet.getParticipants():[];},openNameConversationSheet:function(m){this._load((function(){this._nameConversationTabSheet.open(m);}).bind(this));},openReadOnlySheet:function(){this._load((function(){this._readOnlyTabSheet.open();}).bind(this));},openNewMessagesSheet:function(){this._load((function(){this._newMessagesTabSheet.open();}).bind(this));},openUploadWarningTabSheet:function(){this._load((function(){this._uploadWarningTabSheet.open();}).bind(this));},openThreadIsMutedTabSheet:function(){this._load((function(){this._threadIsMutedTabSheet.open();}).bind(this));},openEmployeeAwaySheet:function(){this._load((function(){this._employeeAwaySheet.open();}).bind(this));},openOfflineSheet:function(){this._load((function(){this._offlineTabSheet.open();}).bind(this));},openUserBlockedSheet:function(){this._load((function(){this._userBlockedTabSheet.open();}).bind(this));},openNoRecipientsSheet:function(){this._load((function(){this._noRecipientsTabSheet.open();}).bind(this));},openSecretModeSheet:function(){this._load((function(){this._secretModeSheet.open();}).bind(this));},closeAddFriendsSheet:function(){this._lazy((function(){this._addFriendsTabSheet.close();}).bind(this));},closeAutomaticNameConversationSheet:function(){this._lazy((function(){if(this._nameConversationTabSheet&&this._nameConversationTabSheet.isAutomatic())this._nameConversationTabSheet.close();}).bind(this));},closeMessageBlockedTabSheet:function(){this._lazy((function(){this._threadIsMessageBlockedSheet.close();}).bind(this));},closeThreadIsMutedTabSheet:function(){this._lazy((function(){this._threadIsMutedTabSheet.close();}).bind(this));},closeNewMessagesSheet:function(){this._lazy((function(){this._newMessagesTabSheet.close();}).bind(this));},closeUploadWarningTabSheet:function(){this._lazy((function(){this._uploadWarningTabSheet.close();}).bind(this));},closeOfflineSheet:function(){this._lazy((function(){this._offlineTabSheet.close();}).bind(this));},closeUserBlockedSheet:function(){this._lazy((function(){this._userBlockedTabSheet.close();}).bind(this));},closeSecretModeSheet:function(){this._lazy((function(){this._secretModeSheet.close();}).bind(this));},onClickMessagesBlockedSheet:function(m){this._lazy((function(){this._unblockMessagesSub=this._threadIsMessageBlockedSheet.subscribe('clicked',m);}).bind(this));},closeNoRecipientsSheet:function(){this._lazy((function(){this._noRecipientsTabSheet.close();}).bind(this));},onClickNewMessagesSheet:function(m){this._lazy((function(){this._newMessageClickSub=this._newMessagesTabSheet.subscribe('clicked',m);}).bind(this));},onClickThreadIsMutedSheet:function(m){this._lazy((function(){this._threadIsMutedClickSub=this._threadIsMutedTabSheet.subscribe('clicked',m);}).bind(this));},onClickSecretModeSheet:function(m){this._lazy((function(){this._secretModeClickSub=this._secretModeSheet.subscribe('clicked',m);}).bind(this));},onResize:function(m){this._lazy((function(){this._sheetView.subscribe('resize',m);}).bind(this));},onTokensChanged:function(m){this._lazy((function(){this._addFriendsTabSheet.subscribe('chat/tokens-changed',m);}).bind(this));},onEscape:function(m){this._lazy((function(){this._addFriendsTabSheet.subscribe('esc-pressed',m);}).bind(this));},destroy:function(){this._listener&&this._listener.destroy();this._sheetView&&this._sheetView.destroy();this._offlineTabSheet&&this._offlineTabSheet.destroy();this._userBlockedTabSheet&&this._userBlockedTabSheet.destroy();this._newMessageClickSub&&this._newMessageClickSub.unsubscribe();this._threadIsMutedClickSub&&this._threadIsMutedClickSub.unsubscribe();},_load:function(m){this._bootload();this._deferred.then(m);},_lazy:function(m){this._deferred.then(m);},_bootload:function(){if(this._isLoading)return;this._isLoading=true;h.loadModules(["ChatAddFriendsTabSheet","ChatEmployeeAwaySheet","ChatNameConversationTabSheet","ChatNewMessagesTabSheet","ChatNoRecipientsTabSheet","ChatOfflineTabSheet","ChatReadOnlyTabSheet","ChatThreadIsMessageBlockedSheet","ChatThreadIsMutedTabSheet","ChatThreadSecretModeSheet","ChatUploadWarningTabSheet","ChatUserBlockedTabSheet","MercurySheetView"],(function(m,n,o,p,q,r,s,t,u,v,w,x,y){this._sheetView=new y(this._threadID,this._rootElement,this._tabElement);var z=this._threadID,aa=this._rootElement,ba=this._sheetView,ca=this._view;this._addFriendsTabSheet=new m(z,aa,ba,ca);this._employeeAwaySheet=new n(z,aa,ba);this._nameConversationTabSheet=new o(z,aa,ba);this._newMessagesTabSheet=new p(z,aa,ba);this._offlineTabSheet=new r(z,aa,ba);this._readOnlyTabSheet=new s(z,aa,ba);this._threadIsMessageBlockedSheet=new t(z,aa,ba);this._threadIsMutedTabSheet=new u(z,aa,ba);this._secretModeSheet=new v(z,aa,ba);this._uploadWarningTabSheet=new w(z,aa,ba);this._userBlockedTabSheet=new x(z,aa,ba);if(!k.getUserIDFromThreadID(this._threadID))this._noRecipientsTabSheet=new q(z,aa,ba);this._deferred.resolve();}).bind(this));}});f.exports=l;},null);
__d('ChatTitleLink.react',['Link.react','MercuryThreadTitle.react','React','TrackingNodes','cx'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();var m=j.PropTypes,n=j.createClass({displayName:'ChatTitleLink',propTypes:{href:m.string,isNewThread:m.bool,thread:m.object,viewer:m.string},getDefaultProps:function(){return {href:null};},getTitle:function(){return this.refs.threadTitle.getTitle();},render:function(){if(!this.props.thread)return null;return (j.createElement(h,{'aria-level':'3',className:"titlebarText"+(this.props.href===null?' '+"noLink":''),'data-ft':k.getTrackingInfo(k.types.TITLE),'data-hover':'tooltip',href:this.props.href},j.createElement(i,{ref:'threadTitle',isNewThread:this.props.isNewThread,thread:this.props.thread,useAndSeparator:true,useShortName:!this.props.thread.is_canonical,viewer:this.props.viewer})));}});f.exports=n;},null);
__d('ChatVideoCallButton.react',['Link.react','React','TrackingNodes','FBRTCCallabilityStore','StoreAndPropBasedStateMixin','MercuryIDs','MercuryParticipants','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){'use strict';if(c.__markCompiled)c.__markCompiled();var p=i.PropTypes,q=i.createClass({displayName:'ChatVideoCallButton',mixins:[l(k,n)],statics:{calculateState:function(r){var s=m.getParticipantIDFromUserID(r.userID),t=n.getOrFetch(s);return {user:t,isCallable:k.isCallable(r.userID)};}},propTypes:{onClick:p.func,onKeyUp:p.func,shown:p.bool,isAudio:p.bool},getClassName:function(){return (!this.props.isAudio?"_1fu3":'')+(this.props.isAudio?' '+"_1fu4":'')+(this.state.isCallable?' '+"_1kza":'')+(' '+"button")+(!this.props.shown?' '+"hidden_elem":'');},getTooltipLabel:function(){var r=this.state.user;if(!r)return undefined;if(this.props.isAudio){return k.voiceCallButtonTooltip(this.props.userID,r.short_name);}else return k.callButtonTooltip(this.props.userID,r.short_name);},render:function(){var r=j.getTrackingInfo(this.props.isAudio?j.types.VIDEOCHAT:j.types.VOICECHAT),s=JSON.stringify({videochat:'call_clicked_bhat_tab'});return (i.createElement(h,{'aria-label':this.getTooltipLabel(),className:this.getClassName(),'data-ft':r,'data-gt':s,'data-hover':'tooltip','data-tooltip-position':'above',onClick:this.props.onClick,onKeyUp:this.props.onKeyUp}));}});f.exports=q;},null);
__d('MessengerHotLikeButton.react',['Image.react','ImmutableObject','Keys','KeyStatus','Link.react','MercurySourceType','MessengerHotLikePreviewEvents','MessengerHotLikeUtils','ReactComponentWithPureRenderMixin','React','StickerActions','StickerConstants','cx','fbt','MercuryMessageObject'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){'use strict';if(c.__markCompiled)c.__markCompiled();var v=c('MercuryMessageObject').get(),w=q.PropTypes,x=q.createClass({displayName:'MessengerHotLikeButton',mixins:[p],propTypes:{onMouseDown:w.func,customLike:w.string,sendSticker:w.func.isRequired,threadID:w.string,disabled:w.bool},_popTimeout:null,_pressedSince:null,_subscription:null,componentDidMount:function(){this._subscription=n.addListener(n.FINISH_ANIMATION,(function(y,z){if(y===this.props.threadID)this.props.sendSticker(z);}).bind(this));},componentWillUnmount:function(){this._subscription&&this._subscription.remove();},render:function(){if(this.props.customLike)return (q.createElement(l,{'aria-label':u._("G\u1eedi l\u01b0\u1ee3t th\u00edch"),className:this.props.className,disabled:this.props.disabled,onClick:this._handleClickEvent,onMouseDown:this._handleMouseDown,onMouseLeave:this._cancelSend,onMouseUp:this._handleMouseUp,role:'button',title:u._("G\u1eedi l\u01b0\u1ee3t th\u00edch")},q.createElement('i',{className:"_1l48 _30yy"},q.createElement(h,{src:this.props.customLike}))));return (q.createElement(l,{'aria-label':u._("G\u1eedi l\u01b0\u1ee3t th\u00edch"),className:this.props.className,disabled:this.props.disabled,onClick:this._handleClickEvent,onMouseDown:this._handleMouseDown,onMouseLeave:this._cancelSend,onMouseUp:this._handleMouseUp,role:'button',title:u._("G\u1eedi l\u01b0\u1ee3t th\u00edch")},q.createElement('i',{className:"_2y9i _30yy"})));},_handleMouseDown:function(y){if(this.props.disabled||this._pressedSince){y.preventDefault();y.stopPropagation();}if(this.props.disabled||y.button!==0)return;r.hideStickerTray();this.props.onMouseDown&&this.props.onMouseDown();if(this.props.customLike||!this.props.threadID)return;this._pressedSince=Date.now();this._informPreviewStart();this._preparePop();},_handleMouseUp:function(){if(!(this.props.threadID&&this._pressedSince))return;this._pressedSince=0;this._cancelPop();this._informPreviewStop();},_informPreviewStart:function(){n.emit(n.START,this._getFakeMessage(),this.props.threadID);},_informPreviewStop:function(){n.emit(n.STOP,this.props.threadID);},_informPreviewPop:function(){n.emit(n.POP,this.props.threadID);},_getFakeMessage:function(){var y=v.constructStickerMessageObject(s.HOT_LIKE_SMALL_STICKER_ID,m.MESSENGER_WEB,this.props.threadID);v.normalizeNewMessage(y);y.is_like_preview=true;y.like_preview_since=this._pressedSince;y.body='';return new i(y);},_preparePop:function(){this._cancelPop();this._popTimeout=setTimeout(this._informPreviewPop,o.SizeTimes.large);},_cancelSend:function(){if(this._pressedSince){this._pressedSince=0;this._cancelPop();this._informPreviewPop();}},_cancelPop:function(){clearTimeout(this._popTimeout);},_handleClickEvent:function(y){y.stopPropagation();if(this.props.disabled)return;if(k.getKeyDownCode()===j.RETURN||this.props.customLike||!this.props.threadID)this.props.sendSticker(o.getStickerIDForTime(1));}});f.exports=x;},null);
__d('P2PSendMoneyDialogStore',['P2PActionConstants','EventEmitter','P2PDispatcher'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k,l;'use strict';var m,n;k=babelHelpers.inherits(o,i);l=k&&k.prototype;function o(){l.constructor.call(this);n={};m=j.register(this.onEventDispatched.bind(this));}o.prototype.onEventDispatched=function(p){var q=p.data,r=p.type;switch(r){case h.CHAT_SEND_VIEW_OPENED:this.handleChatSendViewOpened(q);this.emit('change');break;case h.CHAT_SEND_VIEW_CLOSED:this.handleChatSendViewClosed(q);this.emit('change');break;}};o.prototype.getStateByThreadID=function(p){return n[p];};o.prototype.handleChatSendViewOpened=function(p){n[p.threadID]={amount:p.amount,groupSendRecipient:p.groupSendRecipient,groupSendReceiptDetails:p.groupSendReceiptDetails,groupThreadFBID:p.groupThreadFBID,platformData:p.platformData,referrer:p.referrer,sendMoneyDialogShown:true};};o.prototype.handleChatSendViewClosed=function(p){n[p.threadID]={amount:'',groupSendRecipient:null,groupSendReceiptDetails:null,groupThreadFBID:'',platformData:null,referrer:null,sendMoneyDialogShown:false};};f.exports=new o();},null);
__d("XPagesMercuryIndicatorController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/pages\/messaging\/mercury\/indicator\/",{});},null,{});
__d('PagesMercuryChatTabIndicatorHandler',['Animation','AsyncRequest','AvailableListConstants','DOM','FBID','MercuryIDs','XPagesMercuryIndicatorController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();o.tryCreateHandler=function(p,q,r){'use strict';if(!q)return null;var s=m.getUserIDFromThreadID(p);if(!s||l.isUser(s))return null;return new o(s,q,r);};function o(p,q,r){'use strict';this.$PagesMercuryChatTabIndicatorHandler1=false;this.$PagesMercuryChatTabIndicatorHandler2=q;this.$PagesMercuryChatTabIndicatorHandler3=false;this.$PagesMercuryChatTabIndicatorHandler4=false;this.$PagesMercuryChatTabIndicatorHandler5=r;this.$PagesMercuryChatTabIndicatorHandler6=false;this.$PagesMercuryChatTabIndicatorHandler7=p;}o.prototype.__getEnableTimeSwitch=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler1;};o.prototype.__getIndicator=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler2;};o.prototype.__getIsShown=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler4;};o.prototype.__getPageOnlineStatus=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler5;};o.prototype.__getShouldPreventFutureShown=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler6;};o.prototype.__getTargetID=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler7;};o.prototype.__getIsChecking=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler3;};o.prototype.__getResponsivenessDescription=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler8;};o.prototype.checkResponsiveness=function(){'use strict';if(this.$PagesMercuryChatTabIndicatorHandler3)return;var p=n.getURIBuilder().getURI();this.$PagesMercuryChatTabIndicatorHandler3=true;new i().setURI(p).setMethod('POST').setData({page_id:this.$PagesMercuryChatTabIndicatorHandler7}).setHandler((function(q){this.$PagesMercuryChatTabIndicatorHandler3=false;var r=q.payload;if(r.responsiveness)this.$PagesMercuryChatTabIndicatorHandler9(r.responsiveness,r.enableTimeSwitch);}).bind(this)).send();};o.prototype.hideIndicator=function(){'use strict';this.$PagesMercuryChatTabIndicatorHandler10(false);};o.prototype.hideIndicatorAndPreventFutureShow=function(){'use strict';this.$PagesMercuryChatTabIndicatorHandler10(true);};o.prototype.$PagesMercuryChatTabIndicatorHandler10=function(p){'use strict';this.$PagesMercuryChatTabIndicatorHandler6=this.$PagesMercuryChatTabIndicatorHandler6||p;if(this.$PagesMercuryChatTabIndicatorHandler2&&this.$PagesMercuryChatTabIndicatorHandler4){this.$PagesMercuryChatTabIndicatorHandler4=false;new h(this.$PagesMercuryChatTabIndicatorHandler2).to('height',0).duration(100).hide().go();}};o.prototype.showIndicator=function(){'use strict';if(!this.$PagesMercuryChatTabIndicatorHandler2||this.$PagesMercuryChatTabIndicatorHandler4||this.$PagesMercuryChatTabIndicatorHandler5!==j.OFFLINE||!this.$PagesMercuryChatTabIndicatorHandler8||this.$PagesMercuryChatTabIndicatorHandler6)return;k.setContent(this.$PagesMercuryChatTabIndicatorHandler2,this.$PagesMercuryChatTabIndicatorHandler8);this.$PagesMercuryChatTabIndicatorHandler4=true;new h(this.$PagesMercuryChatTabIndicatorHandler2).show().to('height',16).duration(100).go();};o.prototype.notifyPageOnlineStatusChanged=function(p){'use strict';if(this.$PagesMercuryChatTabIndicatorHandler5===p)return;this.$PagesMercuryChatTabIndicatorHandler5=p;if(!this.$PagesMercuryChatTabIndicatorHandler1)return;switch(p){case j.ACTIVE:this.hideIndicator();break;default:this.showIndicator();break;}};o.prototype.$PagesMercuryChatTabIndicatorHandler9=function(p,q){'use strict';this.$PagesMercuryChatTabIndicatorHandler8=p;this.$PagesMercuryChatTabIndicatorHandler1=q;this.showIndicator();};f.exports=o;},null);
__d("XStickerReplyNUXController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/tooltip\/",{});},null,{});
__d('ChatTabView',['AsyncRequest','AsyncSignal','AvailableList','AvailableListConstants','BanzaiODS','BootloadedComponent.react','Bootloader','CSS','ChatAddToThreadButton.react','ChatArchiveWarning.react','ChatBehavior','ChatCloseButton.react','ChatConfig','ChatEmployeeAwayWarning','ChatNubLogger','ChatOpenTab','ChatPhotoUploader.react','ChatQuietLinks','ChatStickerButton.react','ChatTabActions','ChatTabMenu.react','ChatTabMessagesView','ChatTabOfficeStatus','ChatTabSheetController','ChatTabViewEvents','ChatTabViewInstances','ChatTitleLink.react','ChatVideoCallButton.react','ChatVisibility','MercuryConstants','CurrentLocale','CurrentUser','DOM','DOMEvent','DOMQuery','Dialog','Dock','DragDropTarget','EmoticonUtils','EmoticonsList','Event','FBID','FBRTCCallabilityStore','Focus','ImmutableObject','Input','JSResource','Keys','Locale','LogHistory','MercuryConfig','MercuryIDs','MercuryMessengerBlockingUtils','MercuryParticipants','MercuryShareAttachmentRenderLocations','MercurySourceType','MercuryThreadInfo','MercuryTypingAnimation.react','MercuryThreadTitle.react','MercuryViewer','MessengerHotLikeButton.react','MessagingTag','NubController','P2PGKValues','P2PSendMoneyDialogStore','PagesMercuryChatTabIndicatorHandler','Parent','PhotosUploadWaterfall','PresenceStatus','Promise','React','ReactDOM','ReactComponentRenderer','Run','Scroll','SelectionPosition','ShortProfiles','StickerActions','StickerConstants','StickerState','Style','SubscriptionsHandler','SyntheticMouseEvent','ChatTabTemplates','TextAreaControl','TooltipData','TypingDetectorController','URLScraper','URI','UserAgent_DEPRECATED','WaterfallIDGenerator','WebMessengerDeleteThreadDialog','WebMessengerThreadPermalinks','WorkFileUploadsGating','WorkModeConfig','XStickerReplyNUXController','cancelAnimationFrame','createCancelableFunction','csx','cx','emptyFunction','fbt','getActiveElement','isEmpty','requestAnimationFrame','setIntervalAcrossTransitions','ChatReactInput','MercuryBlockedParticipants','MercuryTypingReceiver','MercuryMessageActions','MercuryMessages','MercuryMessageObject','MercuryThreadIDMap','MercuryServerRequests','MercuryThreadInformer','MercuryThreadActions','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc,qc,rc,sc,tc,uc,vc,wc,xc,yc,zc,ad,bd,cd,dd,ed,fd,gd,hd,id){'use strict';if(c.__markCompiled)c.__markCompiled();var jd=c('ChatReactInput').module,kd=c('MercuryBlockedParticipants').get(),ld=c('MercuryTypingReceiver').get(),md=c('MercuryMessageActions').get(),nd=c('MercuryMessages').get(),od=c('MercuryMessageObject').get(),pd=c('MercuryThreadIDMap').get(),qd=c('MercuryServerRequests').get(),rd=c('MercuryThreadInformer').get(),sd=c('MercuryThreadActions').get(),td=c('MercuryThreads').get(),ud=/^\s*$/,vd=ga,wd,xd=10,yd=960,zd=eb.getInstance('chat_tab_view');function ae(we,xe){var ye=na.create('div');xe=xe&&xe.filter(function(bf){return bf!=ob.getID();});if(gd(xe))return oc.remove(we);var ze=xe.length,af=ze-xd;if(af>1)xe=xe.slice(0,xd);ib.getMulti(xe,function(bf){for(var cf in bf){var df=bf[cf],ef=mc[':fb:mercury:chat:multichat-tooltip-item'].build();na.setContent(ef.getNode('name'),df.name);var ff=gb.getUserIDFromParticipantID(cf),gf=ff&&xb.get(ff)==k.ACTIVE;o.conditionShow(ef.getNode('icon'),gf);o.conditionClass(ef.getNode('name'),'tooltipItemWithIcon',gf);na.appendContent(ye,ef.getRoot());}if(af>1){var hf=ed._("v\u00e0 th\u00eam {number of hidden chat participants}.",[ed.param('number of hidden chat participants',af)]);na.appendContent(ye,na.create('div',{},hf));}oc.set(we,ye,'above');});}var be={},ce=null,de=false;function ee(we,xe,ye){if(ye){be[we]=xe;if(!ce)ce=id(fe,600);}else{o.removeClass(xe,'highlightTitle');delete be[we];}}function fe(){for(var we in be){var xe=be[we];if(xe.parentNode){o.conditionClass(xe,'highlightTitle',de);}else delete be[we];}de=!de;if(!Object.keys(be).length){clearInterval(ce);ce=null;}}function ge(we){var xe=gb.tokenize(we);switch(xe.type){case 'user':return mc[':fb:mercury:chat:user-tab'].build();}return mc[':fb:mercury:chat:multichat-tab'].build();}function he(we){var xe=we._getInputValue(),ye=we._fileUploader,ze=ye?ye.getAttachments():[];if(ne(we))je(we,xe,ze,function(af){af=ve(af,ye);md.send(af,function(bf){var cf=td.getThreadMetaNow(bf);if(fb.CoreGraphEnabled&&cf&&cf.folder===qb.PENDING)sd.movePendingToInbox(bf);});ye&&ye.removeAttachments();if(we._sharePreview)we._sharePreview.setProps({share:null,uri:null});if(!t.get('chat_react_input'))we._getNode('input').value='';we._typingDetector&&we._typingDetector.resetState();we._messagesView&&we._messagesView.setShouldScrollToBottom(true);});}function ie(we,xe){if(xe===0)return;pe(we,wb.POST_PUBLISHED,{count:xe});we._waterfallID=tc.generate();}function je(we,xe,ye,ze){td.getThreadMeta(we._threadID,function(af){if(af&&af.is_canonical&&!lb.canReply(af)&&hb.gk_result){we._showMessageBlockedDialog(af);return;}var bf=kb.CHAT_WEB,cf=od.constructUserGeneratedMessageObject(xe,bf,we._threadID);if(ye.length>0){cf.has_attachment=true;cf.raw_attachments=ye;}if(we._sharePreview){var df=we._sharePreview.component.getShareData();if(df){cf.has_attachment=true;cf.shareable_attachment=df;}}if(td.isNewEmptyLocalThread(we._threadID)){var ef=we._sheetController.getAddFriendsParticipants();we._sheetController.closeAddFriendsSheet();if(ef===null||ef.length===0)return;ef=ef.filter(function(hf){return hf!=ob.getID();});if(ef.length===0){cf.thread_id=gb.getThreadIDFromUserID(ma.getID());}else if(ef.length===1){cf.thread_id=gb.getThreadIDFromParticipantID(ef[0]);}else sd.addParticipants(we._threadID,ef);}if(td.isEmptyLocalThread(we._threadID)){cf.offline_threading_id=gb.tokenize(we._threadID).value;var ff=td.getThreadMetaNow(af.thread_id);cf.specific_to_list=Array.from(ff.participants);}if(typeof cf!='undefined')cf.signatureID=we._signatureID;cf.ui_push_phase=ka.UIPushPhase;ze(cf);if(we._threadID!==cf.thread_id&&!we._photoUploader.isUploading()){var gf=we._getInputValue();aa.closeTab(we._threadID);w.openThread(cf.thread_id,'ChatTabView',null,xe?dd:function(hf){return hf.appendTextToInput(gf);});}});}function ke(we){we._blocked=true;we._sheetController.openUploadWarningTabSheet();}function le(we){return !!(we._fileUploader&&(we._fileUploader.isUploading()||we._photoUploader.isUploading()||we._sharePreview&&we._sharePreview.component.isLoading()));}function me(we){return (we._fileUploader&&we._fileUploader.isUploading()||we._sharePreviewLoading);}function ne(we){var xe=we._getInputValue();if(!ud.test(xe))return true;if(we._fileUploader&&(we._fileUploader.getAttachments().length>0||we._fileUploader.getImageFiles().length>0||we._fileUploader.getAnimatedImageFiles().length>0||we._fileUploader.getVideoFiles().length>0||we._fileUploader.getAudioFiles().length>0||we._fileUploader.getFiles().length>0))return true;if(we._sharePreview&&we._sharePreview.component.getShareData())return true;return false;}function oe(we){we._nubController.flyoutContentChanged();var xe=we._getNode('attachmentShelf');dc.setTop(xe,xe.scrollHeight);}function pe(we,xe,ye){wb.sendSignal(babelHelpers._extends({qn:we._waterfallID,step:xe,uploader:wb.APP_CHAT},ye||{}));}function qe(we,xe,ye,ze,af){if(xe)qd.ensureThreadIsFetched(xe);this._threadID=we;this._signatureID=ye;this._eventListeners=[];this._onlineStatus=k.OFFLINE;this._tabTemplate=ge(we);this._tabElem=this._tabTemplate.getRoot();if(af&&af.getTabElem()){this.insertBefore(af);}else this.appendTo(ze);this._stickersFlyoutShown=false;this._messagesView=null;this._titlebar=this._getNode('nubFlyoutTitlebar');this._iconsContainerNode=this._getNode('iconsContainer');this._inputContainerNode=this._getNode('inputContainer');this._contentSearchNode=this._getNode('contentSearchContainer');this._emojiSearchNode=this._getNode('emojiSearchContainer');this._fileUploaderNode=this._getNode('fileUploaderContainer');this._pagesMessageIndicator=this._getNode('pagesMessageIndicator');this._waterfallID=tc.generate();this._subscriptionsHandler=new kc();var bf=pa.scry(this._tabElem,"._8ms");this._isTwoLine=bf&&bf.length>0;this._initializeSheetController();var cf=[dd,this._initializeComposer.bind(this),this._initializeHotLike.bind(this),this._initializeHeader.bind(this),this._initializeUIListeners.bind(this),this._initializeAutoSendPhotoUploader.bind(this),this._initializeAutoSendFileUploader.bind(this),this._initializeTitleHREF.bind(this),this._initializeInput.bind(this),this._initializeStickers.bind(this),(function(){td.getThreadMeta(this._threadID,(function(kf){this._updateMutingSettings(kf);this._updateMessageBlockSettings(kf);this._updateSecretModeSettings(kf);}).bind(this));y.removeEmptyHrefs(this._tabElem);}).bind(this),(function(){this.updateAvailableStatus();this.updateTab();this._setCloseTooltip(false);}).bind(this),this._initializeUnloadListeners.bind(this),this._initializeDragDropTarget.bind(this),this._initializePageMessagingIndicator.bind(this),this._initializeP2P.bind(this),this._initializeP2PChatThreadBannerContainer.bind(this),this._initializeContentSearch.bind(this),this._initializeEmojiSearch.bind(this)];if(t.get('chat_defer_initialization',false)){var df=(function(kf){if(!kf.length){delete this._initFrame;return;}var lf=kf.shift();this._initFrame=hd(function(){df(kf);});lf();}).bind(this);df(cf);}else for(var ef=cf,ff=Array.isArray(ef),gf=0,ef=ff?ef:ef[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var hf;if(ff){if(gf>=ef.length)break;hf=ef[gf++];}else{gf=ef.next();if(gf.done)break;hf=gf.value;}var jf=hf;jf();}vd.set(we,this);this._logOpenTab();}function re(we){if(we._photoUploader.isUploading())pe(we,wb.CANCEL_DURING_UPLOAD);}function se(){for(var we=vd.values(),xe=Array.isArray(we),ye=0,we=xe?we:we[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ze;if(xe){if(ye>=we.length)break;ze=we[ye++];}else{ye=we.next();if(ye.done)break;ze=ye.value;}var af=ze;af.updateAvailableStatus();af.updateMultichatTooltip();}}function te(){for(var we=vd.values(),xe=Array.isArray(we),ye=0,we=xe?we:we[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ze;if(xe){if(ye>=we.length)break;ze=we[ye++];}else{ye=we.next();if(ye.done)break;ze=ye.value;}var af=ze;af.updateCallLink();}}j.subscribe(k.ON_AVAILABILITY_CHANGED,se);xa.addListener(te);r.subscribe(r.ON_CHANGED,function(){for(var we=vd.keys(),xe=Array.isArray(we),ye=0,we=xe?we:we[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ze;if(xe){if(ye>=we.length)break;ze=we[ye++];}else{ye=we.next();if(ye.done)break;ze=ye.value;}var af=ze;td.getThreadMeta(af,function(bf){vd.get(af)._updateUnreadCount(bf);});}});ld.addRetroactiveListener('state-changed',function(we){for(var xe in we){var ye=we[xe]&&we[xe].length,ze=vd.get(xe);ze&&ze.showTypingIndicator(ye);}});rd.subscribe('threads-updated',function(we,xe){for(var ye=vd.keys(),ze=Array.isArray(ye),af=0,ye=ze?ye:ye[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var bf;if(ze){if(af>=ye.length)break;bf=ye[af++];}else{af=ye.next();if(af.done)break;bf=af.value;}var cf=bf,df=vd.get(cf);xe[cf]&&df.updateTab();if(df._newThreadIDFromPhotoUpload&&!df._photoUploader.isUploading()&&xe[df._newThreadIDFromPhotoUpload]){aa.closeTab(df._threadID);w.openThread(df._newThreadIDFromPhotoUpload,'ChatTabView');df._newThreadIDFromPhotoUpload=null;}}});rd.subscribe('threads-deleted',function(we,xe){for(var ye=vd.keys(),ze=Array.isArray(ye),af=0,ye=ze?ye:ye[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var bf;if(ze){if(af>=ye.length)break;bf=ye[af++];}else{af=ye.next();if(af.done)break;bf=af.value;}var cf=bf;xe[cf]&&aa.closeTab(cf,'thread_deleted');}});Object.assign(qe.prototype,{getThreadID:function(){return this._threadID;},getTabElem:function(){return this._tabElem;},showAddFriend:function(){setTimeout((function(){this._sheetController.openAddFriendsSheet();}).bind(this),0);},showNameConversation:function(we){setTimeout((function(){this._sheetController.openNameConversationSheet(we);}).bind(this),0);},hideAutomaticNameConversation:function(){setTimeout((function(){this._sheetController.closeAutomaticNameConversationSheet();}).bind(this),0);},isVisible:function(){return o.shown(this._tabElem);},setVisibleState:function(we,xe){var ye=o.shown(this._tabElem),ze=o.hasClass(this._tabElem,'opened');o.conditionShow(this._tabElem,we);o.conditionClass(this._tabElem,'opened',xe);if(!(ye&&ze)&&we&&xe){if(!this._messagesView){var af=gb.tokenize(this._threadID);this._messagesView=new ca(this._threadID,this._sheetController,this._getNode('scrollingArea'),this._getNode('conversation'),this._getNode('loadingIndicator'),this._getNode('lastMessageIndicator'),this._getNode('typingIndicator'),this,fb.ShowContextBanner&&af.type==='user');}this._nubController.flyoutContentChanged();this._messagesView.scrollToBottom();this.setP2PChatThreadBannerContainerVisibility();}},focus:function(){if(o.hasClass(this._tabElem,'opened')){this._focusInput();}else this._getNode('dockButton').focus();},isFocused:function(){var we=fd();return vb.byClass(we,"_50mz")===this._tabElem;},hasEmptyInput:function(){return ud.test(this._getInputValue());},getInputElem:function(){if(t.get('chat_react_input')){if(!this._chatInput||!this._chatInput.isMounted())return null;return ac.findDOMNode(this._chatInput);}else return this._getNode('input');},setStickersFlyoutPackID:function(we){if(!this._stickerButton.isMounted())return;gc.selectPack(we);this._toggleStickersFlyoutShown(true);},loadShareFromParams:function(we,xe){this._getSharePreview().then(function(ye){ye.setProps({share:{params:xe,type:we},uri:null});});},_linkDropped:function(we){this._getSharePreview().then(function(xe){xe.setProps({share:null,uri:we});});},_filesDropped:function(we){if(this._fileUploader){this._fileUploader.addDroppedFiles(we);}else{var xe=this._reactChatTabMenu.component.getFileUploaderPromise();if(xe)xe.then(function(ye){ye.addDroppedFiles(we);});}},_toggleStickersFlyoutShown:function(we){this._stickerButton.showFlyout();this._stickersFlyoutShown=we;},showStickerReplyNUX:function(){if(wd)return;new h(yc.getURIBuilder().getURI()).setRelativeTo(this._getNode('stickerButtonContainer')).setData({thread_id:this._threadID}).setHandler(function(we){ic.clearShowStickerReplyNUX();}).send();},insertBefore:function(we){na.insertBefore(we.getTabElem(),this._tabElem);},appendTo:function(we){na.appendContent(we,this._tabElem);},nextTabIs:function(we){var xe=we&&we.getTabElem();return this._tabElem.nextSibling==xe;},getScrollTop:function(){return dc.getTop(na.find(this._tabElem,'.fbNubFlyoutBody.scrollable'));},setScrollTop:function(we){dc.setTop(na.find(this._tabElem,'.fbNubFlyoutBody.scrollable'),we);},destroy:function(){this._initFrame&&zc(this._initFrame);this._selectionPosition&&this._selectionPosition.disable();while(this._eventListeners.length)this._eventListeners.pop().remove();if(this._dropTarget)this._dropTarget.disable();this._checkUnsentMessages&&this._checkUnsentMessages.cancel();this._logUnsentPhotos&&this._logUnsentPhotos.cancel();this._messagesView&&this._messagesView.destroy();this._sheetController&&this._sheetController.destroy();ac.unmountComponentAtNode(this._getNode('animationContainer'));ac.unmountComponentAtNode(this._getNode('menuContainer'));if(t.get('chat_react_header')){if(this._addToThreadButton){this._addToThreadButton.unmount();this._addToThreadButton=null;}if(this._archiveWarning){this._archiveWarning.unmount();this._archiveWarning=null;}if(this._videoCallButton){this._videoCallButton.unmount();this._videoCallButton=null;}if(this._closeButton){this._closeButton.unmount();this._closeButton=null;}if(this._title){this._title.unmount();this._title=null;}}if(this._sharePreview){this._sharePreview.unmount();this._sharePreview=null;}try{ac.unmountComponentAtNode(this._getNode('photoUploaderContainer'));ac.unmountComponentAtNode(this._getNode('fileUploaderContainer'));}catch(we){l.bumpEntityKey('chat.web','chattab.unmount_failed');}ac.unmountComponentAtNode(this._getNode('stickerButtonContainer'));this._subscriptionsHandler&&this._subscriptionsHandler.release();if(t.get('chat_react_input')){ac.unmountComponentAtNode(this._getNode('inputContainer'));}else ab.reset(this._getNode('input'));if(this._getNode('hotLikeContainer'))ac.unmountComponentAtNode(this._getNode('hotLikeContainer'));ac.unmountComponentAtNode(this._getNode('name'));if(!t.get('chat_react_header'))ac.unmountComponentAtNode(this._getNode('titlebarText'));if(this._orionTriggerContainer){if(this._orionTrigger)this._orionTrigger.unmount();this._orionTriggerContainer=null;this._orionTrigger=null;}if(this._p2pChatThreadBannerContainerEl){ac.unmountComponentAtNode(this._p2pChatThreadBannerContainerEl);this._p2pChatThreadBannerContainerEl=null;}this._unsubscribeP2PSendMoneyDialogStore();na.remove(this._tabElem);vd['delete'](this._threadID);ra.unregisterNubController(this._nubController);},updateAvailableStatus:function(){td.getThreadMeta(this._threadID,(function(we){var xe=k.OFFLINE,ye=this._getCanonicalUserID(),ze=null;if(ye){xe=xb.get(ye);ze=fc.getNow(ye);}else{var af=we.participants.map(function(cf){return gb.getUserIDFromParticipantID(cf);});xe=xb.getGroup(af);}if(!ja.isOnline())xe=k.OFFLINE;this.updateCallLink();o.conditionClass(this._tabElem,"_5238",xe===k.ACTIVE&&(ze===undefined||ze===null||!ze.is_messenger_only));o.conditionClass(this._tabElem,"_5239",xe===k.MOBILE||ze!==undefined&&ze!==null&&ze.is_messenger_only);var bf=this._getNode('presenceIndicator');this._onlineStatus=xe;this._pagesMessageIndicatorHandler&&this._pagesMessageIndicatorHandler.notifyPageOnlineStatusChanged(xe);switch(xe){case k.ACTIVE:bf.setAttribute('alt',ed._("Tr\u1ef1c tuy\u1ebfn"));break;case k.MOBILE:bf.setAttribute('alt',ed._("Di \u0111\u1ed9ng"));break;default:bf.removeAttribute('alt');break;}}).bind(this));},updateTab:function(){td.getThreadMeta(this._threadID,(function(we){var xe=[this._getNode('name')];if(!t.get('chat_react_header')){xe.push(this._getNode('titlebarText'));}else if(this._title)this._title.setProps({thread:we},(function(){this._getNode('chatWrapper').setAttribute('aria-label',this._title.component.getTitle());}).bind(this));for(var ye=xe,ze=Array.isArray(ye),af=0,ye=ze?ye:ye[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var bf;if(ze){if(af>=ye.length)break;bf=ye[af++];}else{af=ye.next();if(af.done)break;bf=af.value;}var cf=bf;ac.render(zb.createElement(nb,{isNewThread:td.isNewEmptyLocalThread(this._threadID),thread:we,useAndSeparator:true,useShortName:!we.is_canonical,viewer:ma.getID()}),cf);}this._updateControls(we);this._updateMessageBlockSettings(we);this._updateSecretModeSettings(we);this._updateMutingSettings(we);this._updateUnreadCount(we);this.updateMultichatTooltip();this._updateArchiveWarning(we);this._updateEmployeeAwayWarning(we);this._updateOfficeStatus(we);this._updateNewThread(we);this._updateNameConversationSheet(we);this._updateReadOnlySheet(we);this._updateSwitchToWork(we);}).bind(this));},_updateNameConversationSheet:function(we){if(lb.canReply(we)&&!we.name&&!we.is_canonical&&!we.name_conversation_sheet_dismissed&&!we.has_email_participant&&!we.read_only&&!td.isEmptyLocalThread(we.thread_id)){this.showNameConversation(true);}else this.hideAutomaticNameConversation();},_updateReadOnlySheet:function(we){var xe=lb.showComposer(we),ye=lb.canReply(we),ze=td.isEmptyLocalThread(we.thread_id);if(!ye&&!xe&&!ze)this._sheetController.openReadOnlySheet();},updateSignatureID:function(we){this._signatureID=we;},_updateMessageBlockSettings:function(we){this._updateMenuPropsSafe({hasMessageBlocked:kd.isMessageBlocked(we)});},_updateSecretModeSettings:function(we){this._updateMenuPropsSafe({hasSecretModeOn:!!(we&&we.ephemeral_ttl_mode)});},_updateMutingSettings:function(we){var xe=lb.isMuted(we);this._updateMenuPropsSafe({isMuted:xe});},_updateMenuPropsSafe:function(we){if(this._reactChatTabMenu&&this._reactChatTabMenu.component&&this._reactChatTabMenu.component.isMounted())this._reactChatTabMenu.setProps(we);},_updateArchiveWarning:function(we){if(ma.isEmployee())ib.getMulti(we.participants,this._showArchiveWarningIfAllParticipantsAreEmployees.bind(this));},_updateEmployeeAwayWarning:function(we){u.updateEmployeeAwayWarning(we,(function(){this._sheetController.openEmployeeAwaySheet();}).bind(this),function(){});},_updateOfficeStatus:function(we){var xe=this._getNode('officeStatus');if(!xe||gb.isGroupChat(we.thread_id))return;var ye=gb.getParticipantIDFromUserID(we.other_user_fbid);ib.get(ye,function(ze){da.update(xe,ze);});},_updateSwitchToWork:function(we){if(ma.isEmployee()&&ma.hasWorkUser()&&gb.isGroupChat(we.thread_id)){ib.getMulti(we.participants,(function(xe){var ye=this._isEmployeesOnly(xe);this._updateMenuPropsSafe({hasSwitchToWork:ye});}).bind(this));}else this._updateMenuPropsSafe({hasSwitchToWork:false});},_updateControls:function(we,xe,ye){var ze=false;if(we&&we.thread_id){var af=gb.tokenize(we.thread_id);if(af.type==='user'){var bf=af.value;ze=!wa.isUser(bf);}}var cf=lb.showComposer(we)&&(!gd(we.participants)||!!xe)&&!this._pendingActions,df=this._getNode('footer');o.conditionShow(df,cf);this._updateMenuPropsSafe({isEmptyChat:td.isNewEmptyLocalThread(we.thread_id),show:cf});if(ze)this._updateMenuPropsSafe({showAddFriend:null});var ef=cf&&!ze;if(t.get('chat_react_header')){this._addToThreadButton&&this._addToThreadButton.setProps({shown:ef});}else o.conditionShow(this._getNode('addToThreadLink'),ef);if(ye&&ye.length===1&&fb.ShowContextBanner&&fb.ShowContextBannerNullState){this._messagesView&&this._messagesView.renderContextBanner(null,ye[0].info&&ye[0].info.uid);}else this._messagesView&&this._messagesView.unmountContextBanner();this._resizeInputContainer();this._updateOrionTrigger();},_updateOrionTrigger:function(){if(this._orionTrigger){this._setOrionTriggerProps();}else this._renderOrionTrigger();},_setOrionTriggerProps:function(){this.getParticipantIDsForOrionNUX((function(we,xe){ib.getMulti(we,(function(ye){var ze=[],af,bf=td.isNewEmptyLocalThread(this._threadID);for(var cf in ye){af=this._getUserIdFromParticipantID(cf);if(af!==ma.getID())ze.push(za.set(ye[cf],{userID:af}));}if(this._orionTrigger)this._orionTrigger.setProps(babelHelpers._extends({participants:ze,isNewEmptyLocalThread:bf,isGroupChat:gb.isGroupChat(this._threadID)&&!bf,threadID:this._threadID,threadFBID:xe},tb.getStateByThreadID(this._threadID)));}).bind(this));}).bind(this));},_getUserIdFromParticipantID:function(we){return gb.getUserIDFromParticipantID(we);},_onP2PSendMoneyDialogStoreChange:function(){this._updateOrionTrigger();},_unsubscribeP2PSendMoneyDialogStore:function(){if(this._sendMoneyDialogStoreSub){this._sendMoneyDialogStoreSub.remove();this._sendMoneyDialogStoreSub=null;}},_isP2PEnabled:function(){return sb.P2PEnabled;},_canP2PSend:function(){return (this._isP2PEnabled());},_renderOrionTrigger:function(){var we=this._getCanonicalUserID();if(this._canP2PSend()&&we!==ma.getID()){this._orionTriggerContainer=this._getNode('orionTriggerContainer');if(!this._orionPromised){this._orionPromised=true;cc.onAfterLoad((function(){n.loadModules(["P2PSendMoneyButton.react"],(function(xe){this._orionTrigger=new bc(xe,this._orionTriggerContainer);this._orionTrigger.setProps({flyoutAlignment:this._isTwoLine?'right':undefined,onTrigger:this._orionTriggered.bind(this)});o.addClass(this._inputContainerNode,"_11d6");this._setOrionTriggerProps();this._orionPromised=false;}).bind(this));}).bind(this));}}},getParticipantIDsForOrionNUX:function(we){var xe=this._sheetController.getAddFriendsParticipants(),ye=this._getCanonicalUserID();if(ye){we([gb.getParticipantIDFromUserID(ye)]);}else if(td.isNewEmptyLocalThread(this._threadID)&&xe){we(xe);}else td.getThreadMeta(this._threadID,(function(ze){we(ze.participants,ze.thread_fbid);}).bind(this));},_resizeInputContainer:function(){if(!this._isTwoLine){var we=this._tabElem.clientWidth,xe=2,ye=we-(this._inputContainerNode.clientWidth+xe),ze=db.isRTL()?'left':'right';jc.set(this._iconsContainerNode,ze,ye+'px');}if(!t.get('chat_react_input'))nc.getInstance(this._getNode('input')).update();},_updateNewThread:function(we){if(td.isNewEmptyLocalThread(we.thread_id))this.showAddFriend();},_isEmployeesOnly:function(we){for(var xe in we)if(!we[xe].employee)return false;return true;},_showArchiveWarningIfAllParticipantsAreEmployees:function(we){var xe=this._isEmployeesOnly(we),ye=t.get('chat_react_header'),ze=ye?this._getNode('archiveContainer'):this._getNode('titanArchiveWarning');if(ze){if(this._titlebarTooltipAnchor)o.conditionClass(this._titlebarTooltipAnchor,'narrowTitleBar',xe);if(ye){this._archiveWarning&&this._archiveWarning.setProps({shown:xe});}else o.conditionShow(ze,xe);}},updateMultichatTooltip:function(){td.getThreadMeta(this._threadID,(function(we){if(!we.is_canonical){var xe;if(t.get('chat_react_header')){xe=ac.findDOMNode(this._title.component);}else xe=this._titlebarTooltipAnchor;ae(xe,we.participants);}}).bind(this));},_getNode:function(we){return this._tabTemplate.getNode(we);},_getCanonicalUserID:function(){return gb.getUserIDFromThreadID(this._threadID);},_listen:function(we,event,xe,ye){var ze=this._getNode(we);if(ze){this._eventListeners.push(va.listen(ze,event,xe.bind(this)));}else if(!ye)throw new Error('Could not find node "'+we+'"');},_closePreClicked:function(we){this._closeMouseDown=true;},_closeClicked:function(we){re(this);aa.closeTab(this._threadID);if(we instanceof lc){we.stopPropagation();return;}we.kill();},_closeEnter:function(we){if(we.keyCode===cb.RETURN)this._closeClicked(we);},_nubClicked:function(we){we.kill();return fa.inform('nub-activated',this._threadID);},_dockKeyDown:function(event){if(event.keyCode===cb.RETURN||event.keyCode===cb.SPACE){fa.inform('nub-activated',this._threadID);event.kill();}else this._handleHotkeyPressed(event);},_handleHotkeyPressed:function(event){if(event.keyCode===cb.ESC){this._handleEscape();if(t.get('chat_react_input'))event=new oa(event);event.kill();}else if(event.keyCode===cb.TAB)this._handleTabPressed(event);},_handleTabPressed:function(event){if(!event.ctrlKey){var we=fa.inform('tab-pressed',{id:this._threadID,shiftPressed:event.shiftKey});if(t.get('chat_react_input'))event=new oa(event);!we&&event.kill();return true;}},_handleEscape:function(){if(this._stickersFlyoutShown){this._toggleStickersFlyoutShown(false);return;}re(this);if(this.hasEmptyInput()){fa.inform('esc-pressed',this._threadID);}else{var we=ed._("B\u1ea1n c\u00f3 ch\u1eafc b\u1ea1n mu\u1ed1n x\u00f3a c\u1eeda s\u1ed5 ch\u00e1t n\u00e0y kh\u00f4ng?"),xe=ed._("B\u1ea1n ch\u01b0a g\u1eedi tin nh\u1eafn c\u1ee7a m\u00ecnh."),ye=new qa().setTitle(we).setBody(xe).setButtons([qa.CLOSE,qa.CANCEL]).setHandler(fa.inform.bind(fa,'esc-pressed',this._threadID,null)).setModal(true).show(),ze=ye.getButtonElement('yes');ze&&ya.set(ze);}},_titleClicked:function(event){var we=event.getTarget();if(!vb.byClass(we,'titlebarText')&&!vb.byClass(we,'uiSelector')&&!vb.byClass(we,'addToThread')&&!vb.byClass(we,'optionMenu')&&!vb.byClass(we,'videoicon')&&!vb.byClass(we,'phoneicon')&&!vb.byClass(we,"_1fu3")&&!vb.byClass(we,"_1fu4")&&!vb.byClass(we,'close')){event.kill();aa.lowerTab(this._threadID);this.focus();}},_groupCallEnter:function(we){if(we.keyCode===cb.RETURN)this._groupCallClicked(we);},_groupCallClicked:function(we){if(we.target)we.target.blur();if(this._videoCallLinkEnabled){var xe;if(we.target&&(o.hasClass(we.target,'phoneicon')||o.hasClass(we.target,"_1fu4"))){xe='chat_tab_voice_icon';}else xe='chat_tab_icon';td.getThreadMeta(this._threadID,function(ye){var ze=ye.participants.map(function(bf){return gb.getUserIDFromParticipantID(bf);}),af=ze.filter(function(bf){return bf!==ma.getID();});fa.inform('group-call-clicked',{threadID:'GROUP:'+ye.thread_fbid.toString(),usersToCall:af,clickSource:xe,audioOnly:xe==='chat_tab_voice_icon'});});}if(t.get('chat_react_header')){we.stopPropagation();}else return false;},_callEnter:function(we){if(we.keyCode===cb.RETURN)this._callClicked(we);},_callClicked:function(we){if(we.target)we.target.blur();var xe=this._getCanonicalUserID();if(this._videoCallLinkEnabled){var ye;if(we.target&&(o.hasClass(we.target,'phoneicon')||o.hasClass(we.target,"_1fu4"))){ye='chat_tab_voice_icon';}else ye='chat_tab_icon';fa.inform('video-call-clicked',{threadID:this._threadID,userID:xe,clickSource:ye,audioOnly:ye==='chat_tab_voice_icon'});}if(t.get('chat_react_header')){we.stopPropagation();}else return false;},_addFriendLinkClicked:function(){this.showAddFriend();},_getUserParticipants:function(we){var xe=[];we.forEach(function(ye){var ze=gb.getUserIDFromParticipantID(ye);ze&&xe.push(ze);});return xe;},_enableDesktopNotif:function(){Notification.requestPermission();},_inputPasted:function(event){if(sc.chrome()){var we=event.clipboardData||event.originalEvent.clipboardData;if(!we||!we.items||we.items.length<1)return;var xe=we.items[0].type;if(xe!=='image/png')return;if(we.items[0].getAsFile){var ye=we.items[0].getAsFile();this._photoUploader.uploadFile(ye);}}},_focusInput:function(){v.processEvent('focus');if(t.get('chat_react_input')){this._chatInput&&this._chatInput.isMounted()&&this._chatInput.focus();}else this._getNode('input').focus();},_focusTab:function(){o.addClass(this._tabElem,'focusedTab');this.tryMarkAsRead();this._closeMouseDown=false;this._setCloseTooltip(true);fa.inform('focus-tab',this._threadID);},_blurTab:function(){v.processEvent('blur');o.removeClass(this._tabElem,'focusedTab');!this._closeMouseDown&&this._setCloseTooltip(false);},_setCloseTooltip:function(we){if(t.get('chat_react_header')){this._closeButton&&this._closeButton.setProps({active:we});return;}var xe=this._getNode('titlebarCloseButton'),ye=we?ed._("Nh\u1ea5n Esc \u0111\u1ec3 \u0111\u00f3ng"):ed._("\u0110\u00f3ng tab");oc.set(xe,ye,'above');},_inputKeyDown:function(event){this.tryMarkAsRead();if(event.keyCode===cb.RETURN&&!event.shiftKey){if(me(this)){ke(this);event.kill&&event.kill();return;}he(this);event.kill&&event.kill();return;}if(event.keyCode===cb.DOWN&&event.shiftKey&&this.hasEmptyInput()){event.kill&&event.kill();aa.lowerTab(this._threadID);this.focus();return;}this._handleHotkeyPressed(event);},_showMessageBlockedDialog:function(we){var xe=this._getCanonicalUserID();if(!xe)return;if(!t.get('chat_react_input'))this._getNode('input').blur();var ye='fbid:'+xe;ib.get(ye,function(ze){n.loadModules(["MessageBlockedDialog"],function(af){af.show(we.thread_id,we.can_reply,kd.isMessageBlocked(we),ze.short_name);});});},_initializeComposer:function(){if(this._isTwoLine)o.addClass(this._tabElem,"_8mr");},_initializeInput:function(){if(!t.get('chat_react_input')){var we=this._inputContainerNode.clientHeight;nc.getInstance(this._getNode('input')).subscribe('resize',(function(){var ye=this._inputContainerNode.clientHeight;if(ye!=we)this._nubController.flyoutContentChanged();we=ye;}).bind(this));this._listen('input','focus',this._focusTab);this._listen('input','blur',this._blurTab);this._listen('input','paste',this._inputPasted);if(sc.firefox()&&la.get()=='ko_KR'){this._listen('input','keyup',this._inputKeyDown);}else this._listen('input','keydown',this._inputKeyDown);this._initializeThingsWithInputFn(this._tabTemplate.getNode('input'));}else{var xe=this._isTwoLine?ed._("Nh\u1eadp tin nh\u1eafn..."):null;this._chatInput=ac.render(zb.createElement(jd,{initializeThingsWithInputFn:this._initializeThingsWithInputFn.bind(this),inputKeyDown:this._inputKeyDown.bind(this),onAddMention:this._onAddMention.bind(this),onBlur:this._blurTab.bind(this),onEscape:this._handleEscape.bind(this),onFocus:this._focusTab.bind(this),onTab:this._handleTabPressed.bind(this),openFlyoutFn:(function(){return this._toggleStickersFlyoutShown(true);}).bind(this),resizeFn:(function(ye){jc.set(this._getNode('inputContainer'),'height',ye+'px');this._nubController.flyoutContentChanged();}).bind(this),uploadPhotoFn:(function(ye){this._photoUploader&&this._photoUploader.uploadFile(ye);}).bind(this),placeholder:xe}),this._getNode('chatInputContainer'));}},_initializeSharePreview:function(we,xe){va.listen(we,'keyup',(function(){var ye=xe?xe():we.value;if(!ye.length){this._urlScraper.reset();delete this._urlScraperData;}}).bind(this));this._urlScraper=new qc(we,xe);this._urlScraper.subscribe('match',(function(ye,ze){this._urlScraperData=ze;this._getSharePreview().then((function(af){var bf=this._urlScraperData;af.setProps({share:null,uri:bf&&bf.url});}).bind(this));}).bind(this));},_getSharePreview:function(){if(!this._sharePreview&&!this._sharePreviewPromise){this._sharePreviewLoading=true;this._sharePreviewPromise=new yb((function(we){n.loadModules(["MercurySharePreview.react"],(function(xe){this._sharePreview=new bc(xe,this._getNode('shareAttachmentShelf'));this._sharePreview.setProps({imageSize:{width:yd,height:yd},location:jb.CHAT_PREVIEW,onClose:this._focusInput.bind(this),onUpdate:(function(){oe(this);this._unblockSend();}).bind(this)});this._sharePreviewLoading=false;we(this._sharePreview);}).bind(this));}).bind(this));}return this._sharePreviewPromise;},_initializeThingsWithInputFn:function(we,xe){this._initializeSharePreview(we,xe);td.getThreadMeta(this._threadID,(function(ye){if(fb.CoreGraphEnabled&&ye&&ye.folder===qb.PENDING){var ze=na.create('div');na.appendContent(this._getNode('chatConv'),ze);this._pendingActions=ze;ac.render(zb.createElement(m,{bootloadPlaceholder:zb.createElement('div',{style:{height:27}}),bootloadLoader:bb('ChatPendingActions.react'),onDeleteClick:(function(af){uc.show(this._threadID);}).bind(this),onReplyClick:(function(af){na.remove(ze);delete this._pendingActions;this._updateControls(ye);}).bind(this)}),ze);}pd.getServerIDFromClientID(this._threadID,(function(af){this._typingDetector=new pc(this._getCanonicalUserID(),we,'mercury-chat',null,af,xe);}).bind(this));}).bind(this));},_getInputValue:function(){if(t.get('chat_react_input')){if(!this._chatInput||!this._chatInput.isMounted())return '';return this._chatInput.getValue()||'';}else return this._tabTemplate.getNode('input').value||'';},appendTextToInput:function(we){if(t.get('chat_react_input')){if(this._chatInput&&this._chatInput.isMounted())this._chatInput.appendText(we);}else this._getNode('input').value+=we;},_hasUnfinishedPost:function(){return ne(this)||le(this);},tryMarkAsRead:function(){if(!this._messagesView||this._messagesView.isScrolledToBottom()){sd.markRead(this._threadID);sd.markSeen(this._threadID);return true;}return false;},_chatConvClicked:function(we){this.tryMarkAsRead();if(vb.byTag(we.getTarget(),'a')||na.getSelection())return;this.focus();},_inputContainerClicked:function(we){this.tryMarkAsRead();this.focus();},_initializePageMessagingIndicator:function(){if(!this._pagesMessageIndicator)return;o.hide(this._pagesMessageIndicator);this._pagesMessageIndicatorHandler=ub.tryCreateHandler(this._threadID,this._pagesMessageIndicator,this._onlineStatus);this._pagesMessageIndicatorHandler&&this._pagesMessageIndicatorHandler.checkResponsiveness();},showTypingIndicator:function(we){this._renderTypingIndicator();o.conditionClass(this._tabElem,"_54m8",we);},_renderTypingIndicator:function(){var we=o.hasClass(this._tabElem,'highlightTab')?'light':'dark';ac.render(zb.createElement(mb,{color:we}),this._getNode('animationContainer'));},_updateUnreadCount:function(we){var xe=we.unread_count;if(typeof xe!='undefined'){var ye=!!xe&&(!r.showsTabUnreadUI||r.showsTabUnreadUI()),ze=this._getNode('numMessages');o.conditionShow(ze,ye);o.conditionClass(this._tabElem,'highlightTab',ye);this._renderTypingIndicator();ee(this._threadID,this._tabElem,ye);na.setContent(ze,xe);}},updateCallLink:function(){var we=gb.isGroupChat(this._threadID);if(we&&t.get('rtc_conferencing')){this._videoCallLinkEnabled=true;if(!t.get('chat_react_header'))o.conditionClass(this._tabElem,"_26-s",this._videoCallLinkEnabled);}else{var xe=this._getCanonicalUserID();if(!xe||xe===ma.getID()||!wa.isUser(xe)){if(t.get('chat_react_header')){if(this._videoCallButton)this._videoCallButton&&this._videoCallButton.setProps({shown:false});}else{var ye=this._getNode('videoCallLink');if(ye)o.hide(ye);var ze=this._getNode('voiceCallLink');if(ze)o.hide(ze);}this._videoCallLinkEnabled=false;return;}this._videoCallLinkEnabled=xa.isCallable(xe);if(!t.get('chat_react_header')){o.conditionClass(this._tabElem,"_4hwz",this._videoCallLinkEnabled);ib.get(gb.getParticipantIDFromUserID(xe),(function(af){xa.callButtonTooltip(xe,af.short_name);this._setCallButtonTooltips(xe,af.short_name);}).bind(this));}}},_setCallButtonTooltips:function(we,xe){var ye=xa.callButtonTooltip(we,xe),ze=xa.voiceCallButtonTooltip(we,xe);oc.set(this._getNode('videoCallLink'),ye);var af=this._getNode('voiceCallLink');if(af)oc.set(af,ze);},_initializeSheetController:function(){this._sheetController=new ea(this._threadID,this._getNode('sheet'),this._tabElem,this);this._sheetController.onClickMessagesBlockedSheet((function(){sd.unblockMessages(this._threadID);this.focus();}).bind(this));this._sheetController.onClickNewMessagesSheet((function(){this._messagesView&&this._messagesView.scrollToBottom();this.focus();this.tryMarkAsRead();}).bind(this));this._sheetController.onClickThreadIsMutedSheet((function(){sd.unmute(this._threadID);this.focus();}).bind(this));this._sheetController.onClickSecretModeSheet((function(){sd.turnOffSecretMode(this._threadID);this.focus();}).bind(this));this._sheetController.onTokensChanged((function(we,xe){td.getThreadMeta(this._threadID,(function(ye){this._updateControls(ye,xe.token_count,xe.tokens);}).bind(this));}).bind(this));this._nubController=new rb().init(this._tabElem);this._sheetController.onResize((function(){this._nubController.flyoutContentChanged();}).bind(this));this._nubController.subscribe('resize',(function(){this._resizeInputContainer();}).bind(this));},_initializeHeader:function(){this._initializeReactMenu(this._getNode('fileAttachmentShelf'));this._initializeArchiveWarning();this._initializeAddToThreadButton();this._initializeVideoCallButton();this._initializeCloseButton();this._initializeTitle();},_initializeReactMenu:function(we){var xe=gb.isGroupChat(this._threadID),ye=td.isNewEmptyLocalThread(this._threadID),ze=this._sheetController.openAddFriendsSheet.bind(this._sheetController);this._reactChatTabMenu=new bc(ba,this._getNode('menuContainer'));this._reactChatTabMenu.setProps({sheetController:this._sheetController,onFileUploaderMounted:this.setFileUploader.bind(this),nameConversationFunc:(function(){return this.showNameConversation();}).bind(this),isGroupChat:xe,isEmptyChat:ye,showAddFriend:ze,threadID:this._threadID,otherUserID:this._getCanonicalUserID(),attachmentsShelf:we,onUploadFinished:this._unblockSend.bind(this),onUpdateAttachmentsShelf:oe.bind(this,this),onSubmit:this._focusInput.bind(this)});},_initializeArchiveWarning:function(){if(t.get('chat_react_header')){this._archiveWarning=new bc(q,this._getNode('archiveContainer'));this._archiveWarning.setProps({isFBAtWork:xc.is_work_user,shown:true});}},_initializeAddToThreadButton:function(){if(t.get('chat_react_header')){this._addToThreadButton=new bc(p,this._getNode('addToThreadContainer'));this._addToThreadButton.setProps({isFBAtWork:xc.is_work_user,onClick:this._addFriendLinkClicked.bind(this),shown:true});}else this._listen('addToThreadLink','click',this._addFriendLinkClicked,true);},_initializeVideoCallButton:function(){var we=gb.isGroupChat(this._threadID);if(we&&t.get('rtc_conferencing')){if(t.get('chat_react_header')){this._videoCallButton=new bc(ia,this._getNode('videoCallButtonContainer'));this._videoCallButton.setProps({shown:true,isAudio:false,userID:null,onClick:this._groupCallClicked.bind(this),onKeyUp:this._groupCallEnter.bind(this)});this._voiceCallButton=new bc(ia,this._getNode('voiceCallButtonContainer'));this._voiceCallButton.setProps({shown:true,isAudio:true,userID:null,onClick:this._groupCallClicked.bind(this),onKeyUp:this._groupCallEnter.bind(this)});}else{this._listen('videoCallLink','click',this._groupCallClicked,true);this._listen('videoCallLink','keyup',this._groupCallEnter,true);if(this._getNode('voiceCallLink')){this._listen('voiceCallLink','click',this._groupCallClicked,true);this._listen('voiceCallLink','keyup',this._groupCallEnter,true);}}}else{if(!gb.getUserIDFromThreadID(this._threadID))return;if(t.get('chat_react_header')){var xe=this._getCanonicalUserID();this._videoCallButton=new bc(ia,this._getNode('videoCallButtonContainer'));this._videoCallButton.setProps({shown:true,isAudio:false,userID:xe,onClick:this._callClicked.bind(this),onKeyUp:this._callEnter.bind(this)});this._voiceCallButton=new bc(ia,this._getNode('voiceCallButtonContainer'));this._voiceCallButton.setProps({shown:true,isAudio:true,userID:xe,onClick:this._callClicked.bind(this),onKeyUp:this._callEnter.bind(this)});}else{this._listen('videoCallLink','click',this._callClicked,true);this._listen('videoCallLink','keyup',this._callEnter,true);if(this._getNode('voiceCallLink')){this._listen('voiceCallLink','click',this._callClicked,true);this._listen('voiceCallLink','keyup',this._callEnter,true);}}}},_initializeCloseButton:function(){if(t.get('chat_react_header')){this._closeButton=new bc(s,this._getNode('closeButtonContainer'));this._closeButton.setProps({onClick:this._closeClicked.bind(this),onKeyUp:this._closeEnter.bind(this),onMouseDown:this._closePreClicked.bind(this)});}else{this._listen('titlebarCloseButton','click',this._closeClicked);this._listen('titlebarCloseButton','keyup',this._closeEnter);this._listen('titlebarCloseButton','mousedown',this._closePreClicked);}},_initializeTitle:function(){if(t.get('chat_react_header')){var we=td.getThreadMetaNow(this._threadID);this._title=new bc(ha,this._getNode('titleContainer'));this._title.setProps({isNewThread:td.isNewEmptyLocalThread(this._threadID),thread:we,viewer:ma.getID()});}},_initializeTitleHREF:function(){vc.getThreadURI(this._threadID,(function(xe){return this._setTitleHref(xe);}).bind(this));if(!gb.getUserIDFromThreadID(this._threadID))this._titlebarTooltipAnchor=this._getNode('titlebarText');var we=this._getCanonicalUserID();if(this._getCanonicalUserID())ib.get(gb.getParticipantIDFromUserID(we),(function(xe){if(xe.href)this._setTitleHref(xe.href);}).bind(this));},_initializeUIListeners:function(){if(this._pagesMessageIndicator)this._listen('scrollingArea','scroll',(function(event){var we=event.target;if(we.scrollHeight-we.offsetHeight!==we.scrollTop)this._pagesMessageIndicatorHandler&&this._pagesMessageIndicatorHandler.hideIndicatorAndPreventFutureShow();}).bind(this));this._listen('closeButton','click',this._closeClicked);this._listen('dockButton','click',this._nubClicked);this._listen('dockButton','keydown',this._dockKeyDown);this._listen('nubFlyoutTitlebar','click',this._titleClicked);this._listen('chatConv','click',this._chatConvClicked);this._listen('inputContainer','click',this._inputContainerClicked);this._listen('sheet','keydown',(function(event){if(!event.getModifiers().any&&event.keyCode===cb.TAB){this._focusInput();event.kill();}if(event.keyCode===cb.ESC)this._handleEscape();}).bind(this));if(this._getNode('officeStatus'))this._listen('officeStatus','click',function(){return false;},true);},setFileUploader:function(we){this._fileUploader=we;},_initializeAutoSendPhotoUploader:function(){this._photoUploader=ac.render(zb.createElement(x,{onSubmit:this._handlePUSubmit.bind(this),onAllUploadsComplete:this._handlePUAllUploadsCompleted.bind(this),onLastUploadFail:this._handlePULastUploadFailed.bind(this),onLastUploadCancel:this._handlePULastUploadCanceled.bind(this)}),this._getNode('photoUploaderContainer'));},_initializeStickers:function(){var we=this._isTwoLine?'right':'left';this._stickerButton=ac.render(zb.createElement(z,{className:"_4vui",flyoutAlignment:we,isChat:true,onFlyoutShown:this._onFlyoutShown.bind(this),onFlyoutHidden:this._onFlyoutHidden.bind(this),onStickerSelect:this._stickerSelected.bind(this),onEmoticonSelect:this._emoticonSelected.bind(this),threadID:this._threadID}),this._getNode('stickerButtonContainer'));},_initializeAutoSendFileUploader:function(){if(!this._isTwoLine||!this._fileUploaderNode)return;this._photoUploader=ac.render(zb.createElement(x,{imageClassName:"_2wye",imagesOnly:false,onSubmit:this._handlePUSubmit.bind(this),onAllUploadsComplete:this._handlePUAllUploadsCompleted.bind(this),onLastUploadFail:this._handlePULastUploadFailed.bind(this),onLastUploadCancel:this._handlePULastUploadCanceled.bind(this)}),this._fileUploaderNode);},_initializeContentSearch:function(){if(this._contentSearchNode){ac.render(zb.createElement(m,{bootloadPlaceholder:zb.createElement('div',{style:{height:27}}),bootloadLoader:bb('ChatContentSearchButton.react'),className:"_4vui _2ksk",getInput:(function(){return this.getInputElem();}).bind(this),getQuery:(function(){return this._getInputValue();}).bind(this),onLoad:(function(we){this._contentSearchButton=we;}).bind(this),onSelect:(function(we,xe){var ye=this.getInputElem();ye&&ye.select&&ye.select();if(we.platformFBID.toString()===fb.MessengerAppID){this._stickerSelected(we.resultID.toString());}else{this._photoUploader&&this._photoUploader.uploadURL({attribution_app_id:we.platformFBID,errorDialogParams:{body:ed._("\u0110\u00e3 x\u1ea3y ra l\u1ed7i khi g\u1eedi t\u1ec7p GIF n\u00e0y. H\u00e3y ch\u1ecdn t\u1ec7p kh\u00e1c v\u00e0 th\u1eed l\u1ea1i."),title:ed._("Kh\u00f4ng th\u1ec3 g\u1eedi t\u1ec7p GIF")},external_image_url:we.source.url,preview_url:we.media.preview?we.media.preview.url:we.media.thumbnail.url,source:we.source});this._messagesView&&this._messagesView.scrollToBottom();}}).bind(this)}),this._contentSearchNode);o.addClass(this._inputContainerNode,"_35li");l.bumpEntityKey('chat.web','content_search_button.mounting_attempted');}},_initializeEmojiSearch:function(){if(this._emojiSearchNode){ac.render(zb.createElement(m,{bootloadPlaceholder:zb.createElement('div',{style:{height:27}}),bootloadLoader:bb('ChatEmojiSearchButton.react'),className:"_4vui _32cu",getInput:(function(){return this.getInputElem();}).bind(this),getQuery:(function(){return this._getInputValue();}).bind(this),onLoad:(function(we){this._contentEmojiButton=we;}).bind(this),onSelect:function(){}}),this._emojiSearchNode);o.addClass(this._inputContainerNode,"_32cv");l.bumpEntityKey('chat.web','chat_emoji_search.mounting_attempted');}},_initializeDragDropTarget:function(){if(wc.canUploadFiles){var we=pa.scry(this._tabElem,"._1ia");if(we&&we.length>0){this._dropTarget=new sa(we[0]);this._dropTarget.setOnFilesDropCallback(this._filesDropped.bind(this));this._dropTarget.setOnURLDropCallback(this._linkDropped.bind(this));this._dropTarget.enable();}}},_initializeP2PChatThreadBannerContainer:function(){var we=pa.scry(this._tabElem,"._2hc2");if(we&&we.length>0)cc.onAfterLoad((function(){n.loadModules(["P2PChatThreadBannerContainer.react"],(function(xe){this._p2pChatThreadBannerContainerEl=we[0];this._p2pChatThreadBannerContainer=new bc(xe,this._p2pChatThreadBannerContainerEl);this._p2pChatThreadBannerContainer.setProps({isVisible:this.isChatViewable(),otherUserID:gb.getUserIDFromThreadID(this._threadID),threadID:this._threadID});}).bind(this));}).bind(this));},setP2PChatThreadBannerContainerVisibility:function(){if(this._p2pChatThreadBannerContainer)this._p2pChatThreadBannerContainer.setProps({isVisible:this.isChatViewable()});},isChatViewable:function(){return (this._tabElem&&o.hasClass(this._tabElem,'opened')&&!o.hasClass(this._tabElem,'hidden_elem'));},_initializeP2P:function(){this._sendMoneyDialogStoreSub=tb.addListener('change',this._onP2PSendMoneyDialogStoreChange.bind(this));if(this._isP2PEnabled())this._renderOrionTrigger();},_initializeHotLike:function(){var we=td.getThreadMetaNow(this._threadID),xe=we?we.custom_like_icon:null;if(this._getNode('hotLikeContainer')){ac.render(zb.createElement(pb,{className:"_3s0d",customLike:xe,onMouseDown:(function(){if(this._contentSearchButton)this._contentSearchButton.hideFlyout();}).bind(this),sendSticker:this._stickerSelected.bind(this),threadID:this._threadID}),this._getNode('hotLikeContainer'));o.addClass(this._inputContainerNode,"_n4k");}},_initializeUnloadListeners:function(){this._checkUnsentMessages=ad((function(){if(this._hasUnfinishedPost())return ed._("B\u1ea1n v\u1eabn ch\u01b0a g\u1eedi tin nh\u1eafn. B\u1ea1n c\u00f3 mu\u1ed1n r\u1eddi \u0111i m\u00e0 kh\u00f4ng g\u1eedi kh\u00f4ng?");if(nd.getNumberLocalMessages(this._threadID))return ed._("Tin nh\u1eafn v\u1eabn \u0111ang \u0111\u01b0\u1ee3c g\u1eedi. B\u1ea1n c\u00f3 ch\u1eafc ch\u1eafn mu\u1ed1n r\u1eddi b\u1ecf?");return null;}).bind(this));cc.onBeforeUnload(this._checkUnsentMessages,false);this._logUnsentPhotos=ad(re.bind(null,this));cc.onUnload(this._logUnsentPhotos);},_handlePUSubmit:function(we,xe){pe(this,wb.UPLOAD_START,xe);je(this,'',[],(function(ye){if(this._threadID!==ye.thread_id){this._newThreadIDFromPhotoUpload=ye.thread_id;if(this._messagesView)this._messagesView.setNewThreadID(ye.thread_id);}ye.content_attachment=null;md.addAttachmentPlaceholder(ye,xe.upload_id,xe);}).bind(this));ue('submit',xe);this._focusInput();},_handlePULastUploadFailed:function(we,xe){pe(this,wb.CLIENT_ERROR,xe);ue('failed',xe);md.cancelAttachmentPlaceholder(xe.upload_id,xe);var ye=ed._("\u1ea2nh t\u1ea3i l\u00ean kh\u00f4ng th\u00e0nh c\u00f4ng"),ze=ed._("Vui l\u00f2ng th\u1eed l\u1ea1i. \u0110\u1ea3m b\u1ea3o r\u1eb1ng b\u1ea1n \u0111ang t\u1ea3i \u1ea3nh h\u1ee3p l\u1ec7.");if(xe.errorDialogParams){ye=xe.errorDialogParams.title||ye;ze=xe.errorDialogParams.body||ze;}new qa().setTitle(ye).setBody(ze).setButtons(qa.OK).show();},_handlePULastUploadCanceled:function(we,xe){pe(this,wb.CANCEL_DURING_UPLOAD,xe);ue('canceled',xe);md.cancelAttachmentPlaceholder(xe.upload_id,xe);},_handlePUAllUploadsCompleted:function(we,xe){pe(this,wb.ALL_UPLOADS_DONE,xe);ue('completed',xe);md.confirmAttachmentPlaceholder(xe.upload_id,xe);var ye=xe.image_ids.length||xe.attachments.length;ie(this,ye);},_stickerSelected:function(we){je(this,'',[],(function(xe){xe.has_attachment=true;xe.sticker_id=we;md.send(xe);this.focus();}).bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_emoticonSelected:function(we){var xe=ua.symbols[we];if(!xe)return;if(t.get('chat_react_input')){this._chatInput.insertEmoticon(xe);return;}this._selectionPosition=this._selectionPosition||new ec(this._getNode('input'));var ye=nc.getInstance(this._getNode('input')),ze=ye.getValue(),af=ta.insertEmoticon(xe,ze,this._selectionPosition.getPos());ye.setValue(af.result);this._selectionPosition.setPos(af.start,af.end);},_orionTriggered:function(){je(this,'',[],(function(we){this.focus();}).bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_onFlyoutShown:function(we){var xe=this._stickersFlyout.props.packID;if(xe!==hc.SEARCH_PACK_ID)this.focus();we();this._stickersFlyoutShown=true;},_searchStickers:function(we,xe){this._stickersFlyout&&this._stickersFlyout.setProps({packID:hc.SEARCH_PACK_ID,trigger:we},xe);},_onFlyoutHidden:function(){this._stickersFlyoutShown=false;this.focus();},_setTitleHref:function(we){if(t.get('chat_react_header')){this._title&&this._title.setProps({href:we});}else{var xe=this._getNode('titlebarText');xe.setAttribute('href',we);xe.removeAttribute('rel');o.removeClass(xe,'noLink');}},_onAddMention:function(we){this._linkDropped(new rc(we.getURI()).getQualifiedURI().toString());},_unblockSend:function(){if(!this._blocked||me(this))return;this._blocked=false;he(this);this._sheetController.closeUploadWarningTabSheet();},_logOpenTab:function(){new i('/ajax/chat/opentab_tracking.php',{threadID:this._threadID,userID:this._getCanonicalUserID(),signatureID:this._signatureID}).send();}});function ue(we,xe){zd.debug('photo_uploader:'+we,babelHelpers._extends({},xe));}function ve(we,xe){if(!xe)return we;var ye=xe.getImageFiles();if(ye.length>0){we.image_ids=ye;we.has_attachment=true;}var ze=xe.getAnimatedImageFiles();if(ze.length>0){we.gif_ids=ze;we.has_attachment=true;}var af=xe.getVideoFiles();if(af.length>0){we.video_ids=af;we.has_attachment=true;}var bf=xe.getAudioFiles();if(bf.length>0){we.audio_ids=bf;we.has_attachment=true;}var cf=xe.getFiles();if(cf.length>0){we.file_ids=cf;we.has_attachment=true;}return we;}f.exports=qe;},null);
__d('ChatTabTypeaheadDataSource',['MercuryConfig','MercuryTypeaheadConstants','MercuryTypeaheadDataSource'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k,l;k=babelHelpers.inherits(m,j);l=k&&k.prototype;function m(n){'use strict';n=n||{};n.maxResults=i.COMPOSER_CHATTAB_MAX;l.constructor.call(this,n);this.$ChatTabTypeaheadDataSource1=true;}m.prototype.buildData=function(n){'use strict';var o=[],p=[],q=[],r=[],s=[],t=[];n.forEach(function(v){var w=l.getEntry.call(this,v);switch(w.render_type){case i.FRIEND_TYPE:o.push(v);break;case i.THREAD_TYPE:if(this.$ChatTabTypeaheadDataSource1)p.push(v);break;case i.NON_FRIEND_TYPE:q.push(v);break;case i.FB4C_TYPE:r.push(v);break;case i.PAGE_TYPE:if(this.$ChatTabTypeaheadDataSource1)if(h.LinkedAgents&&h.LinkedAgents.indexOf(v.toString())>-1){t.push(v);}else s.push(v);break;default:this.logQuery({event:'chat_tab_render_type_error'});break;}},this);var u=t.concat(o,r,p,s,q);return l.buildData.call(this,u);};m.prototype.query=function(n,o,p,q){'use strict';this.logQuery({event:'query_chat_tab',query:n});return l.query.call(this,n,o,p,q);};m.prototype.respond=function(n,o,p){'use strict';var q=l.respond.call(this,n,o,p);this.logResponse({event:'query_response_chat_tab',response_query:n,response_uids:o});return q;};m.prototype.setShowThreads=function(n){'use strict';this.$ChatTabTypeaheadDataSource1=n;};f.exports=m;},null);